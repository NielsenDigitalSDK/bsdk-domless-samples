function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function t(e,t,a,n,r,i,o){try{var s=e[i](o),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,r)}function a(e){return function(){var a=this,n=arguments;return new Promise((function(r,i){var o=e.apply(a,n);function s(e){t(o,r,i,s,l,"next",e)}function l(e){t(o,r,i,s,l,"throw",e)}s(void 0)}))}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function i(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=m(e))||t){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==a.return||a.return()}finally{if(s)throw i}}}}function s(e,t,a){return(t=p(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(){c=function(){return t};var e,t={},a=Object.prototype,n=a.hasOwnProperty,r=Object.defineProperty||function(e,t,a){e[t]=a.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function d(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,a){return e[t]=a}}function u(e,t,a,n){var i=t&&t.prototype instanceof _?t:_,o=Object.create(i.prototype),s=new D(n||[]);return r(o,"_invoke",{value:C(e,a,s)}),o}function p(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",v="executing",g="completed",h={};function _(){}function y(){}function P(){}var b={};d(b,o,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(M([])));O&&O!==a&&n.call(O,o)&&(b=O);var L=P.prototype=_.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function a(r,i,o,s){var l=p(e[r],e,i);if("throw"!==l.type){var d=l.arg,c=d.value;return c&&"object"==typeof c&&n.call(c,"__await")?t.resolve(c.__await).then((function(e){a("next",e,o,s)}),(function(e){a("throw",e,o,s)})):t.resolve(c).then((function(e){d.value=e,o(d)}),(function(e){return a("throw",e,o,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function C(t,a,n){var r=f;return function(i,o){if(r===v)throw Error("Generator is already running");if(r===g){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=E(s,n);if(l){if(l===h)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=v;var d=p(t,a,n);if("normal"===d.type){if(r=n.done?g:m,d.arg===h)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r=g,n.method="throw",n.arg=d.arg)}}}function E(t,a){var n=a.method,r=t.iterator[n];if(r===e)return a.delegate=null,"throw"===n&&t.iterator.return&&(a.method="return",a.arg=e,E(t,a),"throw"===a.method)||"return"!==n&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=p(r,t.iterator,a.arg);if("throw"===i.type)return a.method="throw",a.arg=i.arg,a.delegate=null,h;var o=i.arg;return o?o.done?(a[t.resultName]=o.value,a.next=t.nextLoc,"return"!==a.method&&(a.method="next",a.arg=e),a.delegate=null,h):o:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,h)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function M(t){if(t||""===t){var a=t[o];if(a)return a.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function a(){for(;++r<t.length;)if(n.call(t,r))return a.value=t[r],a.done=!1,a;return a.value=e,a.done=!0,a};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=P,r(L,"constructor",{value:P,configurable:!0}),r(P,"constructor",{value:y,configurable:!0}),y.displayName=d(P,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,d(e,l,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},k(T.prototype),d(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,a,n,r,i){void 0===i&&(i=Promise);var o=new T(u(e,a,n,r),i);return t.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(L),d(L,l,"Generator"),d(L,o,(function(){return this})),d(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),a=[];for(var n in t)a.push(n);return a.reverse(),function e(){for(;a.length;){var n=a.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=M,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var a=this;function r(n,r){return s.type="throw",s.arg=t,a.next=n,r&&(a.method="next",a.arg=e),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),d=n.call(o,"finallyLoc");if(l&&d){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),I(a),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;I(a)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,a,n){return this.delegate={iterator:M(t),resultName:a,nextLoc:n},"next"===this.method&&(this.arg=e),h}},t}function u(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||m(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function m(t,a){if(t){if("string"==typeof t)return e(t,a);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,a):void 0}}var v={addressPrefix:"//secure-",webProtocol:"https:",configGlobalVer:"600",sdkvForConfig:"bj.6.0.0",localBuildVer:"",collectionAddress:"",nsdkvOverride:"600",baseConfigUrl:"https://secure-gl.imrworldwide.com/novms/js/2/ggcmb510.js",baseConfigUrlBucket:"cgi-bin/",sessionIdUrlPrefix:"cgi-bin/gn?prd=session&c9=devid,&c13=asid,",sessionIdUrlSuffix:"&sessionId=|!nol_userSessionId!|&c16=sdkv,|!nol_sdkv!|&uoo=|![nol_useroptout]!|&fp_id=|![(nol_fpid)]!|&fp_cr_tm=|![nol_fpidCreateTime]!|&fp_acc_tm=|![nol_fpidAccessTime]!|&fp_emm_tm=|![nol_fpidLastEMMPingTime]!|&ve_id=|![(nol_veid)]!|&c30=bldv,|![nol_bldv||nol_bldVersion]!|&uid2=|![(nol_uid2)]!|&uid2_token=|![(nol_uid2Token)]!|&hem_sha256=|![(nol_hemSha256)]!|&hem_sha1=|![(nol_hemSha1)]!|&hem_md5=|![(nol_hemMd5)]!|&hem_unknown=|![(nol_hemUnknown)]!|",imridCookieKey:"IMRID",cdnAddress:"imrworldwide.com",domain:"imrworldwide.com",nielsenDomains:[".imrworldwide.com",".nmrodam.com"],configGlobalFile:"glcfg510.js",buildVersion:"6.0.0.16",defaultSfCode:"sdk",defaultNsdkv:600,subdomain:"cdn-gl",paramPrefix:"",maxRetries:5,sdkUrl:"{{protocol}}//{{subdomain}}.{{domain}}/novms/js/{{sdksubpath}}/nlsSDK{{nsdkv}}.bundle.min.js",dprConfigAPI:"cfg",dprErrorAPI:"error",defaultTimelineSize:5,cdnAddressDomainPrefix:"https://cdn-gl",defaultCdnAddress:"https://sdk.imrworldwide.com/",euMarketFileMap:"600.eu",domlessSuffix:"_dl",sdkBuildVersion:"702",TAG:"BSDKDOMless"},g=function(){return global||window},h=function(){return(new Date).getTime()},_=function(e){return null!=e?v.cdnAddressDomainPrefix+e:v.defaultCdnAddress},y=function(e,t,a){a.configs=a.configs||{},a.configs[e]=a.configs[e]||t,a.getDomlessEnv=function(){return a.configs[e]&&a.configs[e].nol_GLOBALS&&a.configs[e].nol_GLOBALS.domlessEnv?a.configs[e].nol_GLOBALS.domlessEnv:"-1"}},P=function(){var e=a(c().mark((function e(t,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){a&&a._storageGetItem?a._storageGetItem("config_".concat(t)).then((function(t){if(t)try{if("string"==typeof t){var a=JSON.parse(t);e(a)}else e(t)}catch(e){n(new Error("Error parsing cached config",e))}else n(new Error("No cached config available"))})).catch((function(e){n(new Error("Error retrieving cached config",e))})):n(new Error("Storage not available"))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),b=function(){var e=a(c().mark((function e(t,n,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=a(c().mark((function e(a,i){var o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||!r._storageSetItem){e.next=7;break}return o={config:n,timestamp:h()},e.next=4,r._storageSetItem("config_".concat(t),JSON.stringify(o));case 4:a(),e.next=8;break;case 7:i(new Error("Storage not available"));case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),S=function(){function e(t){var r=this;if(n(this,e),!t)throw new Error("FuncsProcessor: args is required");t.domlessEnv&&(this.domlessEnv=t.domlessEnv),t.nol_sdkDebug&&(this.nol_sdkDebug=t.nol_sdkDebug.toString().toLowerCase()),this.implementationHooks=t.implementationHooks,this.offlinePingLimit=300,this.quotaExceeded=!1,a(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.performEnvironmentMappings(r.domlessEnv);case 2:case"end":return e.stop()}}),e)})))()}return i(e,[{key:"validateFuncs",value:function(){var e=this;["Log","Fetch","Storage","SetTimeout","ClearTimeout","SetInterval","ClearInterval"].forEach((function(t){if(!e.implementationHooks[t])throw new Error("Missing required function: ".concat(t))}))}},{key:"testIfQuotaExceededError",value:function(e){return"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message&&e.message.includes("quota exceeded")}},{key:"resetQuotaExceeded",value:function(){this.quotaExceeded=!1}},{key:"initialize",value:(s=a(c().mark((function e(t){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initialized=!0,this.processQueue(),this.validateFuncs(),t&&t.nol_GLOBALS&&t.nol_GLOBALS.nol_tagMap&&t.nol_GLOBALS.nol_tagMap.nol_defaults.nol_offlinePingsLimit&&(a="string"==typeof t.nol_GLOBALS.nol_tagMap.nol_defaults.nol_offlinePingsLimit?parseInt(t.nol_GLOBALS.nol_tagMap.nol_defaults.nol_offlinePingsLimit):t.nol_GLOBALS.nol_tagMap.nol_defaults.nol_offlinePingsLimit,this.offlinePingLimit=a);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"processQueue",value:function(){for(;this.queue.length>0;){var e=this.queue.shift(),t=e.method,a=e.args;this[t].apply(this,u(a))}}},{key:"queueOrExecute",value:function(e,t){this.initialized?this[e].apply(this,u(t)):this.queue.push({method:e,args:t})}},{key:"performEnvironmentMappings",value:(o=a(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){"custom"===t?e():"reactnative"!==t&&"amazon"!==t&&"nodejs"!==t||(n.implementationHooks.Log?n.implementationHooks.Log={info:n.implementationHooks.Log.info||console.log,debug:n.implementationHooks.Log.debug||console.log,warn:n.implementationHooks.Log.warn||console.warn,error:n.implementationHooks.Log.error||console.error}:n.implementationHooks.Log={info:console.log,debug:console.log,warn:console.warn,error:console.error},n.implementationHooks.Fetch||(n.implementationHooks.Fetch=function(){var e=a(c().mark((function e(t,a){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:if(!(r=e.sent)||!r.ok){e.next=6;break}return n.implementationHooks.Log.info("Response is OK"),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),n.implementationHooks.SetTimeout||(n.implementationHooks.SetTimeout=setTimeout),n.implementationHooks.ClearTimeout||(n.implementationHooks.ClearTimeout=clearTimeout),n.implementationHooks.SetInterval||(n.implementationHooks.SetInterval=setInterval),n.implementationHooks.ClearInterval||(n.implementationHooks.ClearInterval=clearInterval),e())})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"storageSetItem",value:function(e,t){this.queueOrExecute("_storageSetItem",[e,t])}},{key:"_storageSetItem",value:(r=a(c().mark((function e(t,a){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.implementationHooks.Storage||!this.implementationHooks.Storage.setItem){e.next=23;break}if(!0!==this.quotaExceeded){e.next=4;break}return this.logDebug("Quota exceeded. Not storing ping."),e.abrupt("return");case 4:if("storedRequests"!==t){e.next=13;break}return e.next=7,this.implementationHooks.Storage.getItem(t);case 7:if(null==(n=e.sent)||!K(n)){e.next=13;break}if(!((JSON.parse(n).length||0)>=this.offlinePingLimit)){e.next=13;break}return this.logDebug("Offline ping limit reached. Not storing ping."),e.abrupt("return");case 13:return e.prev=13,e.next=16,this.implementationHooks.Storage.setItem(t,a);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(13),this.testIfQuotaExceededError(e.t0)?this.quotaExceeded=!0:this.logError("Error writing to storage: ".concat(e.t0));case 21:e.next=24;break;case 23:this.logDebug("Storage.setItem not available.");case 24:case"end":return e.stop()}}),e,this,[[13,18]])}))),function(e,t){return r.apply(this,arguments)})},{key:"storageGetItem",value:function(e){this.queueOrExecute("_storageGetItem",[e])}},{key:"_storageGetItem",value:(t=a(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.implementationHooks.Storage||!this.implementationHooks.Storage.getItem){e.next=6;break}return e.next=3,this.implementationHooks.Storage.getItem(t);case 3:return e.abrupt("return",e.sent);case 6:return this.logDebug("Storage.getItem not available."),e.abrupt("return","");case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"storageRemoveItem",value:function(e){this.queueOrExecute("_storageRemoveItem",[e])}},{key:"_storageRemoveItem",value:function(e){if(this.implementationHooks.Storage&&this.implementationHooks.Storage.removeItem)return this.quotaExceeded=!1,this.implementationHooks.Storage.removeItem(e);this.logDebug("Storage.removeItem not available.")}},{key:"storageClear",value:function(){this.queueOrExecute("_storageClear",[])}},{key:"_storageClear",value:function(){if(this.implementationHooks.Storage&&this.implementationHooks.Storage.clear)return this.quotaExceeded=!1,this.implementationHooks.Storage.clear();this.logDebug("Storage.clear not available.")}},{key:"logInfo",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.info&&("info"===this.nol_sdkDebug||"debug"===this.nol_sdkDebug)&&this.implementationHooks.Log.info(e)}},{key:"logDebug",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.debug&&"debug"===this.nol_sdkDebug&&this.implementationHooks.Log.debug(e)}},{key:"logWarn",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.warn&&("warn"===this.nol_sdkDebug||"debug"===this.nol_sdkDebug)&&this.implementationHooks.Log.warn(e)}},{key:"logError",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.error&&("error"===this.nol_sdkDebug||"debug"===this.nol_sdkDebug)&&this.implementationHooks.Log.error(e)}},{key:"fetchUrl",value:function(e,t){if(this.implementationHooks.Fetch)return t||(t={}),this.implementationHooks.Fetch(e,t);Promise.reject("Fetch function has not been provided to Nielsen SDK")}},{key:"processSetTimeout",value:function(e,t){if(this.implementationHooks.SetTimeout)return this.implementationHooks.SetTimeout(e,t);throw new Error("setTimeout function has not been provided to Nielsen SDK")}},{key:"processClearTimeout",value:function(e){if(this.implementationHooks.ClearTimeout)return this.implementationHooks.ClearTimeout(e);throw new Error("clearTimeout function has not been provided to Nielsen SDK")}},{key:"processSetInterval",value:function(e,t){if(this.implementationHooks.SetInterval)return this.implementationHooks.SetInterval(e,t);throw new Error("setInterval function has not been provided to Nielsen SDK")}},{key:"processClearInterval",value:function(e){if(this.implementationHooks.ClearInterval)return this.implementationHooks.ClearInterval(e);throw new Error("clearInterval function has not been provided to Nielsen SDK")}}],[{key:"getInstance",value:function(t){return e.instance||(e.instance=new e(t),e.instance.initialized=!1,e.instance.queue=[]),e.instance}},{key:"clearInstance",value:function(){e.instance=null}}]);var t,r,o,s}(),O=function(){function e(){var t=this;n(this,e),s(this,"updateState",(function(e){t.state=d(d({},t.state),e),t.logEvent("State updated",e)})),s(this,"getState",(function(){return t.state})),s(this,"ok",(function(){return t.state.initialized})),s(this,"logEvent",(function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.state.eventLogs.push({message:e,data:a,timeStamp:new Date})})),s(this,"setInitialized",(function(e){t.state.initialized=e})),this.state={initialized:!1,networkStatus:"offline",pendingRequests:[],eventLogs:[]}}return i(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"clearInstance",value:function(){e.instance=null}}])}(),L=function(){function e(t){var r=this;if(n(this,e),!t)throw new Error("NetworkRequestManager: args is required");t&&void 0!==t.implementationHooks?(this.funcsProcessor=S.getInstance({implementationHooks:t.implementationHooks}),this.storage=this.funcsProcessor.implementationHooks.Storage):(this.funcsProcessor=function(){},this.storage={getItem:function(){},setItem:function(){}},this.fetchFn=function(){}),this.retryInterval=9e4,this.sessionRetryInterval=2e3,this.maxRetries=5,this.expiryTime=6048e5,this.writingStorage=!1,this.requestQueue=[],this.isOnline=!0,this.retryingRequests=new Set,this.storageQueue=[],this.processingStorageQueue=!1,this.isRetryingStoredRequests=!1,this.debugIsEnabled=!1,this.sessionManager=null,this.funcsProcessor&&this.funcsProcessor.processSetInterval&&(this.retryIntervalId=this.funcsProcessor.processSetInterval(a(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==r.isOnline){e.next=4;break}e.t0=!r.isOnline,e.next=7;break;case 4:return e.next=6,r.ifOffline(!0);case 6:e.t0=e.sent;case 7:!1===e.t0&&r.retryStoredRequests();case 9:case"end":return e.stop()}}),e)}))),3e5)),this.processOnlineStatus()}return i(e,[{key:"processOnlineStatus",value:function(t){this.isOnline=t,e.StatusModule&&e.StatusModule.updateState&&e.StatusModule.updateState({networkStatus:this.isOnline?"online":"offline"})}},{key:"setDebugEnabled",value:function(e){var t=e.isEnabled,a=e.sessionMgr;this.debugIsEnabled=t,null===this.sessionManager&&!0===this.debugIsEnabled&&(this.sessionManager=a)}},{key:"setSessionId",value:function(e){this.sessionId=e}},{key:"fetchWithRetry",value:(v=a(c().mark((function e(t,a,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.funcsProcessor.implementationHooks.Fetch(t,a);case 3:if(!(r=e.sent)||!r.ok){e.next=12;break}return this.processOnlineStatus(!0),!0===this.debugIsEnabled&&null!==this.sessionManager&&void 0!==this.sessionId&&this.sessionManager.trackFetchRequest(this.sessionId,t,r.status),e.next=9,this.retryStoredRequests();case 9:return e.abrupt("return",r);case 12:throw new Error("Fetch failed with status: ".concat(r.status));case 13:e.next=26;break;case 15:if(e.prev=15,e.t0=e.catch(0),this.processOnlineStatus(!1),"session"!==n){e.next=23;break}return e.next=21,this.retrySessionPing(t,a,1);case 21:e.next=25;break;case 23:return e.next=25,this.retryFetch(t,a,1);case 25:return e.abrupt("return",Promise.resolve(e.t0));case 26:case"end":return e.stop()}}),e,this,[[0,15]])}))),function(e,t,a){return v.apply(this,arguments)})},{key:"retrySessionPing",value:(m=a(c().mark((function e(t,n,r){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r>this.maxRetries)){e.next=5;break}return e.next=3,this.storeRequest(t,n);case 3:return this.funcsProcessor.logInfo("Max retry reached for sending session ping."),e.abrupt("return");case 5:this.funcsProcessor.processSetTimeout(a(c().mark((function e(){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1!==t.indexOf("&retry=")&&(t=t.replace(/&retry=\d/,"&retry=".concat(r))),e.prev=1,e.next=4,i.funcsProcessor.implementationHooks.Fetch(t,n);case 4:if(!(a=e.sent)||!a.ok){e.next=12;break}return i.processOnlineStatus(!0),!0===i.debugIsEnabled&&null!==i.sessionManager&&void 0!==i.sessionId&&i.sessionManager.trackFetchRequest(i.sessionId,t,a.status),i.funcsProcessor.logDebug("Session ping fired successfully."),e.abrupt("return",a);case 12:throw new Error("Fetch failed with status: ".concat(a.status));case 13:e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(1),i.processOnlineStatus(!1),e.next=20,i.retrySessionPing(t,n,r+1);case 20:case"end":return e.stop()}}),e,null,[[1,15]])}))),this.sessionRetryInterval);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return m.apply(this,arguments)})},{key:"retryFetch",value:(f=a(c().mark((function e(t,n,r){var i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r>this.maxRetries)){e.next=4;break}return e.next=3,this.storeRequest(t,n);case 3:return e.abrupt("return");case 4:this.funcsProcessor.processSetTimeout(a(c().mark((function e(){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.funcsProcessor.implementationHooks.Fetch(t,n);case 3:if(!(a=e.sent)||!a.ok){e.next=12;break}return i.processOnlineStatus(!0),!0===i.debugIsEnabled&&null!==i.sessionManager&&void 0!==i.sessionId&&i.sessionManager.trackFetchRequest(i.sessionId,t,a.status),e.next=9,i.retryStoredRequests();case 9:return e.abrupt("return",a.data);case 12:throw new Error("Fetch failed with status: ".concat(a.status));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),i.processOnlineStatus(!1),i.retryFetch(t,n,r+1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])}))),this.retryInterval);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return f.apply(this,arguments)})},{key:"storeRequest",value:(p=a(c().mark((function e(t,n){var r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storageQueue.push(a(c().mark((function e(){var a,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getStoredRequests();case 2:if(a=e.sent,i=a.some((function(e){return e.url===t})),i){e.next=8;break}return a.push({url:t,options:n,timestamp:Date.now()}),e.next=8,r.setStoredRequests(a);case 8:case"end":return e.stop()}}),e)})))),this.processStorageQueue();case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"getStoredRequests",value:(u=a(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.funcsProcessor||!this.funcsProcessor._storageGetItem){e.next=7;break}return e.next=3,this.funcsProcessor._storageGetItem("storedRequests");case 3:return t=e.sent,e.abrupt("return",t?JSON.parse(t):[]);case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"setStoredRequests",value:(d=a(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.funcsProcessor||!this.funcsProcessor.storageSetItem){e.next=3;break}return e.next=3,this.funcsProcessor.storageSetItem("storedRequests",JSON.stringify(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"processStorageQueue",value:(l=a(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.processingStorageQueue){e.next=2;break}return e.abrupt("return");case 2:this.processingStorageQueue=!0;case 3:if(!(this.storageQueue.length>0)){e.next=9;break}return t=this.storageQueue.shift(),e.next=7,t();case 7:e.next=3;break;case 9:this.processingStorageQueue=!1;case 10:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"assignValuesFromConfig",value:(s=a(c().mark((function e(t){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.config&&t.config.nol_GLOBALS&&((a=t.config.nol_GLOBALS).nol_intrvlThrshld&&(this.retryInterval=1e3*a.nol_intrvlThrshld||9e4),a.nol_maxRetry&&(this.maxRetries=a.nol_maxRetry||5));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"retryStoredRequests",value:(r=a(c().mark((function e(){var t,a,n,r,i,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isRetryingStoredRequests){e.next=2;break}return e.abrupt("return");case 2:return this.isRetryingStoredRequests=!0,e.next=5,this.getStoredRequests();case 5:t=e.sent,a=[],n=o(t),e.prev=8,i=c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.value,n="".concat(t.url,"-").concat(JSON.stringify(t.options)),!s.retryingRequests.has(n)){e.next=4;break}return e.abrupt("return",0);case 4:if(!1!==s.isOnline){e.next=7;break}return a.push(t),e.abrupt("return",0);case 7:return e.prev=7,s.retryingRequests.add(n),e.next=11,s.funcsProcessor.implementationHooks.Fetch(t.url,t.options);case 11:if(!(i=e.sent)||!i.ok){e.next=18;break}s.processOnlineStatus(!0),!0===s.debugIsEnabled&&null!==s.sessionManager&&void 0!==s.sessionId&&s.sessionManager.trackFetchRequest(s.sessionId,t.url,i.status),s.retryingRequests.delete(n),e.next=19;break;case 18:throw new Error("Fetch failed with status: ".concat(i.status));case 19:e.next=27;break;case 21:e.prev=21,e.t0=e.catch(7),s.processOnlineStatus(!1),a.some((function(e){return e.url===t.url}))||a.push(t),s.retryingRequests.delete(n);case 27:return e.next=29,new Promise((function(e){return s.funcsProcessor.processSetTimeout(e,1e3)}));case 29:case"end":return e.stop()}}),e,null,[[7,21]])})),n.s();case 11:if((r=n.n()).done){e.next=18;break}return e.delegateYield(i(),"t0",13);case 13:if(0!==e.t0){e.next=16;break}return e.abrupt("continue",16);case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(8),n.e(e.t1);case 23:return e.prev=23,n.f(),e.finish(23);case 26:return e.next=28,this.setStoredRequests(a);case 28:this.funcsProcessor.resetQuotaExceeded(),this.isRetryingStoredRequests=!1;case 30:case"end":return e.stop()}}),e,this,[[8,20,23,26]])}))),function(){return r.apply(this,arguments)})},{key:"ifOffline",value:(t=a(c().mark((function e(){var t,a=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(a.length>0&&void 0!==a[0]&&a[0])||!1!==this.isOnline){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,this.funcsProcessor.implementationHooks.Fetch("https://cdn-gl.imrworldwide.com/hello.html?",{method:"HEAD"});case 6:return t=e.sent,this.processOnlineStatus(!(!t||!t.ok)&&t.ok),e.abrupt("return",!this.isOnline);case 11:return e.prev=11,e.t0=e.catch(3),this.processOnlineStatus(!1),e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(){return t.apply(this,arguments)})},{key:"clearRetryInterval",value:function(){this.retryIntervalId&&this.funcsProcessor.processClearInterval(this.retryIntervalId)}}],[{key:"getInstance",value:function(t){return e.instance||(e.instance=new e(t)),e.instance}},{key:"clearInstance",value:function(){e.instance=null}}]);var t,r,s,l,d,u,p,f,m,v}();s(L,"StatusModule",O.getInstance());var k="",T=5,C={defaultNSDKV:v.defaultNsdkv,defaultSfcode:v.defaultSfCode,subdomain:v.subdomain,domain:v.domain,protocol:v.webProtocol,sdkUrl:v.sdkUrl},E={eu:v.euMarketFileMap,"eu-cert":v.euMarketFileMap,"eu-uat":v.euMarketFileMap},w={},I=function(e,t,a){var n=g();(!n[e]||n[e]&&!n[e][a.name])&&(n[e]={},a.name&&(n[e][a.name]={g:void 0!==a?a:{}}));var r={apid:t,sfcode:N.getDefaultField("nol_sfcode")||C.defaultSfcode,nsdkv:C.defaultNSDKV},i=n[e][a.name]||n[a.name],o=i?i.g:{};if(o)for(var s=Object.keys(o),l=0;l<s.length;l++)void 0!==o[s[l]]&&null!==o[s[l]]&&""!==o[s[l]]&&(r[s[l]]=o[s[l]],"deviceId"!==s[l]||void 0===o.optout||"true"!==o.optout&&!0!==o.optout||(r[s[l]]=""));r.sfcode=N.getGlobalsField(e,t,"nol_sfcode")||r.sfcode,r.nsdkv=N.getGlobalsField(e,t,"nol_nsdkvConfig")||N.getGlobalsField(e,t,"nol_nsdkv")||E[r.sfcode]||r.nsdkv,r=N.setTesting(r);var d=N.getGlobalsField(e,t,"nol_sdkDebug");return d&&(r.nol_sdkDebug=d),r},D=function(e){var t=g()[e];return t&&t.hasOwnProperty("isBuilt")&&"function"==typeof t.isBuilt&&t.isBuilt()},M=function(e,t,a,n){var r=S.getInstance();try{r.logDebug("MESSAGE: DONT BELEIVE WE NEED THIS ANY LONGER (QUEUE CONTROLLER) ")}catch(e){}},R=function(e,t){if(t){var a=N.findScript(e);if("string"==typeof a)t(e,N.parseNOLParams(a));else for(var n=0;n<a.length;n++)t(e,N.parseNOLParams(a[n]))}},A=function(e,t){var a,n,r=[],i=e.split("&");for(a=0,n=i.length;a<n;a++)0!==i[a].indexOf(t)&&r.push(i[a]);return r.join("&")};function F(){var e=g();return e&&!e.NOLBUNDLE&&(e.NOLBUNDLE={}),e.NOLBUNDLE}function x(e,t){var a;if("num"==t)a=parseInt(e,10),e=isNaN(a)?0:a;else if("bin"==t)e=isNaN(Number(e))?"0":Number(e).toString(2);else if("bool"==t)switch(e.toString().toLowerCase()){case"false":case"no":case"0":case"":e=!1;break;default:e=!0}else"b2n"==t&&(a=parseInt(e,2),e=isNaN(a)?0:a);return e}function G(){try{var e=pe();return e&&e.availModules&&e.availModules.PLDPR&&e.availModules.PLDPR.cmsMapDictionary?e.availModules.PLDPR.cmsMapDictionary:{}}catch(e){S.getInstance().logError("Error in cmsMapDictionary",e)}}function j(){try{var e=pe();return e&&e.availModules&&e.availModules.PLDPR&&e.availModules.PLDPR.dataObj?e.availModules.PLDPR.dataObj:{}}catch(e){S.getInstance().logError("Error in getDataObj",e)}}var N={parseNOLParams:function(e){var t=e.replace(/^[^\#]+\#?/,""),a={};if(!t)return a;for(var n=new RegExp("&"+k,"gi"),r="<<nol_delimeter>>",i=r+k,o=(t=t.replace(n,i)).split(r),s=null,l=0;l<o.length;l++){s=o[l].indexOf("=");var d=unescape(o[l].substr(0,s)),c=unescape(o[l].substr(s+1));c=c.replace(/\+/g," "),a[d.replace(k,"")]=c}return a},isValidJson:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},findScript:function(e){if(document.currentScript)return document.currentScript.src;var t=document.getElementsByTagName("script"),a=[];if(t)for(var n="",r=null,i=new RegExp(e+".*?.js"),o=0;o<t.length;o++)(n=(r=t[o])&&r.attributes&&r.attributes.src?r.attributes.src.value:"").match(i)&&a.push(n);return a},loadScript:function(e,t,a){var n=0;function r(e,t,a){var n=window.document.createElement("script");n.async=!0,n.setAttribute("data-jsonpid",name),n.src=e,n.onload=t,n.onerror=a;var r=window.document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r)}r(e,t,(function i(o){var s=S.getInstance();n<T?(n++,s.processSetTimeout((function(){s&&s.logWarn("Retry request # "+n),r(e,t,i)}),2e3)):(s&&s.logError("Unable to load script "+e),a&&a())}))},setTesting:function(e){return e&&e.enableTesting&&cfg&&cfg.nol_GLOBALS&&C?("true"===e.enableTesting&&e.bundleVersion&&(e.environment||(e.environment="futuremaster"),"true"===cfg.nol_GLOBALS.nol_allowTesting&&(e.sfcode="cert",e.sdkUrl="//"+e.environment+".nonprod.digitalengsdk.com/novms/js/2/ver/nlsSDK600."+e.bundleVersion+".bundle.min.js")),e):e},getGlobalsField:function(e,t,a){var n=g();if(t&&a&&n[e]&&n[e].configs){var r=n[e].configs[t];if(r&&r.nol_GLOBALS)return r.nol_GLOBALS[a]}return null},getDefaultField:function(e,t,a){var n=g();if(t&&a&&n[e]&&n[e].configs){var r=n[e].configs[t];if(r&&r.nol_GLOBALS&&r.nol_GLOBALS.nol_tagMap&&r.nol_GLOBALS.nol_tagMap.nol_defaults)return r.nol_GLOBALS.nol_tagMap.nol_defaults[a]}return null},param:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a="";if(e&&"object"===f(e)&&Object.keys(e).length>0)for(var n in e)e.hasOwnProperty(n)&&(a+="".concat(""!==a?"&":"").concat(t?t+"-":"").concat(n,"=").concat(e[n]));return a},paramOverride:function(e,t,a){if(e&&t){var n=new RegExp("([&?]+".concat(t,"=)([^&$]*)"),"gi"),r=e.match(n);if(r)for(var i=0,o=r.length;i<o;i++){var s=r[i].substr(0,r[i].indexOf("=")+1)+(a||"");e=e.replace(r[i],s)}}return e}},V={sendMaskedPing:function(e){},request:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";pe();var r=L.getInstance(),i=S.getInstance(),o={method:"GET",credentials:"include",mode:"no-cors"};return new Promise((function(s,l){r.fetchWithRetry(e,o,n).then(function(){var o=a(c().mark((function a(o){var l;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!o||!o.ok){a.next=5;break}i.logDebug("".concat(v.TAG,": Success making fetch to ").concat(e)),s({status:o.status,ok:o.ok,response:o}),a.next=11;break;case 5:if("session"===n){a.next=8;break}return a.next=8,r.storeRequest(e,t);case 8:l="".concat(v.TAG,": Error in fetch request to ").concat(e," - Response: ").concat(JSON.stringify(o)),i.logDebug(l),s(l);case 11:case"end":return a.stop()}}),a)})));return function(e){return o.apply(this,arguments)}}()).catch((function(t){i.logDebug("".concat(v.TAG,": Error in fetch request to ").concat(e," - Error: ").concat(t))}))}))},tsvRequest:function(e,t,a){var n=S.getInstance();return new Promise((function(r,i){if((t=t||{}).method=t.method||"GET",t.data=t.data||"","undefined"!=typeof XMLHttpRequest){var o=new XMLHttpRequest;o.open(t.method,e,null==a||a),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){o.readyState>3&&r&&(o.readyState>3&&r&&r(o),n.logDebug("".concat(v.TAG,": TSV request - ").concat(e)))},o.send(t.data),o.onerror=function(){i&&i("Error in tsvRequest")}}else V.request(e,{method:t.method,headers:{"Content-type":"application/x-www-form-urlencoded"}},!0).then((function(t){if(!t||!t.ok)throw new Error("Error in fetch request to ".concat(e," - Response: ").concat(t));r({status:t.status,ok:t.ok,response:t}),n.logDebug("".concat(v.TAG,": TSV request - ").concat(e))})).catch((function(e){i&&i(e)}))}))}};function B(e){var t=e._pauseTimeoutEnabled,a=e.tsObj,n=a.phTimestamp,r=a.bgTimestamp,i=a.fgTimestamp,o=0;return t?(n<r&&(o=i-r),n>r&&(o=i-n),n===r&&(o=i-r),"number"!=typeof o||isNaN(o)?0:o):o}function H(){return Math.floor(Date.now()/1e3)}function U(e,t){if(e&&e.getConfigParams){var a=e.getConfigParams().ggParams;a.nol_sdkDebug&&["debug","info","warn","true"].indexOf(a.nol_sdkDebug.toString().toLowerCase())>-1&&S.getInstance().logInfo(v.TAG+" Log: "+t||"")}}var q=V.sendMaskedPing,Q=V.request,X=V.tsvRequest,z=N.param,W=N.paramOverride,J=N.parseNOLParams,K=N.isValidJson,Y=N.findScript,$=N.loadScript,Z=N.setTesting,ee=N.getGlobalsField,te=N.getDefaultField,ae=function(){function e(t){n(this,e),this.webProtocol=v.webProtocol,this.addressPrefix=v.addressPrefix,this.configGlobalFile=v.configGlobalFile,this.cacheBusterRefreshMilliseconds=864e5,this.maxNumberOfAssetInstances=1,this.numSecToUpdateAssets=5,this.startGlobalTime=0,this.currentGlobalTime=0,this.currentGlobalSeconds=0,this.stateObj={},this.optOutStatus=!1,this.sessionIdUrlPrefix=v.sessionIdUrlPrefix,this.configGlobalVer=v.configGlobalVer,this.nsdkvOverride=v.nsdkvOverride,this.nielsenDomains=v.nielsenDomains;var a=this.getInstances();this.__instance=void 0!==a?a:{},this.isBuilt=!1,this.sdkvForConfig=v.sdkvForConfig,this._localBuildVer=v.sdkBuildVersion,this.BUILDVERSION=v.buildVersion,this.debug=0,this._configs={paramPrefix:v.paramPrefix,maxRetries:v.maxRetries},this._sdkSettings={defaultNSDKV:v.defaultNsdkv,defaultSfcode:v.defaultSfCode,subdomain:v.subdomain,domain:v.domain,protocol:v.webProtocol,sdkUrl:v.sdkUrl},this.marketFileMap={eu:v.euMarketFileMap,"eu-cert":v.euMarketFileMap,"eu-uat":v.euMarketFileMap},this._glcfg=t,this.globalObj=g(),this.getConfigAddress=this.getConfigAddress.bind(this),this.getAddress=this.getAddress.bind(this),this.funcsProcessor=S.getInstance()}return i(e,[{key:"removeInstance",value:function(e){this.__instance.hasOwnProperty(e)&&delete this.__instance[e]}},{key:"getInstance",value:function(e){var t=void 0!==e&&("string"==typeof e||"object"==f(e)&&e.constructor===String)?e:"default";return this.__instance.hasOwnProperty(t)||(this.__instance[t]=Xe(t)),this.__instance[t]}},{key:"getInstances",value:function(){return this.__instance}},{key:"getAddress",value:function(){return _()}},{key:"getConfigAddress",value:function(){return this.collectionAddress}},{key:"getAddressProtocol",value:function(){return this.webProtocol}},{key:"loadXmlString",value:function(e){return null}},{key:"isNielsenTag",value:function(e){var t=!1;if(void 0!==e){var a=e.indexOf("?"),n=-1!==e.indexOf(this.nielsenDomains[0])?e.indexOf(this.nielsenDomains[0]):e.indexOf(this.nielsenDomains[1]);n>-1&&n<a&&(t=!0)}return t}},{key:"getVersion",value:function(){return this.configGlobalVer}},{key:"getVersionOverride",value:function(){return this.nsdkvOverride}},{key:"send",value:function(e){e&&this.funcsProcessor&&this.funcsProcessor.logDebug(e.parentNode)}},{key:"browserSafeAddEventListener",value:function(e){void 0!==e.element&&(e.element.addEventListener?e.element.addEventListener(e.eventType,e.func,e.useCapture):e.element.attachEvent&&e.element.attachEvent("on"+e.eventType,e.func))}},{key:"browserSafeRemoveEventListener",value:function(e){null!=e&&null!==e.element&&void 0!==e.element&&(e.element.removeEventListener?e.element.removeEventListener(e.eventType,e.func,e.useCapture):e.element.detachEvent&&e.element.detachEvent("on"+e.eventType,e.func))}}],[{key:"getStaticInstance",value:function(t){return e.instance||(e.instance=new e(t)),e.instance}},{key:"clearInstance",value:function(){e.instance=null}}])}();function ne(e,t,a){var n=g(),r=F();e&&void 0===e.dcrTimer&&(e.dcrTimer={});var i=e.dcrTimer;return i.set=function(e,t){return i.init=!0,i.elapsed=0,i.startTimeStamp=0,"function"==typeof e&&(i.funcCall=e),isNaN(t)||(i.intervalTime=t),i},i.play=function(e){return i.isActive||(e?(i.startTimeStamp=0,i.elapsed=0,i.setTimer()):i.setTimer(i.remaining),i.isActive=!0),i},i.pause=function(){return i.isActive&&(i.isActive=!1,i.remaining=i.remaining-(Date.now()-i.last),i.clearTimer()),i},i.stop=function(){return i.isActive=!1,i.remaining=i.intervalTime,i.clearTimer(),i},i.clearTimer=function(){n.clearTimeout(i.timeoutObject)},i.setTimer=function(e){var t=i;"function"==typeof i.funcCall&&(isNaN(e)&&(e=i.intervalTime),i.remaining=e,i.last=Date.now(),i.clearTimer(),i.timeoutObject=S.getInstance().processSetTimeout((function(){t.tick()}),e))},i.tick=function(){if(i.isActive){var e=i.last;i.remaining<i.intervalTime&&(e-=i.intervalTime-i.remaining),i.setTimer();var t=(i.last-e)/1e3;t<r.GLCFG.availModules.PLDCR.nol_maxTickDelta&&t>=0?i.elapsed=Math.floor(i.elapsed+t):i.elapsed++,i.funcCall()}},i.reset=function(){i.startTimeStamp=0,i.elapsed=0,i.remaining=i.intervalTime},i.init||i.set(t,a),i}function re(e){try{var t,a=function(){p.dcrTimer&&(p.latestDcrTickVal=p.dcrTimer.elapsed,u._listeners.fireEvent("dcrHeartbeat",p.dcrTimer)),p.focusTimer.enableTimeout&&p.focusTimer.timeElapsed&&(p.focusTimer.enableTimeout=!1)},n=function(e){t&&clearTimeout(t),u.globalHasFocus&&!u.globalHasFocus()&&(t=v.processSetTimeout((function(){p.safeFocusOn&&p.dcrTimer&&(p.safeFocusOn=!1,u.globalHasFocus&&!u.globalHasFocus()&&(u._listeners.fireEvent("info",{type:"info",msg:"Safe Focus timeout"}),p.dcrTimer.pause(),u.flushEvent(e))),clearTimeout(t)}),1e3*p.nol_idleTimeout),!p.safeFocusOn&&p.dcrTimer&&(u._listeners.fireEvent("info",{type:"info",msg:"Safe Focus initiated"}),p.safeFocusOn=!0,p.dcrTimer.play(p._reset),p._reset=!1))},r=function(e){(self===top||self!==top&&u.globalHasFocus&&!u.globalHasFocus())&&(S.getInstance().processSetTimeout((function(){return function(e){u.globalHasFocus&&u.globalHasFocus()?p.focusTimer.intervalID=o():p.dcrTimer&&(p.dcrTimer.pause(),u._listeners.fireEvent("info",{type:"info",msg:"Page onBlur fired and stopping static timer: ".concat(e?JSON.stringify(e,["type","isTrusted"]):"{}")}))}(e)}),0),p.safeFocusOn&&(p.safeFocusOn=!1))},i=function(e){S.getInstance().processSetTimeout((function(){return function(e){p.dcrTimer&&(p.dcrTimer.pause(),u._listeners.fireEvent("info",{type:"info",msg:"Page onBlur fired and stopping static timer: ".concat(e?JSON.stringify(e,["type","isTrusted"]):"{}")}))}(e)}),0),p.safeFocusOn&&(p.safeFocusOn=!1)},o=function(){if(!p.focusTimer.intervalID&&!u.browser.isWithinIFrame())return setInterval((function(){if(p.dcrTimer&&!p.dcrTimer.isActive&&u.globalHasFocus&&u.globalHasFocus()&&(p.dcrTimer.play(!0),p._reset=!1,u._listeners.fireEvent("info",{type:"info",msg:"Page has focus via focus interval timer. Playing DCR Static timer!"})),p.focusTimer.enableTimeout){var e=Date.now(),t=(e-p.focusTimer.timeoutStartTime)/1e3;p.focusTimer.timeElapsed=p.focusTimer.timeElapsed+t,p.focusTimer.timeElapsed>p.nol_idleTimeout&&(clearInterval(p.focusTimer.intervalID),p.focusTimer.intervalID=null),p.focusTimer.timeoutStartTime=e}}),1e3)},s=function(e){p.dcrTimer&&!p.disableTimer&&(p.dcrTimer.play(p._reset),u._listeners.fireEvent("info",{type:"info",msg:"Page onFocus fired and playing static timer: ".concat(e?JSON.stringify(e,["type","isTrusted"]):"{}")})),p.focusTimer.intervalID&&(clearInterval(p.focusTimer.intervalID),p.focusTimer.intervalID=null),p._reset=!1},l=function(e){n(e)},d=function(e){p.dcrTimer&&p.dcrTimer.stop()},c=e.global,u=e.glcfg,p=u.availModules.PLDCR=u.availModules.PLDCR||{dcrTimer:void 0,startDcrTime:0,latestDcrTickVal:0,_reset:!1,nol_idleTimeout:1800,nol_maxTickDelta:10,cadenceOverrideEnabled:!1,cadenceOverride:30,safeFocusOn:!1,focusTimer:{intervalID:null,timeElapsed:0,enableTimeout:!1,timeoutStartTime:0},disableTimer:!1},f=e.ns,m=u.getBaseBuildVer?u.getBaseBuildVer()+"1":"6.0.01",v=S.getInstance();p.startDcrTick=function(){},p.latestDcrTick=function(){return p.latestDcrTickVal};return p.start=function(e){var t=!u.globalHasFocus||u.globalHasFocus();p._reset=e,p.disableTimer=!1,(null===p.dcrTimer||void 0===p.dcrTimer||e)&&(t?(p.dcrTimer=ne(p,a,1e3).play(!0),p._reset=!1):p.dcrTimer=ne(p,a,1e3))},p.stop=function(e){p.dcrTimer&&p.dcrTimer.stop(),!e||"56"!==e&&"staticend"!==e||(p.disableTimer=!0)},p.init=function(e){u._listeners.addListener("blur",(function(e){i(e)})),u._listeners.addListener("focus",(function(e){s(e)}))},p.removeListeners=function(){f.browserSafeRemoveEventListener({element:c,eventType:"blur",func:r,useCapture:!1}),f.browserSafeRemoveEventListener({element:c,eventType:"focus",func:s,useCapture:!1}),f.browserSafeRemoveEventListener({element:c,eventType:"touchstart",func:l,useCapture:!1}),f.browserSafeRemoveEventListener({element:c,eventType:"pagehide",func:d,useCapture:!1}),u.browser.removeEventListener({element:c,eventType:"blur",useCapture:!1,func:u.flushEvent}),u.browser.removeEventListener({element:c,eventType:"pagehide",useCapture:!1,func:u.flushEvent})},p.safeFocus=n,p.built||(p.built=!0,p.BUILDVERSION=m,u.bindPlayers(p,"PLDCR")),p}catch(e){S.getInstance().logError("PLDCR Error: ",e)}}var ie=function(){function e(){n(this,e);try{this._glcfg=pe(),this._keys={currentPosition:"nolPriv_currPos",currentTimestamp:"nolPriv_now",stateCurrentPosition:"nolPriv_stateCurrentPH",stateCurrentTimestamp:"nolPriv_stateCurrentTS",stateCurrentStatus:"nolPriv_stateCurrentStatus",stateCurrentAsset:"nolPriv_stateCurrentAsset",stateCurrentType:"nolPriv_stateCurrentType",statePreviousPosition:"nolPriv_statePreviousPH",statePreviousTimestamp:"nolPriv_statePreviousTS",statePreviousStatus:"nolPriv_statePreviousStatus",statePreviousAsset:"nolPriv_statePreviousAsset",statePreviousType:"nolPriv_statePreviousType",tagName:"nol_comment",localTimer:"nol_timer",assetId:"nol_assetid"},this._params={optout:"uoo",nuid:"c1"},this.states={loaded:"LOADED",playing:"PLAYING",paused:"PAUSED",stopped:"STOPPED"},this.asset={current:function(e){return e?e._currAssetid:null},parse:function(e,t){var a=G(),n=a[e.get("nol_playerId")]&&a[e.get("nol_playerId")].nol_assetid?a[e.get("nol_playerId")].nol_assetid.clientField:"nol_assetid";return t?t[n]:null}},this.type={isCurrentlyContent:function(e){return"content"===e._currVidType},isCurrentlyAd:function(e){return"ad"===e._currVidType},isCurrentlyStatic:function(e){return"static"===e._currVidType},current:function(e){return e._currVidType},parse:function(e,t){var a=G()[e.get("nol_playerId")]||{},n=a.nol_vidtype?a.nol_vidtype.clientField:"nol_vidtype",r=t[n]?t[n].toString().toLowerCase():"",i=","+he({data:e,param:"nol_contentType"});return r&&-1!==i.indexOf(","+r)?"content":"dcrstatic"===he({data:e,param:"nol_product"})?"static":"ad"}},this.state={position:{current:function(t,a){return x(he({data:t,param:e.instance._keys.stateCurrentPosition,vidType:a||t._currVidType}),"num")},previous:function(t,a){return x(he({data:t,param:e.instance._keys.statePreviousPosition,vidType:a||t._currVidType}),"num")},set:function(t,a,n){var r=e.instance.state.position.current(t);he({data:t,param:e.instance._keys.statePreviousPosition,val:r,vidType:n||t._currVidType}),he({data:t,param:e.instance._keys.stateCurrentPosition,val:a,vidType:n||t._currVidType})}},timeStamp:{current:function(t,a){return x(he({data:t,param:e.instance._keys.stateCurrentTimestamp,vidType:a||t._currVidType}),"num")},previous:function(t,a){return x(he({data:t,param:e.instance._keys.statePreviousTimestamp,vidType:a||t._currVidType}),"num")},set:function(t,a,n){var r=e.instance.state.timeStamp.current(t);he({data:t,param:e.instance._keys.statePreviousTimestamp,val:r,vidType:n||t._currVidType}),he({data:t,param:e.instance._keys.stateCurrentTimestamp,val:a,vidType:n||t._currVidType})}},asset:{current:function(t,a){return he({data:t,param:e.instance._keys.stateCurrentAsset,vidType:a||t._currVidType})},previous:function(t,a){return he({data:t,param:e.instance._keys.statePreviousAsset,vidType:a||t._currVidType})},set:function(t,a,n){var r=e.instance.state.asset.current(t);he({data:t,param:e.instance._keys.statePreviousAsset,val:r,vidType:n||t._currVidType}),he({data:t,param:e.instance._keys.stateCurrentAsset,val:a,vidType:n||t._currVidType})}},status:{current:function(t,a){return he({data:t,param:e.instance._keys.stateCurrentStatus,vidType:a||t._currVidType})},previous:function(t,a){return he({data:t,param:e.instance._keys.statePreviousStatus,vidType:a||t._currVidType})},set:function(t,a,n){var r=e.instance.state.status.current(t,n);he({data:t,param:e.instance._keys.statePreviousStatus,val:r,vidType:n||t._currVidType}),he({data:t,param:e.instance._keys.stateCurrentStatus,val:a,vidType:n||t._currVidType})}},type:{current:function(t,a){return he({data:t,param:e.instance._keys.stateCurrentType,vidType:a||t._currVidType})},previous:function(t,a){return he({data:t,param:e.instance._keys.statePreviousType,vidType:a||t._currVidType})},set:function(t,a,n){var r=e.instance.state.type.current(t,n);he({data:t,param:e.instance._keys.statePreviousType,val:r,vidType:n||t._currVidType}),he({data:t,param:e.instance._keys.stateCurrentType,val:a,vidType:n||t._currVidType})}},set:function(t,a){var n=e.instance.findPlayer(t);switch(a.event){case"LOAD":e.instance.state.asset.set(t,a.assetId,a.contentType),e.instance.state.type.set(t,a.contentType),e.instance.state.timeStamp.set(t,a.timestamp);break;case"PLAY":case"RESUME":e.instance.state.status.set(t,e.instance.states.playing),e.instance.state.asset.set(t,a.assetId,a.contentType),e.instance.state.type.set(t,a.contentType),e.instance.state.timeStamp.set(t,a.timestamp),"PLAY"===a.event&&e.instance.state.position.set(t,0),"RESUME"===a.event&&null!=a.currentPos&&null!=a.currentPos&&"{{nextTick}}"!=a.currentPos&&(e.instance.state.position.set(t,a.curPos),e.instance.state.timeStamp.set(t,a.timestamp)),n.pauseObj.eventPauseTime=0;break;case"PAUSE":e.instance.state.status.set(t,e.instance.states.paused);break;case"STOP":e.instance.state.resetAsset(t),e.instance.state.status.set(t,e.instance.states.stopped);break;case"PLAYHEAD":case"REWIND":case"FORWARD":e.instance.state.position.set(t,a.curPos),e.instance.state.timeStamp.set(t,a.timestamp),n.pauseObj.eventPauseTime=0;break;case"MUTE":break;case"event_play":n.pauseObj.eventPauseTime=0}},get:function(t,a){try{if(t)return{position:{current:e.instance.state.position.current(t,a),previous:e.instance.state.position.previous(t,a)},timeStamp:{current:e.instance.state.timeStamp.current(t,a),previous:e.instance.state.timeStamp.previous(t,a)},asset:{current:e.instance.state.asset.current(t,a),previous:e.instance.state.asset.previous(t,a)},status:{current:e.instance.state.status.current(t,a),previous:e.instance.state.status.previous(t,a)},type:{current:e.instance.state.type.current(t,a),previous:e.instance.state.type.previous(t,a)}}}catch(e){}return null},resetAsset:function(t){e.instance.state.position.set(t,null),e.instance.state.timeStamp.set(t,null),e.instance.state.asset.set(t,null)},bind:function(t,a){try{if(t&&a)for(var n in a)he({data:t,param:e.instance._keys.statePreviousPosition,val:a[n].position?a[n].position.previous:null,vidType:n}),he({data:t,param:e.instance._keys.stateCurrentPosition,val:a[n].position?a[n].position.current:null,vidType:n}),he({data:t,param:e.instance._keys.statePreviousTimestamp,val:a[n].timeStamp?a[n].timeStamp.current:null,vidType:n}),he({data:t,param:e.instance._keys.stateCurrentTimestamp,al:a[n].timeStamp?a[n].timeStamp.current:null,vidType:n}),he({data:t,param:e.instance._keys.statePreviousAsset,val:a[n].asset?a[n].asset.current:null,vidType:n}),he({data:t,param:e.instance._keys.stateCurrentAsset,val:a[n].asset?a[n].asset.current:null,vidType:n}),he({data:t,param:e.instance._keys.statePreviousStatus,val:a[n].status?a[n].status.current:null,vidType:n}),he({data:t,param:e.instance._keys.stateCurrentStatus,val:a[n].status?a[n].status.current:null,vidType:n}),he({data:t,param:e.instance._keys.statePreviousType,val:a[n].type?a[n].type.current:null,vidType:n}),he({data:t,param:e.instance._keys.stateCurrentType,val:a[n].type?a[n].type.current:null,vidType:n})}catch(e){}},clone:function(t){try{return{content:e.instance.state.get(t,"content"),ad:e.instance.state.get(t,"ad")}}catch(e){}}},this.cms={parse:function(e,t,a){var n={metadata:(a?a.metadata:null)||{},defaultKey:(a?a.defaultKey:"")||"",silent:(a?a.silent:null)||!1,noClone:(a?a.noClone:null)||!1,vidType:a?a.vidType:"",noEncode:!(!a||!0!==a.noEncode)},r=e&&e.clientField?e.clientField:n.defaultKey;if(r&&t){if(n.metadata&&n.metadata.hasOwnProperty(r)&&n.metadata[r])return n.metadata[r];if(e&&e.clientField){if(n.end)return t.get(e.clientField,a?a.vidType:"");var i=t;!0!==n.noClone&&st(i=JSON.parse(JSON.stringify(t)),"loadmetadata",n.metadata,null,!0);var o=[];return!0===n.noEncode?o=[r]:(o=(e.encoding||"").split("")).splice(o.length/2,0,r),n.end=!0,Dt(i,"|!"+o.join("")+"!|",null,n)}}return""}},this.mtvr={isTransPing:function(e){return!!e&&"id3"===he({data:e,param:"nol_product"})},isPCTag:function(e){return!!e&&(e.isProductOf("mtvr")&&""!==he({data:e,param:"nol_subTag"}))},pcChanged:function(e,t){return!!e&&t!==he({data:e,param:"nol_pccid"})},isFDTag:function(e){return!!e&&(e.isProductOf("mtvr")&&""===he({data:e,param:"nol_subTag"}))},fdChanged:function(e,t){return!!e&&t!==he({data:e,param:"nol_fdcid"})},resetTagSession:function(e,t){e&&e.set("nol_sessionId",t||this._glcfg.generateGUID(),"content")},clearTagSession:function(e){if(e)return e.del("nol_sessionId","content")},isNullPCCid:function(e){return e.get("nol_pccid")===e.get("nol_cidNull")},isNullFDCid:function(e){return e.get("nol_fdcid")===e.get("nol_cidNull")}}}catch(e){}}return i(e,[{key:"findPlayer",value:function(t){if(t){if("string"==typeof t)return this._glcfg._players[t];var a=he({data:t,param:"nol_playerId"});return e.instance.findPlayer(a)}return null}},{key:"currentPosition",value:function(t){return x(he({data:t,param:e.instance._keys.currentPosition}),"num")}},{key:"currentTimestamp",value:function(t){return x(he({data:t,param:e.instance._keys.currentTimestamp}),"num")}},{key:"tagName",value:function(t,a){return he({data:t,param:e.instance._keys.tagName,vidType:a||t._currVidType})}},{key:"localTimer",value:function(t,a){return he({data:t,param:e.instance._keys.localTimer,vidType:a||t._currVidType})||"nol_fdoffset"}},{key:"isInitialized",value:function(e,t){try{return t=t||e._currVidType,"{}"!==JSON.stringify(e._dataArrObj[t])}catch(e){return!1}}},{key:"updateMetadata",value:function(e,t,a,n){try{var r={nolParams:["nol_assetid","nol_assetName","nol_title","nol_vcTitle","nol_category","nol_channelName","nol_clientid","nol_vcid","nol_vidtype","nol_adLoadType"]};a=a||G()[e.get("nol_playerId")]||{};var i=function(e){var t=!0;for(var n in r.nolParams)if(a&&a.hasOwnProperty(r.nolParams[n])&&e===a[r.nolParams[n]].clientField){t=!1;break}return t};if(!e||!t)return;var o=void 0!==a&&"object"===f(a)&&a;for(var s in t)t.hasOwnProperty(s)&&(o&&i(s)?he({data:e,param:String(s),val:String(t[s])}):n&&n.inferred||this._glcfg._listeners.fireEvent("warn",{type:"warn",msg:"Attempt to update metadata field "+s+" is not allowed. Please remove "+s+" from your metadata parameter."}))}catch(e){this._glcfg._listeners.fireEvent("error",{type:"error",msg:"Failed to update metadata"})}}},{key:"extendfData",value:function(e){"function"!=typeof e.get&&(e.isProductOf=function(e){return!!e&&("object"===f(e)?e.indexOf(he({data:this,param:"nol_product"}))>-1:he({data:this,param:"nol_product"})===e)},e.get=function(e,t){return he({data:this,param:e,vidType:t})},e.set=function(e,t,a){return he({data:this,param:e,val:t,vidType:a})},e.del=function(e,t){e&&t&&this&&this._dataArrObj&&this._dataArrObj[t]&&delete this._dataArrObj[t][e]})}},{key:"getRequestMethod",value:function(e){return e&&e.hasOwnProperty("get")&&"function"==typeof e.get?e.get("nol_prefRequestMethod")||e.get("nol_requestMethod"):"GET"}},{key:"nuidOverride",value:function(e,t){return t&&(e=W(e,this._params.nuid,"nuid,OPTOUT")),e}},{key:"optoutOverride",value:function(t){return t&&(t=A(t,e.instance._params.optout+"=")+(this._glcfg.isOptout()?"&"+e.instance._params.optout+"=1":""),t=W(t,e.instance._params.nuid,"nuid,"+this._glcfg.getLsId())),t}},{key:"getEventsFilter",value:function(e){return e.get("nol_eventFilter")||this.l_eventFilter[e.get("nol_playerId")]||{}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}(),oe=0,se=v.maxRetries,le=function(e,t){try{var a,n,r=e.split("&");for(a=0,n=r.length;a<n;a++)if(0===r[a].indexOf(t))return!0;return!1}catch(e){return!1}},de=function e(t){var a=g();if("string"==typeof t&&0!==t.length){var n=a.document.createElement("script");n.type="text/javascript",n.src=function(e,t){var a,n,r=[],i=e.split("&");for(a=0,n=i.length;a<n;a++)0!==i[a].indexOf(t)&&r.push(i[a]);return r.join("&")}(t,"rnd=")+"&rnd="+Math.round(1e6*Math.random()),n.onerror=function(t){var n=t.target.src;a.document.head?a.document.head.removeChild(t.target):a.document.getElementsByTagName("head")[0].removeChild(t.target),oe<se&&(oe++,S.getInstance().processSetTimeout((function(){e(n)}),5e3))},n.onload=function(e){oe=0,a.document.head?a.document.head.removeChild(e.target):a.document.getElementsByTagName("head")[0].removeChild(e.target)},a.document.head?a.document.head.appendChild(n):a.document.getElementsByTagName("head")[0].appendChild(n)}},ce=!1;function ue(e){var t,a,n,r,i,o,s,l,d,c,u={600:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.0",LSID:!0},"600_rc":{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.0.rc",LSID:!0},601:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLCMB:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.1",LSID:!0},"601_rc":{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLCMB:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.1.rc",LSID:!0},501:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLCMB:600,PLLOG:600,CONFIG:300,BASEVER:"6.1.0",LSID:!1,FORCEFOCUS:!0,CADENCEOVERRIDE:30},615:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLLOG:600,CONFIG:300,BASEVER:"6.1.5",LSID:!1,FORCEFOCUS:!0,CADENCEOVERRIDE:30}};if(!ce){var p=e||{};if(ce=!0,c=p.NOLBUNDLE.GLCFG||{},r=0,i=30,o=0,s=v.webProtocol+"://"+v.cdnAddress+"/",d={PLDPR:{path:s+"novms/js/2/pldpr"+u[l="600"].PLDPR+".js",status:0,pluginName:"PLDPR"},PLDCR:{path:s+"novms/js/2/pldcr"+u[l].PLDCR+".js",status:0,pluginName:"PLDCR"},PLLOG:{path:s+"novms/js/2/pllog"+u[l].PLLOG+".js",status:0,pluginName:"PLLOG"}},c.gIframe=null,c.gIframeReady=!1,c.thirdPartyData={cookiesEnabled:!0,localStorageEnabled:!0},c.built=!1,c.postMsgAvail=c.postMsgAvail||"function"==typeof p.postMessage,c.availModules=c.availModules||{},c._players=c._players||{},c.id=c.id||"0",c.childGlobal=c.childGlobal||!!p&&p.top!==p.self,c.parentFound=c.parentFound||!1,c.isInFocus=c.isInFocus||!0,c.loadChildren=function(e){var t,a=m(void 0!==e?e:l);for(t in d)d.hasOwnProperty(t)&&a.hasOwnProperty(t)&&!c.availModules[t]&&h(t,d[t])},c.getBaseBuildVer=function(){var e=m(l);if(e.hasOwnProperty("BASEVER"))return e.BASEVER+"."},c.getConfigVer=function(){var e=m(l);if(e.hasOwnProperty("CONFIG"))return e.CONFIG},c.globalHasFocus=function(){return c.isInFocus},c.getSdkvGlobal=function(e,t){if(e&&t){var a=m(e);return!(!a||!a.hasOwnProperty(t))&&a[t]}},c.isValidJson=function(e){var t;try{t=JSON.parse(e)}catch(e){return!1}return"Object"==typeof t},c.getPrefProtocol=function(e){try{return c.userAgent&&c.userAgent.isIOS&&c.userAgent.isIOS()&&c.userAgent.iosVersion&&c.userAgent.iosVersion().major>=9||p&&p.location&&p.location.protocol&&0===p.location.protocol.indexOf("https")?"https":e.nol_GLOBALS.hasOwnProperty("nol_prefProtocol")&&-1!==["http","https"].indexOf(e.nol_GLOBALS.nol_prefProtocol)?e.nol_GLOBALS.nol_prefProtocol:e.nol_GLOBALS.nol_tagMap&&e.nol_GLOBALS.nol_tagMap.nol_defaults&&e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_prefProtocol&&-1!==["http","https"].indexOf(e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_prefProtocol)?e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_prefProtocol:"https"}catch(e){return"https"}},c.generateGUID=function(){function e(){var e;do{e=Math.floor(992*Math.random())}while(e>61);return e}for(var t="",a=0;a<29;a++)t+="0123456789abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz".charAt(e());return t+=Math.floor((new Date).getTime()/1e3)},c.evalTemplate=function(e,t,a){if(e&&t){var n={regex:/\|\![\w\W]*?(\!\|)/g,length:2},r=e.match(n.regex);if(r)for(var i=0;i<r.length;i++){var o=r[i].match(/\w+/gi)||"",s=t[o[0]],l=r[i].substr(n.length,r[i].length-2*n.length),d=l.match(/[\{<\(]/g)?l.match(/[\{<\(]/g).reverse():[],c=l.match(/[\}>\)]/g)||[],u=Math.min(d.length,c.length);if(u>0&&s)for(var p=0;p<u;p++)f=d[p],m=c[p],("<"===f&&">"===m||"{"===f&&"}"===m||"("===f&&")"===m)&&(s=_(d[p],l,s,a));o&&o.length>0&&"nol_imrid"!==o[0].toLowerCase()&&(e=e.replace(r[i],s||""))}}var f,m;return e},c.bindPlayers=function(e,t){var a;if(t)for(a in c.availModules[t]=e,c._players)c._players.hasOwnProperty(a)&&1==c._players[a].init&&(c._players[a].modules[t]||(c._players[a][t]=new e.init(c._players[a]),c._players[a].modules[t]=2))},c.enablePlayer=function(e,t){e&&t&&(c._players[e].modules[t]=2)},c.registerListener=function(e,t){t&&(t.addListener(e,(function(t){c._listeners.fireEvent(e,t)})),t.init||(t.init=1,function(e){if(e){var t;for(t in c.availModules)c.availModules.hasOwnProperty(t)&&1==e.init&&(e.modules[t]||(e[t]=new c.availModules[t].init(e),e.modules[t]=1));var n=e.getConfigParams().nol_playerId;c._players[n]=e,c._listeners.addListener("tick",(function(){!function(e){try{if(!e.modules.allModInit){var t=!0,n=m(e.sdkv);for(a in d)if(d.hasOwnProperty(a)&&n.hasOwnProperty(a)&&!c.availModules[a]){if("PLLOG"!==a&&2!==e.modules[a]){t=!1;break}}else;t&&(e.modules.allModInit=!0,c._listeners.fireEvent("flushQueue"))}}catch(e){}}(c._players[n])}))}}(t)))},c.updateReceiver=function(e){!function(e){e&&c._listeners.fireEvent(e.eventTrigger,e)}(e)},c._listeners=c._listeners||new function e(){if(!(this instanceof e))return new e;c._listeners={},this.addListener=function(e,t,a,n){var r=a||!1;void 0===c._listeners[e]&&(c._listeners[e]=[]),c._listeners[e].push({cb:t,remove:r,player:n,single:!1})},this.addListenerSingle=function(e,t,a,n){var r,i,o,s=a||!1;void 0===c._listeners[e]&&(c._listeners[e]=[]);var l=!1;for(i=0,o=(r=c._listeners[e]).length;i<o;i++)if(r[i].single){l=!0;break}l||c._listeners[e].push({cb:t,remove:s,player:n,single:!0})},this.fireEvent=function(e,t){if(e){var a,n,r;if("string"==typeof e&&(e={type:e}),e.target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(e.tag||(e.tag=v.TAG),c._listeners[e.type]instanceof Array){for(n=0,r=(a=c._listeners[e.type]).length;n<r;n++)a[n]&&a[n].cb.call(this,e);for(n=0;n<a.length;n++)a[n]&&a[n].remove&&(!e.target||!a[n].player||e.target&&a[n].player&&(e.target.nol_playerId===a[n].player.id||e.target.id===a[n].player.id))&&(a.splice(n,1),n--)}}},this.removeListener=function(e,t){var a,n,r;if(c._listeners[e]instanceof Array)for(n=0,r=(a=c._listeners[e]).length;n<r;n++)if(a[n]&&a[n].cb===t){a[n].remove=!0;break}}},c.configController={_keys:{cmsKey:"nol_clientCMSmap",cmsMapRegex:/[\[\{<\(\}\]>\)]/g},getGlobal:function(e,t){return e&&t&&t.nol_GLOBALS&&t.nol_GLOBALS[e]||""},cmsMap:function(e,t){var a=this.getGlobal(this._keys.cmsKey,t);return a&&a[e]?a[e].replace(this._keys.cmsMapRegex,"").toString():""}},c.scriptController={inject:function(e,t,a,n){if(e&&document&&"function"==typeof document.createElement){var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.async=!0,r.onload=a,r.onerror=n,r.src=e;var i=null;if("script"===(t=t||"")){if((i=document.getElementsByTagName("script"))&&i.length>0)return void(t=i[0].parentNode.insertBefore(r,i[0]))}else if("head"===t){if((i=document.getElementsByTagName("header"))&&i.length>0)return void(t=i[0].appendChild(r))}else if(t&&"string"==typeof t){if((t=document.getElementById(t))&&"function"==typeof t.insertBefore)return void t.parentNode.insertBefore(r,t)}else if(t&&"object"===f(t)&&t.appendChild&&"function"==typeof t.appendChild)return void t.appendChild(r);document.body.appendChild(r)}}},c.init=function(){if(!c.built){try{c.loadChildren(),void 0===t&&(t=p.setInterval((function(e){c._listeners.fireEvent("tick",e)}),1e3)),c.childGlobal&&(r=p.setInterval((function(){!function(){var e=g();e.document&&void 0!==e.document.referrer&&e.document.referrer.length>0&&c.postMsgAvail&&void 0!==e.parent&&void 0!==e.parent.postMessage&&e.parent.postMessage("nolInit",0===e.location.protocol.indexOf("http")?e.document.referrer:"*");i<o?e.clearInterval(r):o+=1}()}),500))}catch(e){}c.built=!0}},c.resetInitialized=function(){ce=!1},p.gg_nol_CallBack)for(a=0,n=p.gg_nol_CallBack.length;a<n;a+=1)p.gg_nol_CallBack[a]&&p.gg_nol_CallBack[a].callBack&&p.gg_nol_CallBack[a].callBack(c)}function m(e){return u[e]||u[l]||{}}function h(e,t){var a=be.getStaticInstance();a&&e&&t&&a.loadLib(e,t.pluginName,c,(function(){t.status=1}))}function _(e,t,a,n){var r,i;return"<"===e||">"===e?(r=t.match(/\.\d+,\d+\>/g))?(i=r[0].match(/[\d]+/g),a=String(a).substr(i[0],i[1])):a=function(e,t){var a,n,r,i,o="";if(!e||!t)return e;for(i=t.length,n=0,r=e.length;n<r;n++)o+=0==(a=e.charCodeAt(n)^t.charCodeAt(n%i))?e.charAt(n):String.fromCharCode(a);return o}(String(a),n):"("!==e&&")"!==e||(a=encodeURIComponent(a).replace("'","%27")),a}return c}function pe(){try{var e=g();return e&&(!e.NOLBUNDLE||e.NOLBUNDLE&&!e.NOLBUNDLE.GLCFG)&&(e.NOLBUNDLE||(e.NOLBUNDLE={}),e.NOLBUNDLE.GLCFG=ue(e),e.NOLBUNDLE.GLCFG.init()),e.NOLBUNDLE.GLCFG}catch(e){S.getInstance().logDebug("Error in getGlcfgInstance",e)}}var fe=function(){function e(){n(this,e),s(this,"cookieMap",{localcid:{index:0,key:"nol_fpid"},createdOn:{index:1,key:"nol_fpidCreateTime"},lastAccessed:{index:2,key:"nol_fpidAccessTime"},lastEMMPing:{index:3,key:"nol_fpidLastEMMPingTime"}}),this.key="nol_fpid",this.fpid="",this.fpidParams=[]}return i(e,[{key:"create",value:(l=a(c().mark((function e(t,a){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Date.now(),!(r=pe())||!r.generateGUID){e.next=11;break}return this.fpid=this.fpid+(r.generateGUID()+"|"),this.fpid=this.fpid+(n+"|"),this.fpid=this.fpid+(n+"|"),a.indexOf(t.toLowerCase())>-1&&(this.fpid=this.fpid+n),S.getInstance().logInfo("".concat(v.TAG,": Created first party ID - ").concat(this.fpid)),e.next=11,this.set(this.key,this.fpid);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),S.getInstance().logDebug("".concat(v.TAG,": Error creating first party ID - ").concat(e.t0.message));case 16:return e.abrupt("return");case 17:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(e,t){return l.apply(this,arguments)})},{key:"set",value:(o=a(c().mark((function e(t,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.getInstance()._storageSetItem(t,a);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),S.getInstance().logDebug("".concat(v.TAG,": Error setting first party ID - ").concat(e.t0.message));case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e,t){return o.apply(this,arguments)})},{key:"get",value:(r=a(c().mark((function e(t){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=S.getInstance(),e.prev=1,!this.fpid){e.next=5;break}return a.logInfo("".concat(v.TAG,": Retrieved first party ID from instance - ").concat(this.fpid)),e.abrupt("return",this.fpid);case 5:return e.next=7,S.getInstance()._storageGetItem(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0="";case 10:return this.fpid=e.t0,a.logInfo("".concat(v.TAG,": Retrieved first party ID from storage - ").concat(this.fpid)),e.abrupt("return",this.fpid);case 15:e.prev=15,e.t1=e.catch(1),a.logDebug("Error retrieving first party ID - ".concat(e.t1.message));case 18:return e.abrupt("return","");case 19:case"end":return e.stop()}}),e,this,[[1,15]])}))),function(e){return r.apply(this,arguments)})},{key:"update",value:(t=a(c().mark((function e(t,a){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=S.getInstance(),e.prev=1,this.fpidParams.length||(this.fpidParams=this.fpid&&this.fpid.split("|")),1!==this.fpidParams.length){e.next=5;break}return e.abrupt("return");case 5:return r=Date.now().toString(),this.cookieMap.lastAccessed&&(this.fpidParams[this.cookieMap.lastAccessed.index]=r,n.logInfo("".concat(v.TAG,": Updated nol_fpidAccessTime with timestamp - ").concat(r))),this.cookieMap.lastEMMPing&&(a.indexOf(t.toLowerCase())>-1?this.fpidParams[this.cookieMap.lastEMMPing.index]=r:this.fpidParams[this.cookieMap.lastEMMPing.index]="",n.logInfo("".concat(v.TAG,": Updated nol_fpidLastEMMPingTime with timestamp - ").concat(r))),this.fpid=this.fpidParams.join("|"),e.next=11,this.set(this.key,this.fpid);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.logDebug("".concat(v.TAG,": Error updating first party ID - ").concat(e.t0.message));case 16:return e.abrupt("return");case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e,a){return t.apply(this,arguments)})},{key:"appendData",value:function(e){this.fpidParams.length||(this.fpidParams=this.fpid&&this.fpid.split("|")),1!==this.fpidParams.length&&this.evalCookieMap(this.fpidParams,e)}},{key:"evalCookieMap",value:function(e,t){var a="";for(var n in this.cookieMap)a=e[this.cookieMap[n].index]?e[this.cookieMap[n].index]:"",t.set?t.set(this.cookieMap[n].key,a):t[this.cookieMap[n].key]=a}},{key:"fpidExpired",value:function(e){var t=this.fpid&&this.fpid.split("|");return Number(t[this.cookieMap.createdOn.index])+24*Number(e)*60*60*1e3<Date.now()&&(S.getInstance().logInfo("".concat(v.TAG,": First Party ID ").concat(t[0]," expired. Clearing out data.")),this.fpid="",this.fpidParams=[],!0)}}],[{key:"getStaticInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"clearInstance",value:function(){e.instance=null}}]);var t,r,o,l}();function me(e){try{var t=function(e){return{tags:[],eventQueue:e&&e.eventQueue?e.eventQueue:[],tagSize:1,bReInit:!1,debug:u.debugDisabledVal,eventQueueIndex:0}},n=e.glcfg,r=e.global,i=ie.getInstance(),o=S.getInstance(),s=v.sdkBuildVersion,l=v.domlessSuffix,d=e.ggcmb,u=n.availModules.PLDPR=void 0!==n.availModules.PLDPR?n.availModules.PLDPR:{sdkVersion:d.sdkvForConfig,BUILDVERSION:n.getBaseBuildVer()+s,baseConfigUrl:"cgi-bin/",addrProtocol:v.webProtocol,dprConfigAPI:v.dprConfigAPI,dprErrorAPI:v.dprErrorAPI,configVersion:n.getConfigVer?n.getConfigVer():300,defaultTimelineSize:v.defaultTimelineSize,functionMap:{"[":{end:"]",count:0},"{":{end:"}",count:0},"<":{end:/\.\d+,\d+\>/g,count:0}},configRegex:{regex:/\|\![\w\W]*?(\!\|)/g,length:2},cmsMapRegex:/[\[\{<\(\}\]>\)]/g,bucketRegex:new RegExp(/(.*?)(_content|_ad|_static)?$/i),dataObj:{},timeOffset:0,currentRetry:0,maxRetry:5,errorWait:5,sendQueue:[],sendInterval:void 0,lsRetryMax:2,sending:!1,sendQueue2:[],debugDisabledVal:"false",configAddr:void 0,cmsMapDictionary:e.cmsMapDictionary||{},l_eventFilter:{},l_serviceFilter:{},WEBSTORAGE:!1,USEBEACON:!1,_id3Map:void 0,sender:{send:function(t,a,r){var o=t,s=-1!==o.url.indexOf("&c62=")?e.removeParam(o.url,"c62=")+"&c62=sendTime,"+(void 0!==a?a:h()/1e3|0):o.url,l="";l=-1!==s.indexOf("prd=metadata")?s:e.removeParam(s,"rnd=")+"&rnd="+Math.round(1e6*Math.random()),r=r||"GET",t&&t.uoo&&(l=i.nuidOverride(l,t.uoo)),n.postMsgAvail&&o.hasOwnProperty("maskRefUrl")&&-1!==o.maskRefUrl&&"true"===o.maskRefUrl?e.sendMaskedPing(l):u.USEBEACON?navigator.sendBeacon(l):e.request(l)},setup:function(e){var t=e.hasOwnProperty("url")?e.url:"",a=e.params||{url:t,uoo:"true"===e.uoo?1:0,errorDelay:1e3*(e.delay||n.availModules.PLDPR.errorWait),retry:0,maskRefUrl:e.hasOwnProperty("maskRefUrl")&&String(e.maskRefUrl).length>0?e.maskRefUrl:-1};t&&t.length>0&&this.send(a,e.pingSendTime,e.method)},onError:function(e,t,a){var n=this,r=e.target.src;t&&t.retry<this.maxRetry&&r&&r.length>0&&(t.retry=t.retry+1,t.url=r,S.getInstance().processSetTimeout((function(){n.send(t,null,a)}),t.errorDelay))}},_errorSent:{},ns:e.ns};n.availModules.PLDPR.debug=n.availModules.PLDPR.debugDisabledVal,n.availModules.PLDPR.product=n.availModules.PLDPR.product||{};var p=e.namespace;return u.initFromConfig=function(){var e=a(c().mark((function e(a,i,s){var d,f,m,v,g,_,y,P,b,S,O,L,k,T,C,E,w,I,D,M,R,A;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n._listeners.fireEvent("info",{type:"info",msg:"Recieved config response."}),e.prev=1,d=i||0,!a||!a.nol_GLOBALS){e.next=98;break}if(v=h(),_="localhost",y=a.nol_GLOBALS.debugSfcode||"uat-cert",P=a.nol_GLOBALS.nol_appid||"",b=a.nol_GLOBALS.enableCookielessDomain&&"true"===a.nol_GLOBALS.enableCookielessDomain.toString().toLowerCase(),S=a.nol_GLOBALS.nol_lsid||"",O=a.nol_GLOBALS.nol_emmURL||(a.nol_GLOBALS.nol_tagMap&&a.nol_GLOBALS.nol_tagMap.nol_defaults?a.nol_GLOBALS.nol_tagMap.nol_defaults.nol_emmURL:"")||"",(L=a.nol_GLOBALS.enableStaticInIframe&&"true"===a.nol_GLOBALS.enableStaticInIframe.toString().toLowerCase())&&n.browser.isWithinIFrame()&&n.availModules.PLDCR.removeListeners(),n&&n.availModules.PLDCR&&(n.availModules.PLDCR.nol_idleTimeout=parseInt(a.nol_GLOBALS.nol_idleTimeout)||1800),s&&n.optoutCookie&&"TOTAL"===n.optoutCookie&&"OPTOUT"!==n.localStorageId&&(S="OPTOUT",n._listeners.fireEvent("debug",{type:"debug",msg:'Optout cookie was set but lsid was "'+n.localStorageId+'". Setting lsid to OPTOUT'})),!o||!o.implementationHooks.Storage||b){e.next=24;break}return e.next=18,o._storageGetItem("nol_lsid");case 18:if(e.t0=e.sent,e.t0){e.next=21;break}e.t0="";case 21:S=e.t0,e.next=25;break;case 24:S="999";case 25:if(""!==S){e.next=29;break}return S=n.generateGUID(),e.next=29,o._storageSetItem("nol_lsid",S);case 29:if(n._listeners.fireEvent("sendOptOutStatus","OPTOUT"==S),void 0!==a.nol_GLOBALS.nol_maxRetry&&null!==a.nol_GLOBALS.nol_maxRetry&&""!==a.nol_GLOBALS.nol_maxRetry&&(I=parseInt(a.nol_GLOBALS.nol_maxRetry))>-1&&(n.availModules.PLDPR.maxRetry=I),!a||!a.hasOwnProperty("nol_GLOBALS")){e.next=87;break}if(d=i||a.nol_GLOBALS.nol_playerId||0,m=n._players[d]){e.next=36;break}return e.abrupt("return");case 36:for(g in _=a.nol_GLOBALS.nol_sfcode||_,n._listeners.fireEvent("debug",{type:"debug",msg:'SDK instance "'+m.name+'" initialized with globals '+JSON.stringify(m.getConfigParams().ggParams)}),m&&m.hasOwnProperty("pauseObj")&&(m.pauseObj.maxPauseTime=parseInt(a.nol_GLOBALS.nol_pauseTimeout)||1800,m.pauseObj.cmsPauseTime=parseInt(a.nol_GLOBALS.nol_pauseEventTimeoutPlayhead)||15),m.staticIFrameFlag=L,a.nol_GLOBALS.nol_serverTime=h()/1e3|0,(o&&o.storageGetItem?n.availModules.PLDPR.dataObj[d]?n.availModules.PLDPR.dataObj[d].nol_serverTime||o.storageGetItem("nol_serverTime"):o.storageGetItem("nol_serverTime")||0:n.availModules.PLDPR.dataObj[d]?n.availModules.PLDPR.dataObj[d].nol_serverTime:0)===a.nol_GLOBALS.nol_serverTime?n.availModules.PLDPR.timeOffset=n.availModules.PLDPR.dataObj[d]?n.availModules.PLDPR.dataObj[d].nolPriv_serverTimeOffset:a.nol_GLOBALS.nol_serverTime-Math.round(v/1e3):(n.availModules.PLDPR.timeOffset=a.nol_GLOBALS.nol_serverTime-Math.round(v/1e3),o&&o.storageSetItem&&o.storageSetItem("nol_serverTime",a.nol_GLOBALS.nol_serverTime)),n.availModules.PLDPR.errorWait=a.nol_GLOBALS.nol_errorWait||n.availModules.PLDPR.errorWait,f=m.getConfigParams().ggParams||{},n.availModules.PLDPR.dataObj[d]=t(n.availModules.PLDPR.dataObj[d]),n.availModules.PLDPR.dataObj[d].nolPriv_serverTimeOffset=n.availModules.PLDPR.timeOffset,n.availModules.PLDPR.dataObj&&n.availModules.PLDPR.dataObj.hasOwnProperty(d)?n.availModules.PLDPR.dataObj[d].nol_nielsenAdSupportFlg=0:n._listeners.fireEvent("error",{type:"error",msg:"Error in initFromConfig. Invalid data object or playerId."}),n.availModules.PLDPR.dataObj[d].debug=-1!==y.indexOf(_)&&r&&r.JSON&&0===P.indexOf("T")&&m.getConfigParams().ggParams.nol_sdkDebug||u.debugDisabledVal,n.availModules.PLDPR.sendInterval&&(r.clearInterval(n.availModules.PLDPR.sendInterval),n.availModules.PLDPR.sendInterval=0),a.nol_GLOBALS.nol_sendTimer,f)f.hasOwnProperty(g)&&(n.availModules.PLDPR.dataObj[d][g]=f[g]);for(g in a.nol_GLOBALS)a.nol_GLOBALS.hasOwnProperty(g)&&(n.availModules.PLDPR.dataObj[d][g]=a.nol_GLOBALS[g]);for(g in n.availModules.PLDPR.l_eventFilter[d]=n.availModules.PLDPR.dataObj[d].nol_eventFilter||{},n.availModules.PLDPR.l_serviceFilter[d]=n.availModules.PLDPR.dataObj[d].nol_serviceFilter||{},n.availModules.PLDPR._id3Map=n.availModules.PLDPR.dataObj[d].nol_id3Map||{},n.availModules.PLDPR.cmsMapDictionary[d]=n.availModules.PLDPR.cmsMapDictionary[d]||{},n.availModules.PLDPR.dataObj[d].nol_clientCMSmap)n.availModules.PLDPR.dataObj[d].nol_clientCMSmap.hasOwnProperty(g)&&(T=n.availModules.PLDPR.dataObj[d].nol_clientCMSmap[g].toString()||"",C=T.replace(n.availModules.PLDPR.cmsMapRegex,""),w=T.match(n.availModules.PLDPR.cmsMapRegex)||[],E={clientField:C.toString(),encoding:w.join("")},n.availModules.PLDPR.cmsMapDictionary[d][g]=E);if(f&&f.hasOwnProperty("nol_override")&&Object.keys(f.nol_override).length>0)for(g in f.nol_override)f.nol_override[g].length>0&&(n.availModules.PLDPR.dataObj[d][g]=f.nol_override[g]);a.nol_GLOBALS.hasOwnProperty("nol_maxStaticInstances")&&p.hasOwnProperty("setTotalNumAssetsAllowed")&&p.setTotalNumAssetsAllowed(a.nol_GLOBALS.nol_maxStaticInstances),m.configLoaded=!0,n.availModules.PLDPR.dataObj[d].nol_prefProtocol=n.getPrefProtocol(a),n.availModules.PLDPR.dataObj[d].nol_playerId=d,n.availModules.PLDPR.dataObj[d].nol_nuid=S,n.availModules.PLDPR.dataObj[d].nol_lsid=S,n.availModules.PLDPR.dataObj[d].nol_bldv=n.availModules.PLDPR.BUILDVERSION,n.availModules.PLDPR.dataObj[d].nol_sdkv=m.sdkvForConfig+l,n.availModules.PLDPR.dataObj[d].nol_assetName=a.nol_GLOBALS.hasOwnProperty("nol_assetName")&&a.nol_GLOBALS.nol_assetName.length>0?a.nol_GLOBALS.nol_assetName:"defChnAsset",n.availModules.PLDPR.dataObj[d].nol_sfcode=f.sfcode,n.availModules.PLDPR.dataObj[d].nol_dcrsfcode=f.sfcode,n.availModules.PLDPR.dataObj[d].nol_apn=f.apn||(a.nol_GLOBALS.hasOwnProperty("nol_apn")&&a.nol_GLOBALS.nol_apn.length>0?a.nol_GLOBALS.nol_apn:""),n.availModules.PLDPR.dataObj[d].nol_nmspc="NOLBUNDLE",n.availModules.PLDPR.dataObj[d].nol_lstrg="",n.availModules.PLDPR.dataObj[d].nol_userSessionId=m.sessionId,n.availModules.PLDPR.dataObj[d].nol_pageURLmeta=m.metadataCtrl.pageURL,n.availModules.PLDPR.dataObj[d].nol_pageTitle=m.metadataCtrl.pageTitle,!0===m.optout||"true"===n.availModules.PLDPR.dataObj[d].nol_useroptout?(n.availModules.PLDPR.dataObj[d].nol_useroptout="true",void 0!==n.availModules.PLDPR.dataObj[d].nol_deviceId&&""===n.availModules.PLDPR.dataObj[d].nol_deviceId||(n.availModules.PLDPR.dataObj[d].nol_deviceId="")):n.availModules.PLDPR.dataObj[d].nol_useroptout="",n.availModules.PLDPR.dataObj[d].nol_deviceId=!0===m.optout||"true"===n.availModules.PLDPR.dataObj[d].nol_useroptout?"":void 0!==m.deviceId?m.deviceId:n.availModules.PLDPR.dataObj[d].nol_deviceId,n._listeners.fireEvent("debug",{type:"debug",msg:"Cached emm: "+n.EMMURL+"; config emm: "+O}),O=n.evalTemplate(O,n.availModules.PLDPR.dataObj[d]),n.availModules.PLDPR.dataObj[d].nol_emmURL=O,D=(D=a.nol_GLOBALS.hasOwnProperty("nol_emmsfcodelist")?a.nol_GLOBALS.nol_emmsfcodelist:[])&&Array.isArray(D)?D.concat(["secure-eu","eu","eu-uat","eu-cert"]):["secure-eu","eu","eu-uat","eu-cert"],M=D.indexOf(n.sfCode.toLowerCase())>-1,O&&M&&(Q(O),n._listeners.fireEvent("info",{type:"info",msg:"Firing EMM link ".concat(O)}));case 87:if(a&&a.hasOwnProperty("nol_TAGS"))for(n.availModules.PLDPR.dataObj[d].tagSize=a.nol_TAGS.length,n.availModules.PLDPR.dataObj[d].tags=[],n._listeners.fireEvent("debug",{type:"debug",msg:"NIELSEN TAGS EXPECTED TO FIRE:"}),g=0;g<n.availModules.PLDPR.dataObj[d].tagSize;g+=1)n._listeners.fireEvent("debug",{type:"debug",msg:String(a.nol_TAGS[g].nol_comment)}),R=new bt(JSON.parse(JSON.stringify(a.nol_TAGS[g])),n.availModules.PLDPR.dataObj,m),n.availModules.PLDPR.dataObj[d].tags.push(R);void 0!==n.enablePlayer&&n.enablePlayer(d,"PLDPR"),n.availModules.PLDPR.dataObj[d].bReInit=!1,f.nol_hybridCfg&&r&&r.JSON&&((k=r.document.createElement("script")).text="(function() {if (typeof "+f.nol_hybridCfg+" === 'function'){"+f.nol_hybridCfg+"('"+JSON.stringify(a)+"')}}())",r.document.head?(r.document.head.appendChild(k),r.document.head.removeChild(k)):(r.document.getElementsByTagName("head")[0].appendChild(k),r.document.getElementsByTagName("head")[0].removeChild(k))),n.availModules.PLDPR.dataObj[d].forceStreamRegen=!1,A=n.getSdkvGlobal(n.availModules.PLDPR.dataObj[d].nsdkvOverride,"CADENCEOVERRIDE"),n.availModules.PLDPR.dataObj[d].hasOwnProperty("nsdkvOverride")&&A&&(n.availModules.PLDPR.dataObj[d].nol_cadenceOverride||(n.availModules.PLDPR.dataObj[d].nol_cadenceOverride=A),n.availModules.PLDPR.dataObj[d].nol_cadenceOverrideEnabled=!0),n._listeners.addListener("tick",(function(){if(m&&m.hasOwnProperty("pauseObj")&&m.pauseObj.hasOwnProperty("pauseTime")){if(m.inBackground)return;!0===m._pauseTimeoutEnabled?m.pauseObj.pauseTime+=1:m.pauseObj.pauseTime=0,m.pauseObj.eventPauseTime+=1}})),n._listeners.fireEvent("flushQueue"),e.next=100;break;case 98:o&&o.logWarn&&o.logWarn("Warning: CMS config response is not valid. Please ensure NOL global parameter values are correct."),n._listeners.fireEvent("warn",{type:"warn",msg:"Warning in initFromConfig. NOL global parameters are not valid."});case 100:return e.abrupt("return",n.availModules.PLDPR.dataObj[d]);case 103:e.prev=103,e.t1=e.catch(1),o&&o.logError&&o.logError("Error initializing CMS config response. Please ensure NOL global parameter values are correct. "+e.t1.message),n._listeners.fireEvent("error",{type:"error",msg:"Error in initFromConfig. Error parsing config response. "+e.t1.message});case 107:case"end":return e.stop()}}),e,null,[[1,103]])})));return function(t,a,n){return e.apply(this,arguments)}}(),u.getCmsMap=function(e){try{if(void 0!==e&&"string"==typeof e||n._listeners.fireEvent("error",{type:"error",msg:"Error in getCmsMap. PlayerID must be passed as string data type."}),n.availModules.PLDPR.dataObj&&n.availModules.PLDPR.dataObj.hasOwnProperty(e)&&void 0!==n.availModules.PLDPR.dataObj[e].nol_clientCMSmap)return n.availModules.PLDPR.dataObj[e].nol_clientCMSmap}catch(e){n._listeners.fireEvent("error",{type:"error",msg:"Error in getCmsMap."})}},u.resolveExpression=function(e,t){return t?(t._dataArrObj||(t={_dataArrObj:{content:{0:t}},_settings:t,_currVidType:"content"}),i.extendfData(t),Dt(t,e,null,{vidType:"content",silent:!0,noClone:!0})):e},u.init=function(e){var a,r,i=e.getConfigParams()||{},o="",s=i.nol_playerId||0;for(a in n.availModules.PLDPR.product=Qt({dataFunc:he}),r={pli:{val:s,protect:!0},nmspc:{val:"NOLBUNDLE",protect:!0},sdkv:{val:n.availModules.PLDPR.sdkVersion,protect:!0},fmt:{val:"jsonp",protect:!0},apn:{val:"Tester",protect:!1},fbtag:{val:"true",protect:!1},cfgv:{val:n.availModules.PLDPR.configVersion,protect:!0},bldv:{val:n.availModules.PLDPR.BUILDVERSION,protect:!0},prefprotocol:{val:"https",protect:!1}},e.addListener("ggPM",(function(e){!function(e){var a;if(n.availModules.PLDPR.dataObj[e.id]&&n.availModules.PLDPR.dataObj[e.id].tags.length===n.availModules.PLDPR.dataObj[e.id].tagSize){if(n._listeners.fireEvent("debug",{type:"debug",msg:"pli="+e.id+"&ggpm="+JSON.stringify(e),evtType:e.evtInfo.eventType}),n.availModules.PLDPR.dataObj[e.id].debug!==u.debugDisabledVal&&"logging"===n.availModules.PLDPR.dataObj[e.id].debug){if((a=n.availModules.PLDPR.dataObj[e.id].nol_debugUrl)||(a=n.availModules.PLDPR.dataObj[e.id].nol_prefProtocol+"://nielsen.guru/validation/query_string.php?"),n.availModules.PLDPR.dataObj[e.id].eventQueue.length>n.availModules.PLDPR.dataObj[e.id].eventQueueIndex+1)for(var r=n.availModules.PLDPR.dataObj[e.id].eventQueueIndex;r<n.availModules.PLDPR.dataObj[e.id].eventQueue.length;r++)ge(a+"pli="+e.id+"&ggpm="+JSON.stringify(n.availModules.PLDPR.dataObj[e.id].eventQueue[r])),n.availModules.PLDPR.dataObj[e.id].eventQueueIndex=r;ge(a=a+"pli="+e.id+"&ggpm="+JSON.stringify(e))}e.timeStamp=h();for(var i=0,o=n.availModules.PLDPR.dataObj[e.id].tags.length;i<o;i+=1)n.availModules.PLDPR.dataObj.hasOwnProperty(e.id)&&n.availModules.PLDPR.dataObj[e.id].tags[i].eventListener(e)}else n.availModules.PLDPR.dataObj[e.id]&&n.availModules.PLDPR.dataObj[e.id].eventQueue||(n.availModules.PLDPR.dataObj[e.id]=t(n.availModules.PLDPR.dataObj[e.id])),n.availModules.PLDPR.dataObj[e.id].eventQueue.push(e);u.product.dtvr&&u.product.dtvr.postQueueGgpm&&u.product.dtvr.postQueueGgpm()}(e)})),e.lsPopulatedInterval=0,e.lsCurrentRetry=0,e.serviceSending={tsv:!1,stn:!1},e.ottStatusObj={},e.oServiceCall={},e.static={started:!1},i.ggParams)!i.ggParams.hasOwnProperty(a)||r[a]&&r[a].protect||0==a.indexOf("nol_")||(r[a]={val:_e(i.ggParams[a])});for(a in r)r.hasOwnProperty(a)&&(o=o+(a+"=")+r[a].val+"&");o=o.substr(0,o.length-1)},u.built||(u.built=!0,n.bindPlayers(u,"PLDPR"),n._listeners.fireEvent("flushQueue")),u}catch(e){S.getInstance().logError("Error in PLDPR module. ".concat(e.message))}}function ve(e,t){var a,n,r=0===e.availModules.PLDPR.addrProtocol.indexOf("https")?"https":"http",i=t.url,o=t.hasOwnProperty("maskRef")?t.maskRef:-1,s=t.method||"GET";if("__sendIt"!==i&&"https"===r&&-1===i.indexOf("https")&&(i=r+i.substr(i.indexOf("://"))),t.prod&&"ocr"===t.prod&&-1!==i.indexOf("&ty=js"))de(i);else if(e.availModules.PLDPR.sendInterval||"__sendIt"===i)if(i&&e.availModules.PLDPR.sendInterval&&this.sending)this.sendQueue2.push(i);else if("__sendIt"!==i||this.sending)i&&e.availModules.PLDPR.sendInterval&&!this.sending&&this.sendQueue.push(i);else{for(this.sending=!0,a=0,n=this.sendQueue.length;a<n;a+=1)e.availModules.PLDPR.sender.setup({pingSendTime:Gt(t.serverTimeOffset),url:this.sendQueue.shift(),uoo:t.uoo,maskRefUrl:o,method:s});this.sendQueue=this.sendQueue.concat(this.sendQueue2),this.sending=!1,this.sendQueue2=[]}else e.availModules.PLDPR.sender.setup({pingSendTime:Gt(t.serverTimeOffset),url:i,uoo:t.uoo,maskRefUrl:o,method:s})}function ge(e){pe().availModules.PLDPR.sender.setup({pingSendTime:"undefined",url:e,method:"GET"}),this.logger(e)}function he(e){var t,a=[];try{var n=pe();if(e){if("string"==typeof e.param){if(e.param=e.param.trim(),a=e.param.split("_"),-1===(t=e.param.indexOf("nol_"))&&-1===e.param.indexOf("nolPriv_")&&!a.length)return}else a=e.param;var r="";if(Array.isArray(a)&&a.length>2&&t>-1&&("content"===a[a.length-1]||"ad"===a[a.length-1]||"static"===a[a.length-1])){r=a.splice(0,a.length-1).join("_");var i=a[0];"ad"!==i&&"content"!==i||(e.vidType=i)}else r=e.param;var o=e.vidType||e.data._currVidType,s=e.data._currAssetid?String(e.data._currAssetid):"0",l=void 0!==e.data._dataArrObj[o][s]?e.data._dataArrObj[o][s]:e.data._dataArrObj[o][Object.keys(e.data._dataArrObj[o]).splice(-1,1)],d=n.availModules.PLDPR.cmsMapDictionary[e.data._settings.nol_playerId]||{},c=d&&d[r]?d[r].clientField:r,u="";if("object"===f(c))u=l;else if("nol_segmentTimeSpent"===c||"nol_cumeTimeSpent"===c||"nol_count"===c){u=he({data:e.data,param:"nol_timeSpentViewing"})[o][c]}else void 0===e.val||null===e.val?void 0!==(u=l&&l.hasOwnProperty(c)?l[c]:n.availModules.PLDPR.dataObj[e.data._settings.nol_playerId][c])&&""!==u||void 0!==(u=ye(e)||"")&&""!==u||(0===c.indexOf("nol_")?e.param=c:e.param=r,u=ye(e)||""):l&&(l[c]=e.val);return u}return null}catch(e){S.getInstance().logError("Error in Data(): "+e.message+" params: "+a),pe()._listeners.fireEvent("error",{type:"error",msg:"Error in Data(): "+e.message})}}function _e(e){return encodeURIComponent(e).replace("'","%27")}function ye(e,t){var a,n=pe(),r=e.data._settings,i=e.param;return null==t?void 0===(a=r.hasOwnProperty(i)&&n.availModules.PLDPR.dataObj[r.nol_playerId].nol_tagMap.hasOwnProperty(i)&&("object"===f(n.availModules.PLDPR.dataObj[r.nol_playerId].nol_tagMap[i])||"array"==typeof n.availModules.PLDPR.dataObj[r.nol_playerId].nol_tagMap[i])?n.availModules.PLDPR.dataObj[r.nol_playerId].nol_tagMap[i][r[i]]:r.hasOwnProperty("nol_defaults")&&r.nol_defaults.hasOwnProperty(i)?r.nol_defaults[i]:n.availModules.PLDPR.dataObj[r.nol_playerId].nol_tagMap.nol_defaults[i]||n.availModules.PLDPR.dataObj[r.nol_playerId][i])&&(a=r.hasOwnProperty(i)?r[i]:n.availModules.PLDPR.dataObj[r.nol_playerId].nol_tagMap[i]):r.hasOwnProperty("nol_defaults")&&r.nol_defaults.hasOwnProperty(i)?r.nol_defaults[i]=t:r[i]=t,a}function Pe(e){var t=S.getInstance();function a(e){t.logInfo(e)}function n(e){t.logWarn(e)}function r(e){t.logError(e)}var i=e.glcfg,o=i.availModules.PLLOG=i.availModules.PLLOG||{},s=i.getBaseBuildVer?i.getBaseBuildVer()+"0":"6.0.00",l={INFO:{info:a},DEBUG:{info:a,debug:function(e){t.logDebug(e)},warn:n,error:r},WARN:{info:a,warn:n},ERROR:{info:a,error:r},CONSOLE:{info:a},TRUE:{info:a},LOGGER:{logger:function(e){t.logDebug(e)}}};return o.init=function(e){if(e&&e.getConfigParams){var t=e.getConfigParams();t.hasOwnProperty("ggParams")&&t.ggParams.hasOwnProperty("nol_sdkDebug")&&function(e){if(e){var t=String(e).toUpperCase();if(l.hasOwnProperty(t))for(var a in l[t]){var n=String(a).toLowerCase();i._listeners.addListenerSingle(n,l[t][n])}}}(t.ggParams.nol_sdkDebug)}},o.built||(o.built=!0,o.BUILDVERSION=s,i.bindPlayers(o,"PLLOG")),o}var be=function(){function e(t){n(this,e),this.funcsProcessor=S.getInstance()}return i(e,[{key:"getPluginClassReference",value:function(e){switch(e){case"PLDPR":return me;case"PLDCR":return re;case"PLLOG":return Pe;default:return null}}},{key:"loadLib",value:function(e,t,a,n){try{var r=F(),i=r.libs=r.libs||{},o=this.getPluginClassReference(t);if(null!=e&&"string"==typeof e&&null!=o&&"function"==typeof o){if(i[e])return;i[e]=o({global:a,glcfg:pe(),namespace:r,ggcmb:"PLDPR"===e?ae.getStaticInstance():function(){},request:"PLDPR"===e?Q:function(){},sendMaskedPing:"PLDPR"===e?q:function(){},cmsMapDictionary:"PLDPR"===e?G():function(){},removeParam:"PLDPR"===e?A:function(){}}),i[e]={callbacks:[]},i[e].callbacks.push({func:n,arg:a})}else null==o&&this.initLib(e,a)}catch(e){this.funcsProcessor.logError("ERROR in Load lib: ",e)}}},{key:"registerLib",value:function(e,t){var a=pe();try{var n=F(),r=n.libs=n.libs||{};if(r){r.hasOwnProperty(e)||this.initLib(e,a,t);var i=r[e];i.body=t;for(var o=i.callbacks.shift();o;)o.func(i.body(o.arg)),o=i.callbacks.shift()}}catch(e){}}},{key:"initLib",value:function(e,t,a){var n=F(),r=n.libs=n.libs||{};if(r[e]||(r[e]={handle:null,callbacks:[]}),r[e].body=a,r[e].body){var i=r[e].body(t);return t[e]=i,void(r[e].handle=i)}}},{key:"getLib",value:function(e){if(void 0!==e&&"GLCFG"===e)return pe();var t=F(),a=t.libs=t.libs||{};return a[e]?a[e].handle:null}}],[{key:"getStaticInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"clearInstance",value:function(){e.instance=null}}])}();function Se(e){var t=e.glcfg,a=S.getInstance(),n={built:!1},r=e.global,i=t.getBaseBuildVer?t.getBaseBuildVer()+"3":"6.0.03";function o(e){var t,a,o,s,l,c,u,f=pe(),v=e,g=i,h=0,_=!1,y=5,P="",b=1300,S=0,O="",L="",k="",T="",C="",E="",w=0,I=!1,D=0,M=0,R="",A="",F={},x=0,G="",j=-1,N=0,V=0,B=0,H=[0,0],U=0,q=0,Q={CS:new Array(0,0),PA:new Array(0,0),PL:new Array(0,0),SA:new Array(0,0),FA:new Array(0,0),SI:new Array(0,0),SR:new Array(0,0),SK:new Array(0,0),CI:new Array(0,0),DI:new Array(0,0),ER:new Array(0,0),SV:new Array(0,0),SH:new Array(0,0),PB:new Array(0,0),II:new Array(0,0),VL:new Array(0,0),PM:new Array(0,0),FP:new Array(0,0),MI:new Array(0,0),Title:new Array("",""),SS:new Array(0,0)},X=!1,z=[],W=r.location.protocol||"http:",J=this,K=[];function Y(e,t){var a=Number(e),n=Number(t),r=1;return a<n?r=-1:a==n&&(r=0),r}function $(){var e;z=P.split(",");var t=[];for(e=0;e<z.length;e++)isNaN(z[e])&&(t=z[e].split("%"),isNaN(t[0])?z[e]=0:z[e]=Number(t[0])*Q.VL[D]/100);for(z.sort(Y),e=z.length;--e>0;)for(;z[e]==z[e-1];)z.splice(e-1,1);0==z[0]&&z.splice(0,1)}function Z(e){return e>86400&&(e=(e-v.gmtOffset)%86400),e}function ee(e,t){var a,n,r=-1;return void 0!==(a=1==t?A:R)&&((n=a.indexOf("<"+e+">"))>=0&&(n+=e.length+2,r=a.indexOf("</"+e+">",n)),n>=0&&r>n)?a.substring(n,r):null}function te(e){var t,a,r;return void 0!==Q&&0!==Object.keys(Q).length||(Q={Title:["",""],VL:[0,0]}),1==n._ggmsgfmt?t="":(t="",F.prod.indexOf("iag")>=0&&(t=M?L:O,2==e?t+="&pr=iag.cp,cep":1==e?t="":t+="&pr=iag.cp,soc"),F.prod.indexOf("vc")>=0?1==e?t="&ig=1":(null!=(a=ee("censuscategory",M))&&""!=a&&(t=t+"&cg="+encodeURIComponent(a)),M&&(t+="&c3=st,a"),1!=e&&(t+=M?T:k),t=t+"&tl="+encodeURIComponent("dav"+e+"-"+Q.Title[M].substr(0,128))):F.prod.indexOf("sc")>=0&&(null!=(a=ee("censuscategory",M))&&""!=a&&(t=t+"&cg="+encodeURIComponent(a)),M&&(t+="&c3=st,a"),t=t+"&ou="+G+"_"+encodeURIComponent(E.substr(0,128)),0==e?Q.VL[M]>0&&(t=t+"&sd="+Math.round(Q.VL[M])):t=t+"&du="+Math.round(Q.PM[M]),1!=e&&(t=(t+=M?T:k)+"&tl="+encodeURIComponent("dav"+e+"-"+Q.Title[M].substr(0,128)))),0==e&&(t=t+"&rnd="+Math.floor(1e5*Math.random()),null!=(r=ee("totalchap",M))&&""!=r&&(t=t+"&tc="+r)),t=(t=t+"&ch="+(ee("chapter",M)||1))+"&sq="+(ee("sequence",M)||1),t+="&tp=gg"),t}function ae(e,t,a){var n=ee("iag_"+e,a);return null!=n&&""!=n?"&pr=iag."+e+","+encodeURIComponent(n):null==t?"":t}function ne(e){var t=te(e);o.report("NA",e,t),h=0}function re(){if(X){var e=te(1);o.reportend(e)}else;}function ie(e){var t,a="",n=D;return t=Q.FP[n]>0&&1==_?Math.round(100*Q.FA[n]/Q.FP[n]):100,a=(a=null!=e&&""!=e?e:Q.PL[n])+","+t,Number(Q.PM[n])<e&&(Q.PM[n]=e),a}this.getmetval=function(){return Q},this.getgp=function(){return F},this.getpageurl=function(){return E},this.getaorc=function(){return M},this.getlfunctionType=function(){return S},this.detectsBrowserClose=function(){return false},this.getGGinstance=function(){return v},this.updateFocusNumbers=function(){_=f.globalHasFocus(),1==x&&(1==_&&(Q.FA[D]+=1),Q.FP[D]+=1)},this.genSummation=function(e,t){var a,n="",r=0,i=1,o=0,s=-1,l=-1;return e=D,0!=Q.CS[e]&&Q.PA[e]>0&&Q.VL[e]>0&&(r=Q.PA[e]>=Q.VL[e]?99:Q.VL[e]>0?Math.round(100*Q.PA[e]/Q.VL[e]):66,Q.FP[e]>0&&1==_&&(i=Q.FA[e]/Q.FP[e],r=Math.round(.8*r+r*i*.2)),Q.MI[e]>0&&Q.SI[e]<=0?r-=10:Q.SI[e]>0&&(r+=5),Q.SR[e]>0&&(r+=10),(Q.SH[e]>0||Q.SV[e]>0||Q.PB[e]>0||Q.CI[e]>0)&&(r=99),Q.II[e]>0&&(r+=10),Q.ER[e]>0&&Q.ER[e]<=5&&(r=20*Q.ER[e]),r>99&&(r=99),n=t+",50,"+r+","+Math.round(100*i)+"|||",this.getGGinstance().player.PLVBL&&this.getGGinstance().player.PLVBL.getData()&&(f.childGlobal===f.parentFound&&(a=this.getGGinstance().player.PLVBL.getData()).cumm.samples>1&&(o+=a.cumm.samples,s=a.cumm.score/Q.VL[e]*100>=a.cummRule.viewabilitylength?1:0,l=Math.round(a.cumm.totalViewPercent/o)),n=n+t+",53,"+l+","+s+"|||"),Q.CS[e]=0),N>0&&(n=t+",25,"+N+","+V+","+B+"|||"+n,N=0,V=0,B=0),n},this.processEvent=function(e,t,n,r,i,d){try{var p,f,m,v,g,y,P,W,J,Y,te,re,oe,se=0,le=e;if(S==le&&s==n&&l==r&&c==i&&u==d)return;if(isFinite(n)&&(n=Z(Number(n))),isFinite(r)&&(r=Z(Number(r))),S=le,s=n,l=r,c=i,u=d,I=!1,null==(p=0==e.indexOf("cust:")?a.genericEvent(e,t,n,r,i,d):a.glanceguideEvent(e,t,n,r,i,d))||""==p)return;switch(Y=p.split(","),le=Number(Y[1]),n=Y[2],r=Y[3],M=D,le){case 1:return C=p,void(null!=s&&(E=s));case 51:if(C)return C=t+",1,"+s,null!=l&&""!=l&&(C=C+","+l),void(null!=s&&(E=s));p=t+",51,"+s,l&&(p=p+","+l),E=s;break;case 2:case 13:case 14:case 24:default:break;case 3:case 15:X=!1,w=0,"preroll"==(r=-1===p.toLowerCase().indexOf("<type>content")&&-1===p.toLowerCase().indexOf("<vidtype>content")?"ad":"content")||"postroll"==r||"midroll"==r||"ad"==r?(v=1,A=p):(v=0,R=p),3===le&&"content"===r&&(K.push(p.substring(p.indexOf(","))),p="");var de={type:ee("type",v),vidtype:ee("vidtype",v)};G=null!==de.type?de.type:null!==de.vidtype?de.vidtype:0,D=v,M=v,function(e){Q.CS[e]=0,Q.PA[e]=0,Q.PL[e]=0,Q.SA[e]=0,Q.FA[e]=0,Q.FP[e]=0,Q.SI[e]=0,Q.MI[e]=0,Q.SR[e]=0,Q.SK[e]=0,Q.CI[e]=0,Q.DI[e]=0,Q.ER[e]=0,Q.SV[e]=0,Q.SH[e]=0,Q.PB[e]=0,Q.II[e]=0,Q.VL[e]=0,Q.PM[e]=0,Q.SS[e]=0}(v),15==le&&(Q.CS[v]=1,x=1),te=unescape(ee("length",D));var ce=ee("ou",D);ce&&ce.length>0&&(E=ce),te=null==te||isNaN(te)?30:Number(te),Q.VL[D]=te,m=ee("title",D),Q.Title[D]=null!=m&&""!=m?m:n,$(),q=0,Q.SS[D]=q,ee("chapter",D)||1,function(e,t,a,n,r){var i,o,s,l,d,c,u,p,f,m,v,g,h,_,y,P;if(F.prod.indexOf("iag")>=0){if(e){if(L="",2==F.iagads)return}else if(O="",2==F.iagcontent)return;i=null!=F.sid?"&pr=iag.sid,"+F.sid:"",o=null!=F.tfid?"&pr=iag.tfid,"+F.tfid:"",s="&pr=iag.bcr,"+F.clientid,0!=e&&"preroll"==a||(null!=(P=ee("iagcategory",0))&&""!=P||(P=ee("category",0)),l=null!=P&&""!=P?"&pr=iag.pgm,"+encodeURIComponent(P):"&pr=iag.pgm,general",d=null!=(P=ee("title",0))&&""!=P?"&pr=iag.epi,"+encodeURIComponent(P):"&pr=iag.epi,"+encodeURIComponent(Q.Title[0].substr(0,255)),c="&pr=iag.seg,",c+=r>1?encodeURIComponent(r):"1",null==(P=ee("pd",0))&&(P=F.pd),u=null!=P&&""!=P?"&pr=iag.pd,"+encodeURIComponent(P):"",p=null!=(P=ee("oad",0))&&""!=P?"&pr=iag.oad,"+encodeURIComponent(P):"",i=ae("sid",i,0),o=ae("tfid",o,0),s=ae("bcr",s,0),l=ae("pgm",l,0),d=ae("epi",d,0)),g=ae("fp",g,e),y=ae("cust1",y,e),e?(f="&pr=iag.brn,"+F.clientid,m="&pr=iag.cte,"+encodeURIComponent(t),v="midroll"==a?"&pr=iag.ap,mid":"postroll"==a?"&pr=iag.ap,post":"&pr=iag.ap,pre",i=ae("sid",i,e),o=ae("tfid",o,e),s=ae("bcr",s,e),f=ae("brn",f,e),m=ae("cte",m,e),l=ae("pgm",l,e),d=ae("epi",d,e),c=ae("seg",c,e),u=ae("pd",u,e),p=ae("oad",p,e),h=ae("pod",h,e),_=ae("apt",_,e),L=i+o+s+l+d+c+u+f+v+m+p+g+h+_+y):O=i+o+s+l+d+c+u+p+g+y}}(v,n,r,0,d),function(e){var t,a,n,r,i,o="",s=0,l=!1;for(e?T="":k="",t=1==e?A:R;0==l;){if((s=t.indexOf("<nol_",s))<0){l=!0;break}if((a=t.indexOf(">",s))<0){l=!0;break}if(r=t.substring(s+5,a),(n=t.indexOf("</",a+1))<0){l=!0;break}i=t.substring(a+1,n),s=n+7,encodeURIComponent(r).indexOf("%")<0&&r.length>32&&(r=r.substring(0,31)),i.length>254&&(i=i.substring(0,253)),o=r.indexOf("raw_")>-1?o+"&"+(r=r.substr(4))+"="+i:o+"&"+r+"="+encodeURIComponent(i)}e?T=o:k=o}(v),X=!0;break;case 4:w=0,g=n,v=(g=isNaN(g)||0==g?Q.PL[D]:Z(Number(n)))-Q.PL[D],Q.PA[D]+=v,Q.PL[D]=g,Number(Q.PM[D])<g&&(Q.PM[D]=g),f=this.genSummation(D,t),de={type:ee("type",D=0),vidtype:ee("vidtype",D)},G=null!==de.type?de.type:null!==de.vidtype?de.vidtype:"content",x=0,q=0;break;case 5:if(0===D&&H&&3==H[D]&&K.length>0){var ue=String(t-1)+String(K.pop());G="content",p=""!==ue?ue+"|||"+p:p}if(w++,g=n,q=0,isNaN(g)){f="";break}0==(g=Z(Number(n)))&&0!=Q.PA[D]||(Q.PL[D]=g),Q.CS[D]=1,x=1,o.updateViewState(ie(g)),Q.SS[D]=q;break;case 6:if(w++,g=n,isNaN(g)){f="";break}(v=(g=Z(Number(n)))-Q.PL[D])>0&&(Q.PA[D]+=v),Q.PL[D]=g,Q.CS[D]=1,x=0,o.updateViewState(ie(g));break;case 7:if(Q.CS[D]=1,1==Q.SS[D]||null==Q.SS[D])return;if(g=n,isNaN(g)){f="";break}g=Z(Number(n)),(v=Number(g)-Q.PL[D])>0&&(Q.PA[D]+=v),Q.PL[D]=g,Number(Q.PM[D])<g&&(Q.PM[D]=g),Q.PA[D]>0&&(f=this.genSummation(D,t)),x=0,q=1,Q.SS[D]=q,Q.PA[D]=0,Q.FA[D]=0,Q.FP[D]=0,0==D&&$();break;case 8:if(w++,g=n,isNaN(g)){f="";break}if(g=Z(Number(n)),y=r,isNaN(y)){f="";break}y=Number(r),(v=g-Q.PL[D])>0&&(Q.PA[D]+=v),Q.PL[D]=y,Q.CS[D]=1,o.updateViewState(ie(y));break;case 9:n.toLowerCase().indexOf("true")>-1||!0===n||n.toLowerCase().indexOf("on")>-1||1==n?Q.MI[D]+=1:Q.MI[D]-=1;break;case 10:(n||n.toLowerCase().indexOf("on")||1==n)&&(Q.SR[D]+=1),_=!1,Q.FA[0]=Q.FA[1]=0,Q.FP[0]=Q.FP[1]=0;break;case 11:isNaN(n)||(j<0||n>j&&(Q.SI[D]+=1),j=n);break;case 12:Q.DI[D]+=1;break;case 16:case 22:Q.CI[D]+=1;break;case 17:Q.SH[D]+=1;break;case 18:Q.SV[D]+=1;break;case 19:case 20:Q.PB[D]+=1;break;case 21:Q.II[D]+=1;break;case 23:Q.ER[D]+=1;break;case 25:return N+=1,V+=Z(Number(n)),void(B<V&&(B=V));case 49:if(isNaN(n))return;if((g=Z(Number(n)))<=1||1!=x)return;if(o.updateViewState(ie(g)),0==z.length)return;if(re=Q.PA[D]+(g-Q.PL[D]),0!==z.length&&re<z[0])return;Q.PA[D]+=g-Q.PL[D],Q.PL[D]=n,f=this.genSummation(D,t),z.splice(0,1)}if(oe=10,(oe=isNaN(Q.VL[D])?10:Q.VL[D]/60*10)>100&&(oe=100),oe<20&&(oe=20),1==I)return;if(w>oe&&3!=le&&15!=le&&4!=le&&7!=le)return;if(w>5e3)return;if(null!=f&&f.length>0&&(p=f+p),""!==C&&""!==p&&(p=C+"|||"+p,C=""),W=Number(1!=M?F.trackcontent:F.trackads),!isNaN(W))switch(W){case 0:return;case 2:case 3:if(null!=(J=ee("ggignr",M))&&"1"==J)return}""!==p&&(se=o.addMessage(p,"NA")),h+=se,P=H[D],7==le?(ne(2),0==D?U=1:(M=0,D=0),P=H[D]):49==le?(ne(1),P=0):15==le?(ne(0),P=0,0==D&&(U=0)):3==le?5==H[D]?(ne(0),P=0,0==D&&(U=0)):P=3:5==le?3==H[D]?(ne(0),P=0):0==n?1==U&&0==D?(Q.PM[D]=0,ne(0),P=0,U=0):P=5:P=0:(6==le&&0!=n||8==le&&0!=r)&&(P=0),H[D]=P,Number(h)>=Number(b)&&ne(1),this.processGeneric=function(e,t,a,n,r,i){this.processEvent("cust:"+e,t,a,n,r,i)}}catch(e){}},this.init=function(e,i,s,l,c){var u=null.firstChild.firstChild,h=0,_=v.player?v.player.getClientConfig():{},S=v.player.getBaseDomain(_)||".nmrodam.com/";for(this._detectsBrowserClose=c;null!=u&&h<20;)null!=u.firstChild&&(F[u.nodeName]=u.firstChild.nodeValue),u=u.nextSibling,h++;1!=n._ggmsgfmt&&(s=(s=null==F.sfcode||F.sfcode.length<2?W+"//secure-gl"+S+"cgi-bin/m?":W+"//secure-"+F.sfcode+S+"cgi-bin/m?")+"ci="+F.clientid,null!=F.cisuffix&&""!=F.cisuffix&&(s+=F.cisuffix),null!=F.vcid&&""!=F.vcid&&(s=s+"&c6=vc,"+F.vcid),null!=F.partner&&""!=F.partner&&(s=s+"&c4=mn,"+encodeURIComponent(F.partner)),s+="&cc=1"),t=s,null==F.prod&&(F.prod="vc"),this._ggtrackid=F.clientid,null!=F.vcid&&(this._ggtrackid=this._ggtrackid+"."+F.vcid),a="genjsplayer"==e?new m:new p,this._ggplayername="gj3",null!=F.msgmax&&F.msgmax>0&&(b=F.msgmax),null!=F.msgint&&""!=F.msgint&&(P=F.msgint),null!=F.focusint&&F.focusint>=0&&(y=F.focusint),this._detectsBrowserClose&&(-1!=r.navigator.appName.toLowerCase().indexOf("safari")||-1!=r.navigator.userAgent.toLowerCase().indexOf("firefox")?r.addEventListener("pagehide",re,!0):r&&r.NOLBUNDLE),o=new d(g,i,t,!0,!0,J),0!=y&&(f.globalHasFocus(),r.setInterval(this.updateFocusNumbers,1e3*y)),this.processEvent("1",(new Date).getTime(),r.location.href,r.document.referrer)}}function s(){var e=null,t=0;this.makeUserIDCookie=function(t){return e=function(e){var t,a="",n="";for(t=0;t<e;t++)n=Math.floor(36*Math.random()).toString(36),a+=Math.floor(2*Math.random())?n.toUpperCase():n.toLowerCase();return a}(32)},this.makeNewMessageCookie=function(){},this.clearMessageCookie=function(){},this.getMessageCookieSequenceNumber=function(){return++t},this.getUserId=function(){return e}}function l(e,t,a,n,r){var i='END"/></GGC>',o="|||",s="",l=Math.floor(1e5*Math.random())+1,d='<GGC><H value="'+e+","+(new Date).getTimezoneOffset()/-60+","+t+"."+l+","+n+","+r._ggplayername+'"/><L value="';this.getCurrentMessage=function(){return s},this.makePartialMessage=function(e){return""==s?s=d+e+o:s+=e+o,s},this.makeMessages=function(e){var t;return""==s?s:(t=s+i,s="",t)},this.makeUnloadMessages=function(e){var t;return""!=e?(t=e.split(","),r.processEvent("7",(new Date).getTime(),t[0]),null):(""==s&&(s=d),s+(new Date).getTime()+",2"+o+i)}}function d(e,t,a,n,r,i){var o,d=new s,p=null,f=d.getMessageCookieSequenceNumber(),m=i,v=new c(a,a+"logthisjs.php",a+"postjs.php","GET"),g=new u,h="",_=String.fromCharCode(56)+String.fromCharCode(103)+String.fromCharCode(36)+String.fromCharCode(15)+String.fromCharCode(126)+String.fromCharCode(3)+String.fromCharCode(71)+String.fromCharCode(91)+String.fromCharCode(100)+String.fromCharCode(7)+String.fromCharCode(17)+String.fromCharCode(31)+String.fromCharCode(95)+String.fromCharCode(28)+String.fromCharCode(64)+String.fromCharCode(14);d.makeUserIDCookie(t),d.makeNewMessageCookie(),null==t&&(t="0"),p=new l(e,t,f,m._ggtrackid,m),g.encrypt(_,'END"/></GGC>'),this.getMessage=function(){if(void 0!==p)return p.getCurrentMessage()},this.getSeqNumber=function(){return f},this.report=function(e,t,a){o=p.makeMessages(e),o="<m v=2 c="+d.getUserId()+">"+g.encrypt(_,o)+"<%2Fm>",v.report(o,a)},this.reportend=function(e){(o=p.makeUnloadMessages(h))&&(o="<m v=2 c="+d.getUserId()+">"+g.encrypt(_,o)+"<%2Fm>",v.report(o,e))},this.addMessage=function(e,t){return p.makePartialMessage(e).length},this.updateViewState=function(e){var t;m._detectsBrowserClose&&(5!=(t=m.getlfunctionType())&&8!=t||(e=""),h=e)}}function c(e,t,a,n){var r=e,i="GET-CONFIRM",o=new Image(1,1);null!=n&&(i=n),this.report=function(e,t){null!=e&&""!=e&&"POST"!=i&&function(e,t){var a=r;"GET"==i&&(o=new Image(1,1)),o.src=a+t+"HEX40%3D"+e}(e,t)}}function u(){this.urlencode=function(e){var t,a={},n=e.toString(),r=function(e,t,a){return a.split(e).join(t)};for(t in a["'"]="%27",a["("]="%28",a[")"]="%29",a["*"]="%2A",a["~"]="%7E",a["!"]="%21",a["%20"]="+",n=encodeURIComponent(n),a)a.hasOwnProperty(t)&&(n=r(t,a[t],n));return n.replace(/(\%([a-z0-9]{2}))/g,(function(e,t,a){return"%"+a.toUpperCase()}))},this.encrypt=function(e,t){return this.urlencode(function(e,t){var a,n,r,i,o,s,l="";if(null==e||null==t)return t;for(n=(a=e.split("")).length,i=(r=t.split("")).length,s=0;s<i;s++)l+=0==(o=r[s].charCodeAt(0)^(i%10|a[s%n].charCodeAt(0)))?r[s]:String.fromCharCode(o);return l}(e,function(e){var t,a,n,r;for(r="",n=void 0!==e&&e.length>0?e.length:0,t=0;t<n;t++)(a=e.charCodeAt(t))<128?r+=String.fromCharCode(a):a>127&&a<2048?(r+=String.fromCharCode(a>>6|192),r+=String.fromCharCode(63&a|128)):a<65536?(r+=String.fromCharCode(a>>12|224),r+=String.fromCharCode(a>>6&63|128),r+=String.fromCharCode(63&a|128)):(r+=String.fromCharCode(a>>18|240),r+=String.fromCharCode(a>>12&63|128),r+=String.fromCharCode(a>>6&63|128),r+=String.fromCharCode(63&a|128));return r}(t)))}}function p(){this._currentEvent=-1,this._currentDuration="NA";var e=null,t=null,a=null,n=null,r=null,i=null,o=null,s=null,l=null,d=null,c=null,u=null;this.getCurrentEvent=function(){return this._currentEvent},this.genericEvent=function(e,t,s,l,d,c){var u;return a==e&&n==s&&r==l&&i==d&&o==c?null:(u=function(e,t,a,n,r,i){var o=t+","+e;return null==e||e.length<=5?null:(null!=a&&(o=o+","+a),null!=n&&(o=o+","+n),null!=r&&(o=o+","+r),null!=i&&(o=o+","+i),o)}(e,t,s,l,d,c),null!=u&&(a=e,n=s,r=l,i=d,o=c),u)},this.glanceguideEvent=function(a,n,r,i,o,p){var f=null;return s==a&&l==r&&d==i&&c==o&&u==p?null:(1==a?(this._currentEvent=a,e=r,f=n+","+this._currentEvent+","+e,null!=i&&(f=f+","+i)):10==a||9==a?(this._currentEvent=a,f=0==r?n+","+this._currentEvent+",0":1==r?n+","+this._currentEvent+",1":n+","+this._currentEvent+","+r):12==a?(this._currentEvent=a,f=n+","+this._currentEvent):49==a||11==a?(this._currentEvent=a,f=n+","+this._currentEvent+","+r):"videoInfo"==a?t=r:f=this.processEvent(a,n,r,i,o,p),null!=f&&(s=a,l=r,d=i,c=o,u=p),f)},this.processEvent=function(e,t,a,n,r,i){},this.getVideoInfo=function(e,a){var n="";return null!=e&&(n="<length>"+e+"</length>"),null!=a&&(n=n+"<uurl>"+a+"</uurl>"),null!=t&&(n+=t,t=null),n}}function f(e,t){var a=e.indexOf("<"+t+">")+t.length+2,n=e.indexOf("</"+t+">",a),r=null;return a>=0&&n>a&&(r=e.substring(a,n)),r}function m(){this.inheritFrom=p,this.inheritFrom();var e=null;this.processEvent=function(t,a,n,r,i,o){var s,l,d="";return 3==t&&3!=this._currentEvent||15==t&&15!=this._currentEvent?(s=f(i,"censuscategory"),null==f(i,"category")&&null!=s&&""!=s&&(i=i+"<category>"+s+"</category>"),this._currentDuration=f(i,"length"),d=d+","+n+","+r+","+i,o&&""!=o&&!isNaN(o)?d=d+","+o:d+=",1",e=15!=t&&e):1==t||51==t||8==t?(d=d+","+n,null!=r&&(d=d+","+r)):6==t&&1!=e&&"00:00"!=n?(e=!0,d=d+","+n):5==t&&0!=e?(e=!1,d=d+","+n):7==t?(e=!0,d=d+","+n):9==t?d+=0==n?",Off":",On":(d=d+","+n,null!=r&&r.length>0&&(d=d+","+r)),""==d?l=null:(this._currentEvent=t,l=a+","+this._currentEvent+d),l}}return n.init=function(e){var a={_playerID:null,gmtOffset:60*(new Date).getTimezoneOffset(),ggJsMet:null,ggLoaded:!1,ggEventQue:[],playerType:"genjsplayer",_nolggGlobalParams:{},_detectsBrowserClose:!1,_canDetectBrowser:!0,_bStr:"",_bLoc:"",_isFireFox:!1,bVer:"",player:e,ggInitialize:function(e){var r="",i=e||{};for(var s in a._nolggGlobalParams=i.ggParams,a._canDetectBrowser=void 0!==i.detectBrowser?i.detectBrowser:a._canDetectBrowser,a._playerID=i.nol_playerId,a._canDetectBrowser&&a.detectBrowser(),a._nolggGlobalParams)a._nolggGlobalParams.hasOwnProperty(s)&&(r=r+"<"+s+">"+a._nolggGlobalParams[s]+"</"+s+">");a.ggJsMet=new o(a),a.ggJsMet.init(a.playerType,i.uid,n.GGADDRESS,r,a._detectsBrowserClose),t._listeners.addListener("ggPM",(function(e){a.ggPM(e)}))},detectBrowser:function(){a._detectsBrowserClose=!0,a._bStr=r.navigator.userAgent,a._bLoc=a._bStr.indexOf("Firefox"),null!=a._bStr&&a._bLoc>=0&&(a._isFireFox=!0,a.bVer=a._bStr.substring(a._bLoc+8),Number(a.bVer)<3&&(a._detectsBrowserClose=!1)),a._bLoc=a._bStr.indexOf("MSIE"),null!=a._bStr&&a._bLoc>=0&&(a.bVer=a._bStr.substring(a._bLoc+5),Number(a.bVer)<6&&(a._detectsBrowserClose=!1))},ggPM:function(e){if(a._playerID==e.target.id){var t=e.target.evtInfo,n=String(t.eventType),r=String(t.param1),i=String(t.param2),o=String(t.param3),s=String(t.param4);if(!(-1!=="|14|56|48|57|55|".indexOf("|"+n+"|")||isNaN(n)&&"videoInfo"!==n))try{if(null!=a.ggJsMet){if(-1!==r.toLowerCase().indexOf("object"))for(var l in r=t.param1.uurl||"",i=t.param1.type||t.param1.vidtype,o="",t.param1)t.param1.hasOwnProperty(l)&&(o=o+"<"+l+">"+t.param1[l]+"</"+l+">");a.ggJsMet.processEvent(n,(new Date).getTime(),r,i,o,s)}else a.ggEventQue.push(n),a.ggEventQue.push((new Date).getTime()),a.ggEventQue.push(r),a.ggEventQue.push(i),a.ggEventQue.push(o),a.ggEventQue.push(s)}catch(e){}}},ggJsLoaded:function(){if(null!=a.ggJsMet){for(var e=0,t=a.ggEventQue.length;e<t;e+=6)a.ggJsMet.processEvent(a.ggEventQue[e],a.ggEventQue[e+1],a.ggEventQue[e+2],a.ggEventQue[e+3],a.ggEventQue[e+4],a.ggEventQue[e+5]);a.ggEventQue=[]}}};a.ggInitialize(e.getConfigParams()),e.hasOwnProperty("emptyQueue")&&e.emptyQueue()},void 0===t||n.built||(n.built=!0,a.logDebug("PLCMB built",t),t.bindPlayers(n,"PLCMB")),n}var Oe=function(e,t,a){var n=g();try{a=a||n,e&&a&&a.dispatchEvent(new n.CustomEvent(e,{detail:t}))}catch(e){n&&n._listeners&&n._listeners.fireEvent("error",{type:"error",msg:"Browser error attempting to call element.dispatchEvent()."})}},Le=function(e){var t=g();try{if(e=e.toString().toLowerCase(),t&&t.location&&t.location.search&&t.location.search.length>0){var a=t.location.search.substr(1).split("&"),n="";if(a.find)n=a.find((function(t){return 0===t.toLowerCase().indexOf(e+"=")}));else for(var r=0,i=a.length;r<i;r++)if(0===a[r].toLowerCase().indexOf(e+"=")){n=a[r];break}if(n){var o=n.split("=");if(o&&o.length>1)return o[1]}}}catch(e){t&&t._listeners&&t._listeners.fireEvent("error",{type:"error",msg:"Browser error attempting to retrieve query string parameter."})}return""},ke=Oe,Te=Le,Ce=function(e){var t=pe();try{var a=e.type,n=e.timestamp;switch(a.toLowerCase()){case"blur":t.isInFocus=!1,function(e){var t=F(),a=pe();t.GLCFG._listeners.fireEvent("blur",e),a._listeners.fireEvent("debug",{type:"debug",msg:"Handling blur - ".concat(e)})}(n);break;case"focus":t.isInFocus=!0,function(e){var t=F(),a=pe();t.GLCFG._listeners.fireEvent("focus",e),a._listeners.fireEvent("debug",{type:"debug",msg:"Handling focus - ".concat(e)})}(n);break;case"appclose":!function(e){var t=F(),a=pe();t.GLCFG._listeners.fireEvent("appclose",e),a._listeners.fireEvent("debug",{type:"debug",msg:"Handling appClose - ".concat(e)})}(n);break;default:t._listeners.fireEvent("debug",{type:"debug",msg:"Unknown event ".concat(a)})}}catch(a){t._listeners.fireEvent("debug",{type:"debug",msg:"Error in processing event object: ".concat(e," - ").concat(a)})}};function Ee(){return(Ee=a(c().mark((function e(){var t,a,n,r,i,o,s,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=function(e){if(void 0!==r&&void 0!==r.storageGetItem)return void 0===e?r.storageGetItem(o):void r.storageSetItem(o,e)},s=function(e){if(void 0!==t.lsController)return void 0===e?void t.lsController.store.get(i):void t.lsController.store.set(i,e)},t=pe(),a=ae.getStaticInstance().getVersion(),n=g(),r=S.getInstance(),i="nol_lsid",o="nol_emmURL",t.EMMURL="",t.gotCookies=!1,t.gotEMMURL=!1,t.onLSReady=[],t.localStorageId="-1",t.gotLSID=!1,t.queryCookie=function(e){if(void 0!==r&&void 0!==r.storageGetItem)return r.storageGetItem(e)},t.initLS=function(e,t,a,n){},t.getEmmUrl=function(){return l()},t.setEmmUrl=function(e){e&&(t.EMMURL=e,l(t.EMMURL))},t.queryCookies=function(){return{}},t.getOptoutCookie=function(){return t.optoutCookie},t.isOptout=function(){return t.optoutCookie&&"true"===t.optoutCookie.toLowerCase()||"OPTOUT"===t.localStorageId},t.cookie=t.cookie||function(){var e={cookie:""},t={setCache:function(t){e.cookie=t},getCookies:function(){if(e.cookie)try{var t=e.cookie.split(";"),a=null,n={};return t.forEach((function(e){a=e.trim().split("="),n[a[0].trim()]=a[1].trim()})),n}catch(e){}return{}},get:function(e){return e?t.getCookies()[e]:""}};return{cache:t.setCache,get:t.get,all:t.getCookies}}(),t.getIfLsidShouldSend=function(){var e=t.getMap(a);if(e.hasOwnProperty("LSID"))return e.LSID},t.lsReady=function(){return!0},t.getLS=function(){return t.gIframe},t.getLsId=function(){return"string"!=typeof t.localStorageId?t.localStorageId.toString():t.localStorageId},t.setLsId=function(e,a,n,r){if(n)var i=n.sessionId;var o=(r=r&&Array.isArray(r)?r.concat(["secure-eu","eu","eu-uat","eu-cert"]):["secure-eu","eu","eu-uat","eu-cert"]).indexOf(t.sfCode.toLowerCase())>-1;if(null!=e&&e!==t.getLsId()&&(t.localStorageId=e,s(t.localStorageId)),a&&t.postMsgAvail&&o)if(t.userAgent&&t.userAgent.isAndroid&&t.userAgent.isAndroid()&&t.userAgent.androidVersion&&t.userAgent.androidVersion().major<6){var l="";t.userAgent.isChrome&&t.userAgent.isChrome()?(l="intent://nuid/"+i+"/#Intent;action=android.intent.action.VIEW;scheme=nielsenwebid;component=com.nielsen.odm/.NielsenMobileMeter;end",t.lsController.request(l),t._listeners.fireEvent("info",{type:"info",msg:"Firing EMM intent "+l})):(l="nielsenwebid://nuid/"+i,t.lsController.request(l),t._listeners.fireEvent("info",{type:"info",msg:"Firing EMM deep link "+l})),t.setEmmUrl(l)}else t.lsController.maskedRequest(a),t._listeners.fireEvent("info",{type:"info",msg:"Firing EMM link "+a}),t.setEmmUrl(a)},t.waitForLS=function(e){t.thirdPartyData.localStorageEnabled?e&&(t.gIframeReady&&"-1"!==t.localStorageId?e():t.onLSReady.push(e)):e&&e()},t.lsController={store:{get:function(e){if(void 0!==r&&void 0!==r.storageGetItem)return r.storageGetItem(e)},set:function(e,t){if(void 0!==r&&void 0!==r.storageGetItem)return r.storageSetItem(e,t)}},request:function(e){void 0!==r&&r.storageGetItem},maskedRequest:function(e){void 0!==r&&r.storageGetItem},maskedRequestWithRetry:function(e){void 0!==r&&r.storageGetItem}},d=function(e){e.GLCFG.queryCookie=t.queryCookie,e.GLCFG.initLS=t.initLS,e.GLCFG.etEmmUrl=t.getEmmUrl,e.GLCFG.setEmmUrl=t.setEmmUrl,e.GLCFG.queryCookies=t.queryCookies,e.GLCFG.getOptoutCookie=t.getOptoutCookie,e.GLCFG.isOptout=t.isOptout,e.GLCFG.cookie=t.cookie,e.GLCFG.getIfLsidShouldSend=t.getIfLsidShouldSend,e.GLCFG.lsReady=t.lsReady,e.GLCFG.getLS=t.getLS,e.GLCFG.getLsId=t.getLsId,e.GLCFG.setLsId=t.setLsId,e.GLCFG.waitForLS=t.waitForLS,e.GLCFG.lsController=t.lsController},void 0===t.initLS&&d(n);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we=function(){function e(){n(this,e),s(this,"ERROR","input is invalid type"),s(this,"HEX_CHARS","0123456789abcdef".split("")),s(this,"EXTRA",[-2147483648,8388608,32768,128]),s(this,"SHIFT",[24,16,8,0]),s(this,"K",[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}return i(e,[{key:"update",value:function(e){if(!this.finalized){var t,a,n=f(e);if("string"!==n){if("object"!==n)throw new Error(this.ERROR);if(null===e)throw new Error(this.ERROR);if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error(this.ERROR);t=!0}for(var r,i=0,o=e.length,s=this.blocks;i<o;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,this.block=s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(r=this.start;i<o&&r<64;++i)s[r>>>2]|=e[i]<<this.SHIFT[3&r++];else for(r=this.start;i<o&&r<64;++i)(a=e.charCodeAt(i))<128?s[r>>>2]|=a<<this.SHIFT[3&r++]:a<2048?(s[r>>>2]|=(192|a>>>6)<<this.SHIFT[3&r++],s[r>>>2]|=(128|63&a)<<this.SHIFT[3&r++]):a<55296||a>=57344?(s[r>>>2]|=(224|a>>>12)<<this.SHIFT[3&r++],s[r>>>2]|=(128|a>>>6&63)<<this.SHIFT[3&r++],s[r>>>2]|=(128|63&a)<<this.SHIFT[3&r++]):(a=65536+((1023&a)<<10|1023&e.charCodeAt(++i)),s[r>>>2]|=(240|a>>>18)<<this.SHIFT[3&r++],s[r>>>2]|=(128|a>>>12&63)<<this.SHIFT[3&r++],s[r>>>2]|=(128|a>>>6&63)<<this.SHIFT[3&r++],s[r>>>2]|=(128|63&a)<<this.SHIFT[3&r++]);this.lastByteIndex=r,this.bytes=this.bytes+(r-this.start),r>=64?(this.block=s[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes=this.hBytes+(this.bytes/4294967296|0),this.bytes=this.bytes%4294967296),this}}},{key:"finalize",value:function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>>2]|=this.EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}}},{key:"hash",value:function(){var e,t,a,n,r,i,o,s,l,d=this.h0,c=this.h1,u=this.h2,p=this.h3,f=this.h4,m=this.h5,v=this.h6,g=this.h7,h=this.blocks;for(e=16;e<64;++e)t=((r=h[e-15])>>>7|r<<25)^(r>>>18|r<<14)^r>>>3,a=((r=h[e-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,h[e]=h[e-16]+t+h[e-7]+a|0;for(l=c&u,e=0;e<64;e+=4)this.first?(i=704751109,g=(r=h[0]-210244248)-1521486534|0,p=r+143694565|0,this.first=!1):(t=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),n=(i=d&c)^d&u^l,g=p+(r=g+(a=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&m^~f&v)+this.K[e]+h[e])|0,p=r+(t+n)|0),t=(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),n=(o=p&d)^p&c^i,v=u+(r=v+(a=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&f^~g&m)+this.K[e+1]+h[e+1])|0,t=((u=r+(t+n)|0)>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(s=u&p)^u&d^o,m=c+(r=m+(a=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&g^~v&f)+this.K[e+2]+h[e+2])|0,t=((c=r+(t+n)|0)>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),n=(l=c&u)^c&p^s,f=d+(r=f+(a=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&v^~m&g)+this.K[e+3]+h[e+3])|0,d=r+(t+n)|0,this.chromeBugWorkAround=!0;this.h0=this.h0+d|0,this.h1=this.h1+c|0,this.h2=this.h2+u|0,this.h3=this.h3+p|0,this.h4=this.h4+f|0,this.h5=this.h5+m|0,this.h6=this.h6+v|0,this.h7=this.h7+g|0}},{key:"hex",value:function(){this.finalize();var e=this.h0,t=this.h1,a=this.h2,n=this.h3,r=this.h4,i=this.h5,o=this.h6,s=this.h7,l=this.HEX_CHARS[e>>>28&15]+this.HEX_CHARS[e>>>24&15]+this.HEX_CHARS[e>>>20&15]+this.HEX_CHARS[e>>>16&15]+this.HEX_CHARS[e>>>12&15]+this.HEX_CHARS[e>>>8&15]+this.HEX_CHARS[e>>>4&15]+this.HEX_CHARS[15&e]+this.HEX_CHARS[t>>>28&15]+this.HEX_CHARS[t>>>24&15]+this.HEX_CHARS[t>>>20&15]+this.HEX_CHARS[t>>>16&15]+this.HEX_CHARS[t>>>12&15]+this.HEX_CHARS[t>>>8&15]+this.HEX_CHARS[t>>>4&15]+this.HEX_CHARS[15&t]+this.HEX_CHARS[a>>>28&15]+this.HEX_CHARS[a>>>24&15]+this.HEX_CHARS[a>>>20&15]+this.HEX_CHARS[a>>>16&15]+this.HEX_CHARS[a>>>12&15]+this.HEX_CHARS[a>>>8&15]+this.HEX_CHARS[a>>>4&15]+this.HEX_CHARS[15&a]+this.HEX_CHARS[n>>>28&15]+this.HEX_CHARS[n>>>24&15]+this.HEX_CHARS[n>>>20&15]+this.HEX_CHARS[n>>>16&15]+this.HEX_CHARS[n>>>12&15]+this.HEX_CHARS[n>>>8&15]+this.HEX_CHARS[n>>>4&15]+this.HEX_CHARS[15&n]+this.HEX_CHARS[r>>>28&15]+this.HEX_CHARS[r>>>24&15]+this.HEX_CHARS[r>>>20&15]+this.HEX_CHARS[r>>>16&15]+this.HEX_CHARS[r>>>12&15]+this.HEX_CHARS[r>>>8&15]+this.HEX_CHARS[r>>>4&15]+this.HEX_CHARS[15&r]+this.HEX_CHARS[i>>>28&15]+this.HEX_CHARS[i>>>24&15]+this.HEX_CHARS[i>>>20&15]+this.HEX_CHARS[i>>>16&15]+this.HEX_CHARS[i>>>12&15]+this.HEX_CHARS[i>>>8&15]+this.HEX_CHARS[i>>>4&15]+this.HEX_CHARS[15&i]+this.HEX_CHARS[o>>>28&15]+this.HEX_CHARS[o>>>24&15]+this.HEX_CHARS[o>>>20&15]+this.HEX_CHARS[o>>>16&15]+this.HEX_CHARS[o>>>12&15]+this.HEX_CHARS[o>>>8&15]+this.HEX_CHARS[o>>>4&15]+this.HEX_CHARS[15&o]+this.HEX_CHARS[s>>>28&15]+this.HEX_CHARS[s>>>24&15]+this.HEX_CHARS[s>>>20&15]+this.HEX_CHARS[s>>>16&15]+this.HEX_CHARS[s>>>12&15]+this.HEX_CHARS[s>>>8&15]+this.HEX_CHARS[s>>>4&15]+this.HEX_CHARS[15&s];return l}},{key:"digest",value:function(){this.finalize();var e=this.h0,t=this.h1,a=this.h2,n=this.h3,r=this.h4,i=this.h5,o=this.h6,s=this.h7;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,a>>>24&255,a>>>16&255,a>>>8&255,255&a,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s]}},{key:"arrayBuffer",value:function(){this.finalize();var e=new ArrayBuffer(32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),t.setUint32(28,this.h7),e}}],[{key:"sha256",value:function(t){var a;return null===(a=(new e).update(t))||void 0===a?void 0:a.hex()}}])}(),Ie=function(){return i((function e(t,a,r,i){n(this,e),this.id=t,this.startTime=Date.now(),this.events=[],this.deviceEvents=[],this.requests=[],this.validations=[],this.configs=[],this.debugServerUrl=a,this.funcsProcessor=i,this.sendToDebugServer=r,this.isEnabled=!0,this.numFailedRequests=0}),[{key:"trackEvent",value:function(e){this.events.push(e),this.sendToDebugServer("/event",d(d({},e),{},{sessionId:this.id}))}},{key:"trackFetchRequest",value:function(e,t){this.requests.push(e),this.sendToDebugServer("/fetch",{url:e,status:t,sessionId:this.id})}},{key:"trackDeviceEvent",value:function(e){this.deviceEvents.push(e),this.sendToDebugServer("/deviceevent",{event:e,sessionId:this.id})}},{key:"trackConfig",value:function(e){this.configs.push(e),this.sendToDebugServer("/config",{config:e,sessionId:this.id})}},{key:"runValidation",value:function(){var e=[];0===this.requests.length?e.push({rule:"At least one request should be made during a session",result:!1}):e.push({rule:"At least one request should be made during a session",result:!0}),this.validations=e,this.sendToDebugServer("/validation",{sessionId:this.id,validations:e})}},{key:"endSession",value:function(){this.endTime=new Date,this.runValidation(),this.sendToDebugServer("/session",this),this.funcsProcessor&&this.funcsProcessor.logDebug("Session ended: ".concat(this.id))}}])}();s(Ie,"MAX_FAILED_REQUEST",5);var De=function(){function e(t){var r=this;n(this,e),s(this,"startSession",(function(e){var t="session-".concat(void 0!==e?e:Date.now()),a=new Ie(t,r.debugServerUrl,r.sendToDebugServer,r.funcsProcessor);return r.sessions.push(a),r.sendToDebugServer("/session",a),r.funcsProcessor&&r.funcsProcessor.logDebug("Session started: ".concat(t)),a})),s(this,"trackEvent",(function(t,a){var n="session-".concat(t),i=r.sessions.find((function(e){return e.id===n}));i?i.trackEvent(a):r.funcsProcessor&&(r.funcsProcessor.logDebug("Session not found: ".concat(n)),e.checkFailedRequests())})),s(this,"trackDeviceEvent",(function(t,a){var n="session-".concat(t),i=r.sessions.find((function(e){return e.id===n}));i?i.trackDeviceEvent(a):r.funcsProcessor&&(r.funcsProcessor.logDebug("Session not found: ".concat(n)),e.checkFailedRequests())})),s(this,"trackFetchRequest",(function(t,a,n){var i="session-".concat(t),o=r.sessions.find((function(e){return e.id===i}));o?o.trackFetchRequest(a,n):r.funcsProcessor&&(r.funcsProcessor.logDebug("Session not found: ".concat(i)),e.checkFailedRequests())})),s(this,"trackConfig",(function(t,a){var n="session-".concat(t),i=r.sessions.find((function(e){return e.id===n}));i?i.trackConfig(a):r.funcsProcessor&&(r.funcsProcessor.logDebug("Session not found: ".concat(n)),e.checkFailedRequests())})),s(this,"endSession",(function(t){var a="session-".concat(t),n=r.sessions.find((function(e){return e.id===a}));n?n.endSession():r.funcsProcessor&&(r.funcsProcessor.logDebug("Session not found: ".concat(a)),e.checkFailedRequests())})),s(this,"getSessionValidationResults",(function(e){var t="session-".concat(e),a=r.sessions.find((function(e){return e.id===t}));return a?a.validations:null})),s(this,"sendToDebugServer",function(){var t=a(c().mark((function t(a,n){var i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!1!==e.isEnabled){t.next=3;break}return t.abrupt("return");case 3:return r.funcsProcessor&&r.funcsProcessor.logDebug("Sending data to ".concat(a," - data: ").concat(JSON.stringify(n))),t.next=6,fetch("".concat(r.debugServerUrl).concat(a),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).catch((function(t){r.funcsProcessor&&(r.funcsProcessor.logDebug("Error sending data to ".concat(a," - ").concat(t," from sendToDebugServer.")),e.checkFailedRequests())}));case 6:return(i=t.sent)&&!i.ok&&r.funcsProcessor&&r.funcsProcessor.logDebug("Failed to send data to ".concat(a,": ").concat(i.statusText)),t.abrupt("return",i);case 11:t.prev=11,t.t0=t.catch(0),r.funcsProcessor&&(r.funcsProcessor.logDebug("Error sending data to ".concat(a," - ").concat(t.t0," from sendToDebugServer.")),e.checkFailedRequests());case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,a){return t.apply(this,arguments)}}()),this.debugServerUrl=t&&void 0!==t.debugServerUrl?t.debugServerUrl:"http://localhost:3000",this.funcsProcessor=t&&void 0!==t.funcsProcessor?t.funcsProcessor:null,this.sessions=[],this.funcsProcessor&&this.funcsProcessor.logDebug("Debug server URL: ".concat(this.debugServerUrl))}return i(e,null,[{key:"getInstance",value:function(t){return e.instance||(e.instance=new e(t)),e.instance}},{key:"clearInstance",value:function(){e.instance=null}},{key:"checkFailedRequests",value:function(){e.numFailedRequests++,e.numFailedRequests>=e.MAX_FAILED_REQUEST&&(e.isEnabled=!1)}}])}();s(De,"MAX_FAILED_REQUEST",5),s(De,"isEnabled",!0),s(De,"numFailedRequests",0);var Me=v.addressPrefix,Re=v.webProtocol,Ae=v.configGlobalVer,Fe=v.sdkvForConfig,xe=v.sdkBuildVersion,Ge=v.collectionAddress,je=!1,Ne=0,Ve=0,Be=v.nsdkvOverride,He=v.sessionIdUrlPrefix,Ue=v.sessionIdUrlSuffix,qe=v.domlessSuffix,Qe=function(e){e&&e.hasOwnProperty("target")&&(je="true"===String(e.target).toLowerCase())},Xe=function(e,t){try{var n,r,i=function(e,t){if("string"==typeof e&&(e={type:e}),e.target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(P[e.type]instanceof Array)for(var a=P[e.type],n=0,r=a.length;n<r;n++)a[n].call(w,t)},o=function(e){e&&(e.registerListener("ggPM",w),e._listeners&&!1===w.listenersInitialized&&(e._listeners.addListener("updateCmbStaticPage",w.handleUpdateOfStatic),e._listeners.addListener("removeCmbAssetId",w.removeAsset),e._listeners.addListener("tick",(function(){Ne=Date.now(),Ve=Math.ceil((Ne-0)/1e3),E=!1,i("globalTick",{time:Ne,seconds:Ve})})),e._listeners.addListener("dcrHeartbeat",(function(e){!function(e,t){if(e&&e.hasOwnProperty("target")&&!isNaN(e.target.elapsed)){var a,n,r,i,o=ae.getStaticInstance().getInstance(t),s=F();if(void 0===(a=o)||!a.hasOwnProperty("staticPage")||!a.staticPage.hasOwnProperty("evtParams"))return;if("string"==typeof(n=a.staticPage.evtParams).param1.type&&"static"===n.param1.type.toLowerCase()){if(s&&s.GLCFG&&(r=s.GLCFG.globalHasFocus&&s.GLCFG.globalHasFocus(),i=s.GLCFG.availModules.PLDCR&&s.GLCFG.availModules.PLDCR.safeFocusOn),r||i||a.staticIFrameFlag)return void a.ggPM("48",e.target.elapsed,"","","");if(!r||document&&document.visibilityState&&"hidden"===document.visibilityState)a.ggPM("flush","0"),e.target.pause(),i&&(s.GLCFG.availModules.PLDCR.safeFocusOn=!1)}}}(e,w.name)})),e._listeners.addListener("flushQueue",w.emptyQueue),e._listeners.addListener("handleSessionReset",w.handleSessionReset),e._listeners.addListener("flushPauseEventQueue",w.flushPauseEventQueue),e._listeners.addListener("sendOptOutStatus",Qe),w.listenersInitialized=!0))},s=function(e,t){n&&n.ggParams&&n.ggParams.nol_sdkDebug&&["debug","info","warn","true"].indexOf(n.ggParams.nol_sdkDebug.toString().toLowerCase())>-1&&S.getInstance().logInfo(v.TAG+" Log: "+e,t||"")},l=function(e,t){s("Firing ping "+e.url);var a=S.getInstance(),n=L.getInstance(),r={method:"GET",credentials:"include",mode:"no-cors"};if(void 0!==e&&(!e||e.hasOwnProperty("url")&&0!==e.url.length)&&e.hasOwnProperty("retryDelay")&&e.hasOwnProperty("currRetry")&&e.hasOwnProperty("maxRetry")){var i={requestUrl:function(){var a=this;try{++e.currRetry>e.maxRetry?(a.logErr("maxRetry reached. Storeing request for later."),n.storeRequest(e.url,r),t&&t()):a.sendUrlRequest(e.url)}catch(e){a.logErr("Error in fireToUrl requestUrl: "+e),t&&t()}},sendUrlRequest:function(i){var o=this;try{if(void 0===i)return;n.fetchWithRetry(i,r).then((function(e){e&&e.ok?(t&&t(),a.logDebug("Success making fetch to ".concat(i))):o.requestUrl()})).catch((function(t){o.logErr("Error in fireToUrl sendUrlRequest: "+t),a.processSetTimeout((function(){o.requestUrl()}),e.retryDelay)}))}catch(e){o.logErr("Error in fireToUrl sendUrlRequest: "+e),t&&t()}},logErr:function(e){e&&a&&a.logError("Error: ",e)}};i.requestUrl()}},d=function(e,t,a,n){var r=a.enableHem,i=a.enableUid2,o=a.nol_clientCMSmap,s=a.nol_tagMap.nol_defaults.nol_hemUidCharLimit,l=!1;i=i&&"true"===i.toString().toLowerCase(),r=r&&"true"===r.toString().toLowerCase(),s=parseInt(s)||300;var d="SDK received parameter(s) values exceeding permissible limit of ".concat(s," characters: ");for(var c in e)for(var u in o)o[u]===c&&(!n&&(i&&-1!==c.indexOf("uid2")||r&&-1!==c.indexOf("hem_"))&&(e[c].length<=s?t[u]=e[c]:(d+="".concat(c," contains ").concat(e[c].length," characters, "),h.GLCFG._listeners.fireEvent("error",{type:"error",msg:"".concat(c," parameter value: ").concat(e[c]," exceeds ").concat(s," characters")}),l=!0)),-1===c.indexOf("uid2")&&-1===c.indexOf("hem_")&&(t[u]=e[c]));return l&&(d=d.trim().slice(0,-1),k.push({type:17,msg:d})),t},u=function(e){!E&&e&&"blur"===e.type&&(w.ggPM("flush","0"),E=!0,w.tsObj.bgTimestamp=H(),w.inBackground=!0,s("Data flushed on "+e.type+" event"))},p=function(e){if(w.tsObj.fgTimestamp=H(),w&&w.inBackground&&!w.phDeltaCheck){var t=B(w);s("Focus Event PTO calculations:"),s("plid=".concat(w.id," - Delta: ").concat(t," | Pause Time: ").concat(w.pauseObj.pauseTime," - (").concat(w.tsObj.fgTimestamp,")")),s("plid=".concat(w.id," - New Pause Time = ").concat(t," + ").concat(w.pauseObj.pauseTime," = ").concat(w.pauseObj.pauseTime+t," - (").concat(w.tsObj.fgTimestamp,")")),w.pauseObj.pauseTime=w.pauseObj.pauseTime+t}w.inBackground=!1,w.phDeltaCheck&&(w.phDeltaCheck=!1)},m=g(),h=F(),y=pe(),P={},b=[],O=[],k=[],T={},C=String(Date.now())+Math.round(1e4*Math.random()),E=!1,w=t||{};if(w.sessionManager=w.sessionManager||null,w.id=C,w.name=e,w.initialized=!1,w.staticPage={},w.modules={allModInit:!1},w.configLoaded=!1,w.apid="",w.sdkv=Ae,w.sdkvForConfig=Fe,w.useCachedConfig=null!=t,w.sessionId="",w.sivt=null,w.state=null,w.isAdobe=!1,w._pauseTimeoutEnabled=!1,w.pauseObj={pauseTime:0,eventPauseTime:0},w.tsObj={bgTimestamp:0,fgTimestamp:0,phTimestamp:0},w.inBackground=!1,w.phDeltaCheck=!1,w.fpidObj={fpidEnabled:!1,newFpid:!1,fpidTTL:""},w.listenersInitialized=!1,t){if(t.q){var I,D=null;for(I=0;I<t.q.length;I++)(D=t.q[I])&&D.length>0&&b.push({eventType:D[0],param1:D.length>1?D[1]:void 0,param2:D.length>2?D[2]:void 0,param3:D.length>3?D[3]:void 0,param4:D.length>4?D[4]:void 0});delete t.q}else t.getEventQue&&(b=t.getEventQue());O=t.te||[]}var M={_queueEventLog:!1,_eventLog:[],init:function(){try{var e=Te("nol_eventHookDelay");if(M._queueEventLog=!1,e){var t=parseInt(e);"NaN"!==t.toString()&&(M._queueEventLog=!0,S.getInstance().processSetTimeout((function(){M._queueEventLog=!1}),1e3*(t<=20?t:20)))}}catch(e){M._queueEventLog=!1}},trigger:function(e,t){try{if(t){var a=JSON.parse(JSON.stringify(t));a.name=e.name,a.sdkv=Fe,M._queueEventLog?M._eventLog.push(a):M._eventLog&&M._eventLog.length>0&&(M._eventLog=[])}}catch(e){}}},R={metadataURL:"",metadataPing:"",pageURL:"",pageTitle:"",hasMetaPingFired:!1,_isWithinIFrame:function(){try{return m.self!=m.top}catch(e){return!0}},_isWithinFriendlyIFrame:function(){try{return!!(m&&m.top&&m.top.document&&m.top.document.domain)&&!!m.top.document}catch(e){return!1}},_isReferrerAvailable:function(){try{return!(!m.document||!m.document.referrer)&&""!==m.document.referrer}catch(e){return!1}},evalPageData:function(){},handleMetadataPingReset:function(){this.hasMetaPingFired&&(this.hasMetaPingFired=!1)}},A=(w.name,function(e,t){});return w.metadataCtrl=R,w.getOptOutStatus=function(){return je},w.getId=function(){return C},w.GetName=function(){return w.name},w.Initialized=function(e){if(void 0===e)return w.initialized;w.initialized=e},w.getPauseQueueCount=function(){return Object&&Object.keys?Object.keys(T).length:0},w.disablePauseTimeout=function(){w._pauseTimeoutEnabled&&(w._pauseTimeoutEnabled=!1,s("Player "+w.id+" pause timeout disabled"))},w.enablePauseTimeout=function(){w._pauseTimeoutEnabled||(w._pauseTimeoutEnabled=!0,s("Player "+w.id+" pause timeout enabled"))},w.hasPauseTimeoutExpired=function(e){w.pauseObj.hasOwnProperty("maxPauseTime")&&w.pauseObj.pauseTime>w.pauseObj.maxPauseTime&&"dcrvideo"===e.get("nol_product")&&(w.pauseObj.pauseTime=0,y._listeners.fireEvent("handleSessionReset",{plid:w.id,passedFdata:e}),y._listeners.fireEvent("debug",{type:"debug",msg:"Max pause time reached. Just fired handleSessionReset."}))},w.removeAsset=function(e){void 0!==e&&e.target.param1.hasOwnProperty("assetid")&&(w.staticPage={})},w.handleUpdateOfStatic=function(e){if(e&&e.target){var t=e.target.evtInfo;if(h.GLCFG&&h.GLCFG.availModules&&h.GLCFG.availModules.PLDCR&&void 0!==t&&t.param1.hasOwnProperty("assetid")&&w.getId()===e.target.plid){var a=h.GLCFG.availModules.PLDCR.latestDcrTick();0!==Object.keys(w.staticPage).length&&w.staticPage.hasOwnProperty("id")&&w.staticPage.id===t.param1.assetid&&w.staticPage.hasOwnProperty("lastTimeStamp")?w.staticPage.lastTimeStamp=a:w.staticPage={id:t.param1.assetid,evtParams:t,startTimeStamp:a,lastTimeStamp:a}}}},w.addListener=function(e,t,a){t&&(void 0===P[e]&&(P[e]=[]),P[e].push(t))},w.removeListener=function(e,t){if(w._listeners[e]instanceof Array)for(var a=P[e],n=0,r=a.length;n<r;n++)if(a[n]===t){a.splice(n,1);break}},w.handleSessionReset=function(e){if(e&&e.target&&e.target.hasOwnProperty("plid")&&C===e.target.plid&&e.target.hasOwnProperty("passedFdata")&&e.target.passedFdata.hasOwnProperty("_dataArrObj")&&e.target.passedFdata._dataArrObj){var t={plid:e.target.plid,fData:e.target.passedFdata._dataArrObj,content:{},ad:{},err:0};if(0===function(e){try{var t="Error in retrieveMeta";if(e&&e.hasOwnProperty("fData")&&e.hasOwnProperty("ad")&&e.hasOwnProperty("content")&&e.hasOwnProperty("plid")){var a=function(e){try{if(!e||!e.hasOwnProperty("cmsMap"))return[];var t=[];for(var a in e.cmsMap)e.cmsMap.hasOwnProperty(a)&&-1!==e.cmsMap[a].indexOf("nol_")&&t.push(e.cmsMap[a].replace(/[{(\[\])}]/g,""));return t}catch(e){}}({cmsMap:h.GLCFG.availModules.PLDPR.getCmsMap(e.plid)});for(var n in e.fData)if(e.fData.hasOwnProperty(n)&&"count"!==n){var r=e.fData[n][Object.keys(e.fData[n]).splice(-1,1)];if(null!=r&&"object"===f(r))for(var i in r){var o=String(i);-1!==o.indexOf("nol_")&&-1===a.indexOf(o)||(e[n][i]=r[i])}}return e}return e&&e.hasOwnProperty("err")?(e.err=t+": Missing passedFdata, Ad, content or static properties",e):{err:t}}catch(e){}}(t).err&&e.target.passedFdata.hasOwnProperty("_currVidType")){var a=e.target.passedFdata._currVidType,n=Object.keys(t.content).length>0,r=Object.keys(t.ad).length>0;(n||r)&&("sessionreset"!==e.target.passedFdata.get("nolPriv_prevEventState")&&w.ggPM("57","1","sessionReset","",""),n&&!T.hasOwnProperty("content")&&(T.content={evt:"pauseloadmeta",meta:t.content,plid:e.target.plid}),"ad"===a&&r&&!T.hasOwnProperty("ad")&&(T.ad={evt:"pauseloadmeta",meta:t.ad,plid:e.target.plid}))}}w._listeners&&w._listeners.fireEvent&&w._listeners.fireEvent("debug",{type:"debug",msg:"Fired handleSessionReset from ggcmb."})},w.flushPauseEventQueue=function(){if(!(Object.keys(T).length<=0)){if(w.modules.PLDPR){var e;for(e in T)i("ggPM",{evtInfo:{eventType:T[e].evt,param1:T[e].meta},id:C}),null!==w.sessionManager&&w.sessionManager.trackEvent(w.sessionId,T[e].evt);T={}}w._listeners&&w._listeners.fireEvent&&w._listeners.fireEvent("debug",{type:"debug",msg:"Fired flushPauseEventQueue from ggcmb."})}},w.cloneObj=function(e){return e&&"object"===f(e)?JSON.parse(JSON.stringify(e)):e},w.ggPM=function(e,t,a,n,r){if(w.initialized)if(null!=e&&""!==e){var o={};if(o.eventType=e,o.param1=w.cloneObj(t),o.param2=w.cloneObj(a),o.param3=w.cloneObj(n),o.param4=w.cloneObj(r),!w.modules.allModInit||2!=w.modules.PLCMB&&2!=w.modules.PLDPR)b.push(o);else{w.emptyQueue();var s=JSON.parse(JSON.stringify(o));i("ggPM",{evtInfo:o,id:C}),null!==w.sessionManager&&w.sessionManager.trackEvent(w.sessionId,o),M.trigger(w,s)}}else h&&h.GLCFG&&h.GLCFG._listeners&&h.GLCFG._listeners.fireEvent("sendError",{data:{type:17,msg:"Error in ggPM() - Missing event type param in ggPM"},id:C,timeStamp:Date.now()})},w.trackEvent=function(e,t,a){if(e&&"object"===f(e)){if(!w.initialized||!w.state)return;if(w.modules.allModInit&&w.configLoaded&&2==w.modules.PLDPR){if(!(e=Array.isArray(O)&&O.length>0?(t||O.push(w.cloneObj(e)),O.splice(0,1)[0]||{}):e))return;w.state.transition(e,(function(e,t,a,n,r){var o={inferred:!0};o.eventType=e,o.param1=w.cloneObj(t),o.param2=w.cloneObj(a),o.param3=w.cloneObj(n),o.param4=w.cloneObj(r);var s=JSON.parse(JSON.stringify(o));i("ggPM",{evtInfo:o,id:C}),null!==w.sessionManager&&w.sessionManager.trackEvent(w.sessionId,o),M.trigger(w,s)})),M.trigger(w,{eventType:"trackEvent",param1:e})}else O.push(w.cloneObj(e))}else h&&h.GLCFG&&h.GLCFG._listeners&&h.GLCFG._listeners.fireEvent("sendError",{data:{type:17,msg:"Error in trackEvent() - Missing trackEvent metadata object"},id:C,timeStamp:Date.now()})},w.getConfigParams=function(){return n},w.emptyQueue=function(){if(!(b.length<=0&&O.length<=0)&&w.modules.allModInit&&w.configLoaded&&(w.modules.PLCMB||w.modules.PLDPR)){for(var e=0;e<b.length;e++){var t=JSON.parse(JSON.stringify(b[e]));i("ggPM",{evtInfo:b[e],id:C}),null!==w.sessionManager&&w.sessionManager.trackEvent(w.sessionId,b[e]),M.trigger(w,t)}for(b=[];O.length>0;)O[0]&&w.trackEvent(O[0],!0)}},w.getContainer=function(){return r},w.getClientConfig=function(){return h.configs?h.configs[w.apid]:null},w.getBaseDomain=function(e){return e.nol_GLOBALS&&void 0!==e.nol_GLOBALS.enableCookielessDomain&&"true"===e.nol_GLOBALS.enableCookielessDomain.toString().toLowerCase()?".nmrodam.com/":".imrworldwide.com/"},w.modifySddParam=function(e){if(e&&e.nol_GLOBALS&&e.nol_GLOBALS.enableSDD&&"true"===e.nol_GLOBALS.enableSDD&&e.nol_GLOBALS.nol_tagMap&&e.nol_GLOBALS.nol_tagMap.nol_url){for(var t=/(sdd=)[^&]*/,a=e.nol_GLOBALS.nol_tagMap.nol_url,n=0;n<a.length;n++)a[n].match(t)&&(a[n]=a[n].replace(t,"$1|![(nol_staticIntervalTimeElapsed)]!|"));e.nol_GLOBALS.nol_tagMap.nol_url=a}return e},w.ggInitialize=function(e,t,i,s,u,p){if(w.initialized)return new Promise((function(e,t){e(w)}));M.init();var m,v,g="us";if(r=p,n={ggParams:e,uid:i,oldFlashDetect:s,detectBrowser:u,nol_playerId:C},f(e)==f(String())){for(m=y.loadXmlString("<vi>"+e+"</vi>").firstChild.firstChild,v=0,e={};m&&void 0!==m&&v<20;)null!==m.firstChild&&(e[m.nodeName]=m.firstChild.nodeValue),m=m.nextSibling,v++;n.ggParams=e}var P=JSON.parse(JSON.stringify(n.ggParams));delete P.apid,delete P.sfcode,delete P.nsdkv,delete P.nol_sdkDebug,delete P.optout,delete P.nol_debugSessionTracking,n.ggParams.nol_sdkDebug=Te("nol_sdkDebug")||n.ggParams.nol_sdkDebug,n.ggParams.nol_debugSessionTracking=Te("nol_debugSessionTracking")||n.ggParams.nol_debugSessionTracking,w.Initialized(!0),w.apid=n.ggParams.apid;var b=w.getClientConfig(),S=w.getBaseDomain(b);b=w.modifySddParam(b),Ae=(e.nsdkv?e.nsdkv.toString():"")||Ae,Be=(e.nsdkvOverride?e.nsdkvOverride.toString():"")||Be,g=e.sfcode||g;var O=e.coreaddress?Re+"//"+e.coreaddress+"/":_(S);Fe=e.sdkconfigver||Fe,w.nsdkvOverride=n.ggParams.nsdkvOverride,w.sdkv=Ae,w.sdkvForConfig=w.useCachedConfig&&w.sdkv&&3===w.sdkv.length?"bj."+w.sdkv[0]+"."+w.sdkv[1]+"."+w.sdkv[2]:Fe,Ge=h.GLCFG.getPrefProtocol(b)+":"+(e.coreaddress?Me+g:"//secure-"+g)+S;var T=n&&n.ggParams,E=T.optout,I=T.nol_sdkDebug,D=T.apid,F=T.enableFpid,x=T.nol_debugSessionTracking,G=b&&b.nol_GLOBALS,j=G.nol_useroptout,N=G.nol_xorSeed,V=G.nol_dfltAppid,B=G.enableCookielessDomain,H=G.enableFpid,U=G.nol_fpid_ttl,q=G.nol_emmsfcodelist,X=G.nol_tagMap.nol_defaults,z=void 0!==j&&"true"===j.toString().toLowerCase()||void 0!==E&&["true","1","t","y","yes"].indexOf(E.toString().toLowerCase())>-1;B=void 0!==B&&"true"===B.toString().toLowerCase(),w.deviceId=z||B?"":we.sha256(e.deviceId),void 0!==H&&(H=H.toString().toLowerCase(),w.fpidObj.fpidEnabled="true"===H),void 0!==F&&(F=F.toString().toLowerCase(),["true","1","yes"].indexOf(F)>-1&&(w.fpidObj.fpidEnabled=!0),["false","0","no"].indexOf(F)>-1&&(w.fpidObj.fpidEnabled=!1)),w.fpidObj.fpidTTL=U||X.nol_fpid_ttl;try{w.optout=z}catch(e){}function W(){return(W=a(c().mark((function e(){var t,a,n,r,i,s,u,p,f,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=be.getStaticInstance(),a=fe.getStaticInstance(),w.sessionId=h.GLCFG&&h.GLCFG.generateGUID?h.GLCFG.generateGUID():w.id,B=void 0!==B&&"true"===B.toString().toLowerCase(),L.getInstance().setSessionId(w.sessionId),void 0!==x&&!0===x&&null===w.sessionManager&&(w.sessionManager=De.getInstance(),w.sessionManager.startSession(w.sessionId)),!w.fpidObj.fpidEnabled){e.next=12;break}return e.next=9,a.get("nol_fpid");case 9:(!(n=e.sent)||n&&a.fpidExpired(w.fpidObj.fpidTTL))&&(a.create(g,q),w.fpidObj.newFpid=!0),!w.fpidObj.newFpid&&a.update&&a.update(g,q);case 12:r=b&&b.nol_GLOBALS,r.syncPingFlagList,r.nol_appid,i=r.nol_metadataURL,void 0!==I&&["debug","info","warn","true"].indexOf(I.toString().toLowerCase())>-1,null!==w.sessionManager&&w.sessionManager.trackConfig(w.sessionId,b),i&&(R.metadataURL=i),s={nol_prefProtocol:h.GLCFG.getPrefProtocol(b),nol_sfcode:g,nol_userSessionId:w.sessionId,nol_appid:b.nol_GLOBALS.nol_appid,nol_deviceId:w.deviceId,nol_sdkDelimiter:b.nol_GLOBALS.nol_sdkDelimiter,nol_sdkv:w.sdkvForConfig+qe,nol_bldv:h.GLCFG.getBaseBuildVer()+xe,nol_useroptout:w.optout?"true":""},w.fpidObj.fpidEnabled&&a.appendData(s),u="",p=z;try{P&&Object.keys(P).length&&d(P,s,b.nol_GLOBALS,p),u=h.GLCFG.evalTemplate(X.nol_sessionURL,s,N)}catch(e){}if(u||(u=Ge+He+(V||D)+Ue,u=h.GLCFG.evalTemplate(u,s,N)),Q(u+="&retry=0",{},!0,"session"),!t.getLib("GLCFG")){e.next=37;break}if(!h.GLCFG){e.next=35;break}if(h.GLCFG.sfCode=g,o(t.getLib("GLCFG")),h.GLCFG.loadChildren(w.sdkv),!h.GLCFG.availModules.PLDPR){e.next=35;break}return e.next=33,h.GLCFG.availModules.PLDPR.initFromConfig(b,w.id,!1);case 33:if(k.length)for(f=0;f<k.length;f++)h.GLCFG._listeners.fireEvent("sendError",{data:k[f],id:C,timeStamp:Date.now()});y.availModules.PLSIVT&&(w.sivt=new y.availModules.PLSIVT(w));case 35:e.next=40;break;case 37:l({url:u,currRetry:-1,maxRetry:5,retryDelay:1e3}),m=pe(),o(m);case 40:return e.abrupt("return",new Promise(A));case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){Ee.apply(this,arguments)}(),h.GLCFG.initLS(O),w.state=y.availModules.PLSTM?new y.availModules.PLSTM.stateMachine(w.id,b):null,function(){W.apply(this,arguments)}()},w.isViewable=function(){return!1},w.processEvent=function(e){var t=e.type,a=e.timestamp;s("Process ".concat(t," at ").concat(a)),null!==w.sessionManager&&w.sessionManager.trackDeviceEvent(w.sessionId,t),Ce({type:t,timestamp:a})},w.cleanupInstance=function(e){ae.getStaticInstance().removeInstance(e);var t=["addListener","addListenerSingle","fireEvent","removeListener","sendError"];for(var a in h.GLCFG._listeners)t.includes(a)||delete h.GLCFG._listeners[a]},!m||!m.GLCFG||m.GLCFG.flushEvent&&m.GLCFG.focusEvent||(m.GLCFG.flushEvent=u,m.GLCFG.focusEvent=p),h.GLCFG._listeners.addListener("blur",(function(e){u(e)})),h.GLCFG._listeners.addListener("focus",(function(e){p()})),h.GLCFG._listeners.addListener("appclose",(function(e){w.ggPM("end","0"),u(e)})),w}catch(e){S.getInstance().logError("Error inside CMB: ".concat(e))}},ze=function(){function e(){n(this,e),s(this,"_videoController",{checkRewind:function(e,t){if(e&&null!=t&&"stream"!==he({data:e,param:"nol_cadence"})&&"impression"!==he({data:e,param:"nol_cadence"})){var a=Math.floor(x(t,"num")),n=ie.getInstance().state.position.current(e);return{match:a-n<0,currentPos:a,previousPos:n}}return!1},checkForward:function(e,t){if(e&&null!=t&&"stream"!==he({data:e,param:"nol_cadence"})&&"impression"!==he({data:e,param:"nol_cadence"})){var a=ie.getInstance(),n=Math.floor(x(t,"num")),r=a.state.position.current(e),i=a.state.timeStamp.current(e),o=x(he({data:e,param:"nol_cmsIntrvlGp"}),"num")||2,s=Math.ceil(h()/1e3-i)||1;if(0==r&&n>86400&&a&&a.localTimer&&"nol_cmsoffset"===a.localTimer(e)){var l=Math.round(h()/1e3).toString().substr(0,t.toString().length);l&&(r=parseInt(l))}var d=n-r;return{match:d>o&&d>Math.ceil(1.5*s),currentPos:n,previousPos:r}}return!1}}),s(this,"_controller",{inferEvent:function(e,t,a,n,r){var i=null,o=ie.getInstance(),s=ae.getStaticInstance(),l=We.getInstance();try{if(i={event:"event_"+e,curPos:o.state.position.current(t),prevPos:null,timestamp:n},e&&t)switch(e.toLowerCase()){case"3":case"15":case"loadmetadata":case"pauseloadmeta":var d=o.asset.parse(t,r),c=o.state.asset.current(t),u=o.state.asset.previous(t),p=o.state.type.current(t),f=o.type.parse(t,r),m=o.state.asset.current(t,f);if(i.event=this.events.load,i.assetId=d,i.contentType=f,o.state&&o.state.status&&o.state.status.current(t,f)==o.states.paused&&(c==d&&null!==d||p!==f)){i.event=this.events.resume,i.assetId=d,i.contentType=f,i.curPos="{{nextTick}}";break}if(m!=d||o.state&&o.state.status&&o.state.status.current(t,f)===o.states.stopped&&u==d&&null!==d||null===c){i.event=this.events.play,i.curPos="{{nextTick}}";break}break;case"5":case"play":i.event="event_play";break;case"7":case"stop":i.event="event_stop";break;case"57":case"end":case"oncomplete":i.event=this.events.stop;break;case"49":case"setplayheadposition":case"playheadposition":if(a>-1){var v=this._videoController.checkRewind(t,a);if(v.match){i.event=this.events.rewind,i.curPos=v.currentPos,i.prevPos=v.previousPos,i.p1=i.prevPos-i.curPos;break}if(-1===l.get(t).indexOf("{{nextTick}}")){var g=this._videoController.checkForward(t,a);if(g.match){i.event=this.events.forward,i.curPos=g.currentPos,i.prevPos=g.previousPos,i.p1=i.curPos-i.prevPos;break}}if(o.state.status.current(t)===o.states.paused){i.event=this.events.resume,i.assetId=o.state.asset.current(t),i.contentType=o.type.current(t),i.curPos=a;break}i.event=this.events.playhead,i.curPos=a}break;case"55":var h=he({data:t,param:he({data:t,param:"nol_timer"})})||he({data:t,param:"nol_fdoffset"});"daypart"===he({data:t,param:"nol_cadence"})&&(h=(h=x(h,"num"))+he({data:t,param:"nol_timer"})=="nol_pcoffset"?x(he({data:t,param:"nol_pcTimeCode"}),"num"):x(he({data:t,param:"nol_fdTimeCode"}),"num")),i.event=this.events.playhead;break;case"9":case"mute":i.event=this.events.mute,i.p1=a}}catch(t){s._listeners.fireEvent("error",{type:"error",msg:"Error in eventsController. Error inferring event - "+e})}return i}}),this.events={load:"LOAD",play:"PLAY",pause:"PAUSE",stop:"STOP",resume:"RESUME",rewind:"REWIND",forward:"FORWARD",playhead:"PLAYHEAD",mute:"MUTE",unmute:"UNMUTE"},this.inferEvent=this._controller.inferEvent}return i(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}(),We=function(){function e(){var t=this;n(this,e),s(this,"_controller",{_playerController:ie.getInstance(),get:function(e,a){var n="";return e&&(n=he({data:e,param:t._key,vidType:a||e._currVidType})),n},set:function(e,a,n){return e&&he({data:e,param:t._key,val:a,vidType:n||e._currVidType}),e},clear:function(e){e&&(he({data:e,param:t._key,val:"",vidType:"ad"}),he({data:e,param:t._key,val:"",vidType:"content"}))},clone:function(e){try{return{content:t.get(e,"content"),ad:t.get(e,"ad")}}catch(e){return null}},bind:function(e,a){try{if(e&&a)for(var n in a)t.set(e,a[n],n)}catch(e){}},append:function(e,a){if(e&&a){var n=t.get(e),r=t._controller.delimiter(e),i=t._controller.parseEventData(a);t.set(e,n?[n,i].join(r):i)}},delimiter:function(e){return e?(t._cache.delimiter||(t._cache.delimiter=he({data:e,param:t._delimiterKey})),t._cache.delimiter):""},isEnabled:function(e){return!!e&&"true"===he({data:e,param:t._enabledKey})},isEventEnabled:function(e,a){if(a&&e){var n=t._controller.lookupEvent(e.toLowerCase());if(n)return t._controller.eventsList(a).indexOf(n.name)>-1}return!1},eventsList:function(e){if(e){if(!t._cache.eventsList||0==t._cache.eventsList.length){var a=he({data:e,param:t._eventsKey});a&&(t._cache.eventsList=a.split(","))}return t._cache.eventsList}},eventDictionary:function(){return{play:{name:"play",abbrv:"PL"},pause:{name:"pause",abbrv:"PU"},rewind:{name:"rewind",abbrv:"RW"},forward:{name:"forward",abbrv:"FW"},stop:{name:"stop",abbrv:"ST"},resume:{name:"resume",abbrv:"RE"},mute:{name:"mute",abbrv:"MT"}}},clearCache:function(){t._cache.delimiter="",t._cache.eventsList=[]},lookupEvent:function(e){if(e){var a=t._controller.eventDictionary();if(a)return a[e.toLowerCase()]}return null},parseEventData:function(e){var a="";if(e){var n=t._controller.lookupEvent(e.event);if(n){var r=[n.abbrv,e.timestamp,e.curPos];void 0!==e.prevPos&&null!==e.prevPos&&e.curPos!=e.prevPos&&r.push(e.prevPos),void 0!==e.p1&&null!==e.p1&&r.push(e.p1),a=r.join(t._valueDelimiter)}}return a},handleEvent:function(e,a){e&&a&&t.isEventEnabled(a.event,e)&&t.append(e,a)},setNextTick:function(e,a,n){try{var r=t.get(e,n);if(r&&r.indexOf("{{nextTick}}")>-1)if(a&&a.event===t._eventsController.events.playhead)e=t.set(e,r.replace(/{{nextTick}}/gi,1==a.curPos?"0":a.curPos),n);else{var i="0";if(t._controller._playerController&&t._controller._playerController.state&&t._controller._playerController.state.position&&t._controller._playerController.state.position.current&&t._controller._playerController.state.position.current(e,n))i=t._controller._playerController.state.position.current(e,n)||"0";e=t.set(e,r.replace(/{{nextTick}}/gi,i),n)}return e}catch(e){}},preProcess:function(e,a){try{e&&a&&a.event&&a.event!==t._eventsController.events.play&&-1===a.event.indexOf("event_")&&(t.setNextTick(e,a),a.event===t._eventsController.events.stop&&t._controller._playerController&&t._controller._playerController.type&&"content"!==t._controller._playerController.type.current(e)&&t.setNextTick(e,a,"content"),t._controller.handleEvent(e,a))}catch(e){}},postProcess:function(e,a){try{e&&a&&a.event&&a.event===t._eventsController.events.play&&t._controller.handleEvent(e,a)}catch(e){}}}),this._key="nol_eventData",this._delimiterKey="nol_eventDataDelimiter",this._eventsKey="nol_eventDataEvents",this._enabledKey="nol_eventDataEnabled",this._valueDelimiter=":",this._cache={delimiter:"",eventsList:[]},this.get=this._controller.get,this.set=this._controller.set,this.clone=this._controller.clone,this.bind=this._controller.bind,this.clear=this._controller.clear,this.append=this._controller.append,this.isEnabled=this._controller.isEnabled,this.isEventEnabled=this._controller.isEventEnabled,this.preProcess=this._controller.preProcess,this.postProcess=this._controller.postProcess,this.setNextTick=this._controller.setNextTick,this._eventsController=ze.getInstance()}return i(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}(),Je={},Ke={},Ye={},$e=5,Ze=null,et=null,tt=v.baseConfigUrlBucket,at=v.dprErrorAPI;function nt(e){var t,a,n=null,r="content"==e._currVidType?x(he({data:e,param:"nol_chnlCountThrshld"}),"num")||$e:x(he({data:e,param:"nol_staticCountThrshld"}),"num")||$e,i=e._dataArrObj[e._currVidType],o=0,s=e._dataArrObj.count;if(!e._dataArrObj[e._currVidType].hasOwnProperty(e._currAssetid)){if(s[e._currVidType]>=r){for(a in i)if(i.hasOwnProperty(a)){if((o=i[a].nolPriv_priority)<=0){t=a;break}(null===n||n>o)&&(n=o,t=a)}i.hasOwnProperty(t)&&(delete i[t],s[e._currVidType]--)}e._dataArrObj[e._currVidType][e._currAssetid]={nolPriv_priority:0},s[e._currVidType]++}}function rt(e,t,a){var n,r,i=ie.getInstance(),o={},s=0,l=i.getEventsFilter(e);if(he({data:e,param:"nol_playerId"})===t.target.nol_playerId){for(r in t.target)t.target.hasOwnProperty(r)&&(he({data:e,param:r,val:t.target[r]}),o[r]=t.target[r]);var d=i.findPlayer(e);if(d){var c=void 0!==d.oServiceCall[a.service]&&d.oServiceCall[a.service].hasOwnProperty("status")?d.oServiceCall[a.service].status:"undefined";d.oServiceCall[a.service]={status:"complete",prevStatus:c,station:a.key,data:o},d.serviceSending[a.service]=!1}var u=e.get("nol_serviceFilter");if(ht(e,u?u[a.service]:l),"true"===he({data:e,param:"nol_disabled"}))return;e.serviceFlag[a.service].need&&(he({data:e,param:"nol_davState",val:"1"}),e.serviceFlag[a.service].need=!1,t.target.hasOwnProperty("nol_fdTimeCode")&&"daypart"===he({data:e,param:"nol_cadence"})&&(s=x(t.target.nol_fdTimeCode,"num"),n=x(he({data:e,param:"nol_queueTime"}),"num"),he({data:e,param:"nol_queueTime",val:n+s})),Ht(he({data:e,param:"nol_queueTime"}),e))}}function it(e,t){var a=j(),n=pe();try{var r=he({data:e,param:"nol_playerId"});a&&a.hasOwnProperty(r)&&(!a[r].hasOwnProperty("nol_sessionId")||a[r].hasOwnProperty("forceStreamRegen")&&!0===a[r].forceStreamRegen)&&(t=t||n.generateGUID(),a[r].nol_sessionId=t,a[r].forceStreamRegen=!1)}catch(e){n._listeners.fireEvent("error",{type:"error",msg:"Error in calcStreamId - "+e.message})}}function ot(e){var t=pe();try{var a=he({data:e,param:"nol_playerId"});if(a&&t._players&&t._players.hasOwnProperty(a)){var n,r=t._players[a];if(r&&Object.keys(r.ottStatusObj).length>0)for(n in r.ottStatusObj)he({data:e,param:n,val:r.ottStatusObj[n],vidType:"content"})}}catch(e){t._listeners.fireEvent("error",{type:"error",msg:"Error in populateOttStatus"+e})}}function st(e,t,a,n,r){try{var i=ie.getInstance();i.extendfData(e);var o,s=e.get("nol_useroptout"),l="",d="nol_minutes, nol_tagPresence, nol_pingCount, nol_currSeg, nol_segmentTimeSpent, nol_cumeTimeSpent, nol_count",c=he({data:e,param:{}});if(nt(e),Je=i.getEventsFilter(e),"ad"===e._currVidType.toLowerCase()&&(l="st,a",he({data:e,param:"nol_currSeg",val:"0"})),""===he({data:e,param:"nol_errorURL"})){var u=ae.getStaticInstance();he({data:e,param:"nol_errorURL",val:(u.getConfigAddress&&void 0!==u.getConfigAddress()?u.getConfigAddress():u.getAddress())+tt+at+"?message=|![nol_errorMessage]!|"})}if("loadMetadata"===t)for(o in c)c.hasOwnProperty(o)&&-1===d.indexOf(o)&&he({data:e,param:o,val:ye({data:e,param:o})||""});for(o in a)a.hasOwnProperty(o)&&he({data:e,param:String(o),val:String(a[o])});if(e.set("nol_useroptout",s),he({data:e,param:"nolPriv_sendData",val:!0}),he({data:e,param:"nol_davState",val:"0"}),he({data:e,param:"nol_highWM",val:"0"}),he({data:e,param:"nol_iagData",val:""}),he({data:e,param:"nol_disabled",val:"false"}),he({data:e,param:"nol_sendQual",val:ye({data:e,param:"nol_sendQual"})||""}),he({data:e,param:"nolPriv_assetid",val:""}),e.set("nolPriv_prevEvent",""),"S"===ye({data:e,param:"nol_segmentPrefix"})&&he({data:e,param:"nol_segmentPrefix",val:"S"}),he({data:e,param:"nol_c3"})||he({data:e,param:"nol_c3",val:l}),!r){"content"===e._currVidType.toLowerCase()&&it(e),he({data:e,param:"nol_applyViewInc",val:"1"}),(!he({data:e,param:"nol_minutes"})||"daypart"!==he({data:e,param:"nol_cadence"})&&"dcrstatic"!==he({data:e,param:"nol_product"})||"dcrstatic"===he({data:e,param:"nol_product"})&&"stream"===he({data:e,param:"nol_cadence"}))&&(Vt(e),he({data:e,param:"nol_pingCount",val:0}));var p=he({data:e,param:"nol_adLoadType",vidType:"content"});""!==p&&null!=p&&ht(e,Je.onAdLoadFlag),ot(e),n&&n.resetViewability&&n.resetViewability(e)}}catch(e){S.getInstance().logError("Error in init",e)}}function lt(e,t){pe();var a=j();a[t].bReInit||(a[t].bReInit=!0,a[t].eventQueue=[],e&&a[t].eventQueue.push(e),de(Ze))}function dt(e,t,a){if(pe(),t&&!0===t.flush||!("dcrstatic"===he({data:e,param:"nol_product"})&&"stream"!==he({data:e,param:"nol_cadence"})||e.isProductOf("vrivideo"))){var n="content"===he({data:e,param:"nol_ac"}),r=he({data:e,param:"nol_segmentTimeSpent"}),i=e.isProductOf(["mtvr","id3"]),o=e.isProductOf("dcrvideo"),s=e.isProductOf("dcrstatic");(n&&"interval"===e.get("nol_cadence")&&r>0||"streamduration"===he({data:e,param:"nol_cadence"})&&e.get("nol_segmentTimeSpent","ad")>0||"id3"===he({data:e,param:"nol_product"})&&he({data:e,param:"nol_id3Data"})||"dcrstatic"===he({data:e,param:"nol_product"})&&"stream"===he({data:e,param:"nol_cadence"})||"postroll"===he({data:e,param:"nol_vidtype"})&&"interval"===he({data:e,param:"nol_cadence"})||t&&!0===t.flush&&o&&"interval"===e.get("nol_cadence")&&r>0||t&&!0===t.flush&&o&&"streamduration"===e.get("nol_cadence")&&"ad"===e.get("nol_ac")&&e.get("nol_segmentTimeSpent","ad")>0||t&&!0===t.flush&&e.isProductOf("dcrstatic")&&"interval"===e.get("nol_cadence")&&e.get("nol_segmentTimeSpent","static")>0||"episode"===e.get("nol_cadence")&&r>0)&&((o||s)&&(n||t&&!0===t.save?Rt(e,{save:!0},a&&a.onPingFired?a.onPingFired:null):Rt(e,null,a&&a.onPingFired?a.onPingFired:null)),i&&(t?(!0===t.blur&&Rt(e,{blur:!0},a&&a.onPingFired?a.onPingFired:null),!0!==t.stop&&!0!==t.pause||Rt(e,{save:!0},a&&a.onPingFired?a.onPingFired:null)):Rt(e,null,a&&a.onPingFired?a.onPingFired:null)),he({data:e,param:"nolPriv_now",val:0}))}}function ct(e,t,a){var n,r=pe(),i=ie.getInstance(),o=i.findPlayer(e),s=i.getEventsFilter(e),l=o.oServiceCall[t.service],d=t.url,c=t.key;if(t.evntCB=he({data:e,param:e.serviceFlag[t.service].callback}),t.callBack=function(a){rt(e,a,t)},a)return r._listeners.addListener(t.evntCB,t.callBack,!0,o),void Wt(Dt(e,d),t.service,o,a);if(!l&&c&&d&&d.length>0)"stnupdate"===t.evntCB&&(void 0===o.oServiceCall[t.service]||void 0===o.oServiceCall[t.service].status||"init"!==o.oServiceCall[t.service].status&&"complete"!==o.oServiceCall[t.service].status)&&(o.oServiceCall[t.service]={status:"init",station:null,data:null}),r._listeners.addListener(t.evntCB,t.callBack,!0,o),Wt(Dt(e,d),t.service,o);else if(l&&"init"===l.status);else if(l&&"complete"===l.status&&c!==l.station)r._listeners.addListener(t.evntCB,t.callBack,!0,o),Wt(Dt(e,d),t.service,o);else if(l&&"complete"===l.status&&c===l.station){for(n in l.data)l.data.hasOwnProperty(n)&&he({data:e,param:n,val:l.data[n]});if(Ke&&Ke[o.id]&&Ke[o.id][t.service]?ht(e,Ke[o.id][t.service]):ht(e,s),"true"===he({data:e,param:"nol_disabled"}))return;e.serviceFlag[t.service].need&&(he({data:e,param:"nol_davState",val:"1"}),e.serviceFlag[t.service].need=!1,Ht(he({data:e,param:"nol_queueTime"}),e))}else r._listeners.fireEvent(t.evntCB,t),S.getInstance().processSetTimeout((function(){ct(e,t)}),1e3)}function ut(e,t,a,n,r){var i=ie.getInstance(),o=We.getInstance(),s=ze.getInstance(),l=null,d=Math.round(h()/1e3);try{if(e)o.isEnabled(e)&&(l=s.inferEvent(t.currEvtType,e,t._param1,d,t._param3))&&(l.event!==s.events.play&&i.state.set(e,l),o.preProcess(e,l)),t.currEvtType&&("5"===t.currEvtType.toString()&&"6"===e.get("nolPriv_prevEvent")&&"st,a"===e.get("nol_c3")&&"false"===e.get("nol_disabled")&&"dcrvideo"===e.get("nol_product")&&"streamduration"===e.get("nol_cadence")&&(Ye[a.timeStamp]=Mt(e,{type:18,msg:"Event 6 -> 5 detected in ad."},!0,!0)),e.set("nolPriv_prevEvent",t.currEvtType.toString().toLowerCase()),e.set("nolPriv_prevEventState",t.eventState?t.eventState.toString().toLowerCase():"")),(""!==i.cms.parse(r.nol_adobeId,e,{metadata:t._param1,defaultKey:"nol_adobeId",silent:!0})||""!==i.cms.parse(r.nol_adobeSessionId,e,{metadata:t._param1,defaultKey:"nol_adobeSessionId",silent:!0})||n.isAdobe)&&(n.disablePauseTimeout(),n.isAdobe=!0)}catch(e){pe()._listeners.fireEvent("error",{type:"error",msg:"Error in ggpmPreProc(). Error preprocessing event - "+e.message})}return{inferredEvent:l,timestamp:d}}function pt(e,t){var a=pe(),n=We.getInstance(),r=ze.getInstance(),i=ie.getInstance();try{e&&t.inferredEvent&&(t.inferredEvent.event===r.events.play&&i.state.set(e,t.inferredEvent),n.postProcess(e,t.inferredEvent))}catch(e){a._listeners.fireEvent("error",{type:"error",msg:"Error in ggpmPostProc(). Error postprocessing event - "+e.message})}}function ft(e,t,a){var n,r,i,o,s=pe();return e.staticIFrameFlag||(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t,' event - enableStaticInIframe flag not set to "true" in config.')}),n=!0),s.browser.isWithinIFrame()||(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t," event - DCR Static implementation is not within an iframe.")}),r=!0),s.availModules.PLDCR&&s.availModules.PLDCR.dcrTimer?void 0===s.availModules.PLDCR.dcrTimer.isActive&&"stoptimer"===t&&(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t,' event - Timer not activated, please call ggPM event "starttimer" before calling "').concat(t,'".')}),i=!0):(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t,' event - Timer not instantiated, please call ggPM event "staticstart" before calling "').concat(t,'".')}),i=!0),-1===["focus","touchstart","blur"].indexOf(a)&&(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t," event - Invalid event type: ").concat(a,".")}),o=!0),n||r||i||o}function mt(e,t,a){var n=pe(),r=F().GLCFG.availModules.PLDCR,i=ie.getInstance(),o=We.getInstance(),s=n.availModules.PLDPR.product,l=j(),d=he({data:e,param:"nol_playerId"});if(d===t.id)if(t.evtInfo&&void 0!==t.evtInfo.eventType&&null!==t.evtInfo.eventType&&""!==t.evtInfo.eventType&&(!t.evtInfo.hasOwnProperty("param1")||null!==t.evtInfo.param1&&void 0!==t.evtInfo.param1)){var c,u,p,m,v,g,_,y,P,b,O,L,k,T=t.evtInfo,C=T.param1,E=T.param3?T.param3:C.hasOwnProperty("param3")?C.param3:C,w=T.param2||"",I=x(he({data:e,param:"nolPriv_id3Count"}),"num"),D=he({data:e,param:"nol_enableFilterMap"}),M={filters:{onId3PcCidChanged:!1,onId3FdCidChanged:!1},count:0,filterType:"old"},R=i.getEventsFilter(e),A=he({data:e,param:"nol_prod"}),N={},V=T.eventType.toString(),B=he({data:e,param:"nolPriv_serverTimeOffset"}),q=G()[d]||{},Q=q.nol_vidtype?q.nol_vidtype.clientField:"nol_vidtype",X=q.nol_tagSrc?q.nol_tagSrc.clientField:"nol_tagSrc",z=q.nol_ac?q.nol_ac.clientField:"nol_ac",W=q.nol_linearAdLoadFlag?q.nol_linearAdLoadFlag.clientField:"nol_linearAdLoadFlag",J=E[Q]?E[Q].toString().toLowerCase():E.type?E.type.toString().toLowerCase():"",K="nol_assetid",Y=i.findPlayer(e),$=he({data:e,param:"nol_cadence"}),Z={};Y.resetSession=Y.resetSession||!1,"object"===f(E)&&Object.prototype.hasOwnProperty.call(E,"type")&&""===E.type&&t.timeStamp&&!Ye[t.timeStamp]&&(n._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Type param is empty"}),Ye[t.timeStamp]=Mt(e,{type:17,msg:"Type param is empty in ggPM"},!0,!0)),J&&t.timeStamp&&!Ye[t.timeStamp]&&-1==["static","content","ad","preroll","postroll","midroll"].indexOf(J.toLowerCase())&&(n._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Invalid content type param"}),Ye[t.timeStamp]=Mt(e,{type:17,msg:"Invalid content type param in ggPM"},!0,!0));var ee={onTick:function(t){!e.isProductOf(["mtvr","id3"])&&a&&a.tickViewability&&"function"==typeof a.tickViewability&&a.tickViewability(e,t)},onCalcStart:function(t,n){e.isProductOf(["mtvr","id3"])&&a&&a.tickViewability&&"function"==typeof a.tickViewability?a.tickViewability(e,t,n):n&&n()},onPingFired:function(e){a&&a.resetViewability&&a.resetViewability(e),e.isProductOf(["mtvr","id3"])&&a&&a.tickViewability&&"function"==typeof a.tickViewability&&a.tickViewability(e,e.get("nolPriv_currPos"))}};V=V.toLowerCase();var te=ut(e,{currEvtType:V,_param1:C,eventState:w,_param3:E},t,Y,q),ae=he({data:e,param:"nol_linearAdLoadFlag",vidType:e._currVidType});"object"===f(t.evtInfo.param1)&&t.evtInfo.param1.adModel&&-1==["0","1","2"].indexOf(t.evtInfo.param1.adModel)&&(["0","1","2"].indexOf(ae)>-1?t.evtInfo.param1.adModel=ae:t.evtInfo.param1.adModel=he({data:e,param:"nol_linearAdLoadFlag"})),V="3"===V.toLowerCase()?"15":V.toLowerCase();var ne=Et(t),re="14"===V||"staticstart"===V;switch(V){case"3":case"14":case"15":case"loadmetadata":case"staticstart":case"pauseloadmeta":if("object"===f(t.evtInfo.param1)&&-1==["0","1","2"].indexOf(t.evtInfo.param1.adModel)&&(t.evtInfo.param1.adModel=he({data:e,param:"nol_linearAdLoadFlag"})),("14"===V||"staticstart"===V)&&"dcrstatic"!==he({data:e,param:"nol_product"}))return;if("14"!==V&&"staticstart"!==V&&"dcrstatic"===he({data:e,param:"nol_product"}))return;if("pauseloadmeta"===V&&e.isProductOf("vrivideo"))return;"14"!==V&&"staticstart"!==V||"dcrstatic"!==he({data:e,param:"nol_product"})||!Y.staticIFrameFlag||n.browser.isWithinIFrame()||t.timeStamp&&!Ye[t.timeStamp]&&(n._listeners.fireEvent("error",{type:"error",msg:"DCR Static not in iFrame, but enableStaticInIframe is set to true in config"}),Ye[t.timeStamp]=Mt(e,{type:17,msg:"DCR Static not in iFrame, but enableStaticInIframe is set to true in config"},!0,!0));var oe=","+he({data:e,param:"nol_contentType"}),se=e._currVidType;he({data:e,param:"nolPriv_prevEvent"}),he({data:e,param:"nol_currPos"});var le=J&&-1!==oe.indexOf(","+J.toLowerCase())?"content":"dcrstatic"===he({data:e,param:"nol_product"})?"static":"ad";if("ad"===he({data:e,param:"nol_ac"})&&he({data:e,param:"nol_segmentTimeSpent",vidType:"ad"})>0&&"streamduration"===$&&Pt(e,ee.onPingFired),e._currVidType=le,(se!==e._currVidType||e.get("nolPriv_forcedContent"))&&(a&&a.resetViewability(e),e.set("nolPriv_forcedContent",!1)),s.dtvr&&("15"===V||"loadmetadata"===V)&&e.isProductOf(["mtvr","id3"])&&"content"===e._currVidType){s.dtvr.handleGgpm(e,ne,a);break}"ad"===se&&"content"===e._currVidType&&e.isProductOf("dcrvideo")&&"interval"===e.get("nol_cadence")&&e.set("nolPriv_currPos","");var de=null,ce=null,ue=String(i.cms.parse(q.nol_assetid,e,{metadata:E,defaultKey:"nol_assetid",silent:!0}));re&&String(e._currAssetid)!==ue&&(Pt(e,ee.onPingFired),he({data:e,param:K,val:-1}),yt({data:e,resetStatic:!0}),Y.static.started&&(r.dcrTimer.reset(),e.set("nolPriv_currPos","0")));var fe=!0===e.get("nol_onCompleteFired");if(!0===he({data:e,param:"nol_onCompleteFired"})?("content"!==e._currVidType&&"static"!==e._currVidType||("content"===e._currVidType.toLowerCase()&&l[d].hasOwnProperty("forceStreamRegen")&&!0===l[d].forceStreamRegen&&it(e),he({data:e,param:K,val:-1}),"content"===e._currVidType?(de=i.state.clone(e),ce=o.clone(e),yt({data:e,savedVals:["nol_nielsenAdSupportFlg"],savedReplayParams:Z})):yt({data:e,resetStatic:!0})),he({data:e,param:"nol_onCompleteFired",val:!1})):"14"!==V&&"staticstart"!==V||"stream"!==he({data:e,param:"nol_cadence"})||(he({data:e,param:K,val:-1}),yt({data:e})),"ad"===e._currVidType&&e._dataArrObj[e._currVidType].hasOwnProperty(e._currAssetid)){var me=At(he({data:e,param:"nol_segmentLength"}));he({data:e,param:"nol_minutes",val:me}),he({data:e,param:K,val:-1}),he({data:e,param:Q,val:J}),"1"!==he({data:e,param:"nol_nielsenAdSupportFlg",vidType:"content"})&&he({data:e,param:"nol_nielsenAdSupportFlg",val:"1",vidType:"content"})}if(e._currAssetid=ue&&"daypart"===he({data:e,param:"nol_cadence"})||"stream"!==he({data:e,param:"nol_cadence"})&&"dcrstatic"===he({data:e,param:"nol_product"})?ue:e._currAssetid,E.nol_ac=e._currVidType,x(he({data:e,param:"nol_serverTime"}),"num")+86400<Math.round(h()/1e3)+B)return Pt(e,ee.onPingFired),void lt(t,he({data:e,param:"nol_playerId"}));for(O=0,L=D.length;O<L;O+=1)c=q[D[O]]?q[D[O]].clientField:D[O],N[D[O]]=String(E[c]||"");u=ue||he({data:e,param:"nolPriv_assetid"}),"15"!==V&&"loadmetadata"!==V||"id3"!==he({data:e,param:"nol_product"})||!he({data:e,param:"nol_id3Data"})||Rt(e,null,ee&&ee.onPingFired?ee.onPingFired:null);var ve=u!==he({data:e,param:K})||e&&e._dataArrObj&&e._dataArrObj.content&&"object"===f(e._dataArrObj.content)&&!e._dataArrObj.content[0];if(ht(e,R.onCmsDetected,N),"false"!==N.nol_disabled||!E)return void("cms"!==e._currTagSrc&&(ve?(st(e,"loadMetadata",E,a),he({data:e,param:"nol_disabled",val:"true"})):i.updateMetadata(e,E,q,{inferred:!0}),"15"!==V&&"loadmetadata"!==V||"id3"!==he({data:e,param:X,vidType:"content"})&&!e.isProductOf("mtvr")||!0===he({data:e,param:"nolPriv_dtvrHybrid",vidType:"content"})||he({data:e,param:"nolPriv_dtvrHybrid",val:!0,vidType:"content"})));if("static"===e._currVidType&&"dcrstatic"===he({data:e,param:"nol_product"})&&n._listeners.fireEvent("updateCmbStaticPage",{evtInfo:T,plid:d}),u!==he({data:e,param:K})){"ad"!==he({data:e,param:"nol_ac"})&&Pt(e,ee.onPingFired,void 0,"onAssetIdChange");var ge=he({data:e,param:K});if(st(e,"loadMetadata",E,a),ge&&!fe&&"content"===e._currVidType.toLowerCase()&&e.isProductOf("dcrvideo")&&"impression"===e.get("nol_cadence")&&(Y.resetSession=!0),Object.keys(Z).length>0){for(var _e in Z)Z.hasOwnProperty(_e)&&""!==Z[_e]&&he({data:e,param:_e,val:Z[_e]});Z={}}if(he({data:e,param:"nolPriv_assetid",val:he({data:e,param:K})}),"15"!==V&&"loadmetadata"!==V||"id3"!==he({data:e,param:X,vidType:"content"})&&!e.isProductOf("mtvr")||!0===he({data:e,param:"nolPriv_dtvrHybrid",vidType:"content"})||he({data:e,param:"nolPriv_dtvrHybrid",val:!0,vidType:"content"}),ht(e,R.onAssetIdChanged),"true"===he({data:e,param:"nol_disabled"}))return;if("drm"===he({data:e,param:"nol_product"}))e.serviceFlag.stn.need=!0;else if(e.serviceFlag.stn.need=!1,"true"===he({data:e,param:"nol_disabled"}))return;if(ht(e,R.onComplete),de&&i.state.bind(e,de),ce&&o.bind(e,ce),"true"===he({data:e,param:"nol_disabled"}))return}"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&"impression"!==he({data:e,param:"nol_cadence"})&&e.set("nolPriv_adCounted",!1),e.isProductOf("vrivideo")&&"impression"===e.get("nol_cadence")&&(e.set("nol_vriEvent","start"),e.set("nol_startPos","")),he({data:e,param:"nol_pingStartTimeUTC",val:Math.round(h()/1e3)}),-1!==A.indexOf("iag")&&qt(e,e._currVidType),("ad"===e._currVidType&&!e.isProductOf(["dcrvideo","vrivideo"])||"stream"===he({data:e,param:"nol_cadence"}))&&(he({data:e,param:"nol_pingCount",val:0}),he({data:e,param:"nolPriv_sendData",val:!0}),he({data:e,param:"nol_davState",val:"0"}),e.serviceFlag.stn.need||"content"===e._currVidType||"nol_cmsoffset"!==he({data:e,param:"nol_timer"})&&"nol_pageoffset"!==he({data:e,param:"nol_timer"})||Ht(0,e,ee)),"14"!==V&&"staticstart"!==V||"dcrstatic"!==he({data:e,param:"nol_product"})||!0===Y.static.started||(r.start(!0),Y.static.started=!0);break;case"5":case"play":if("mtvr"===he({data:e,param:"nol_product"})){if(s.dtvr){s.dtvr.handleGgpm(e,ne,a);break}if(E[P=q.nol_channelName?q.nol_channelName.clientField:"nol_channelName"]&&E[P].length>0)for(k in E)E.hasOwnProperty(k)&&he({data:e,param:k,val:E[k]})}else e.isProductOf(["dcrvideo","vrivideo"])&&1==e.get("nolPriv_adStop")&&(e.set("nolPriv_adStop",!1),"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&"interval"===e.get("nol_cadence")&&e.set("nolPriv_currPos","","content"),e._currVidType="content",N={nol_vidtype:he({data:e,param:Q,vidType:e._currVidType}),nol_tagSrc:he({data:e,param:X,vidType:e._currVidType}),nol_linearAdLoadFlag:he({data:e,param:W,vidType:e._currVidType}),nol_ac:he({data:e,param:z,vidType:e._currVidType})},ht(e,R.onCmsDetected,N));break;case"6":case"pause":dt(e,{pause:!0},ee);break;case"7":case"stop":dt(e,{stop:!0},ee),"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&e.set("nolPriv_adStop",!0);break;case"flush":if("interval"===($=e.get("nol_cadence"))||"streamduration"===$||"episode"===$){if(e.isProductOf("dcrvideo")){dt(e,{flush:!0,save:!0},ee);break}if(e.isProductOf(["mtvr","id3"])){dt(e,{blur:!0},ee);break}var ye=r;e.isProductOf("dcrstatic")&&ye&&(dt(e,{flush:!0,save:!0},ee),ye.dcrTimer&&ye.dcrTimer.reset(),e.set("nolPriv_currPos","0"),ye.focusTimer.enableTimeout=!!ye.focusTimer.intervalID,ye.focusTimer.enableTimeout&&(ye.focusTimer.timeoutStartTime=Date.now()))}break;case"changecontext":C&&["content","ad"].indexOf(C)>-1&&(e._currVidType=C);break;case"updateott":if(dt(e,null,ee),C&&C.hasOwnProperty("ottStatus")&&C.ottStatus.length>0){if(C.hasOwnProperty("kGCKMetadataNlsKeyOptout")&&C.hasOwnProperty("kGCKMetadataNlsKeyDeviceID")){var Pe=C.kGCKMetadataNlsKeyOptout.toString().toLowerCase();he({data:e,param:"nol_userSessionId",val:C.kGCKMetadataNlsKeyDeviceID,vidType:"content"}),he({data:e,param:"nol_useroptout",val:"1"===Pe||"true"===Pe?"true":"false",vidType:"content"}),-1===[1,"1","true",0,"0","false"].indexOf(Pe)&&n._listeners.fireEvent("warn",{type:"warn",msg:"Warning: Invalid kGCKMetadataNlsKeyOptout value."})}for(var K in C)C.hasOwnProperty(K)&&(he({data:e,param:K,val:C[K],vidType:"content"}),Y.ottStatusObj[K]=C[K]);R.onOTTDetected&&ht(e,R.onOTTDetected)}break;case"57":case"56":case"end":case"oncomplete":case"staticend":if(("56"===V||"staticend"===V)&&"dcrstatic"!==he({data:e,param:"nol_product"}))return;if("56"!==V&&"staticend"!==V&&"dcrstatic"===he({data:e,param:"nol_product"}))return;if(e.isProductOf("vrivideo")&&("57"===V||"end"===V)&&("sessionReset"===w||"modcadence"!=e.get("nol_cadence")))return;if(s.dtvr&&("57"===V||"end"===V||"oncomplete"===V)&&e.isProductOf(["mtvr","id3"])){s.dtvr.handleGgpm(e,ne,a);break}if("ad"===e._currVidType&&("streamduration"===he({data:e,param:"nol_cadence"})?Rt(e,null,ee.onPingFired):e.isProductOf(["dcrvideo"])&&"interval"===he({data:e,param:"nol_cadence"})&&(""===he({data:e,param:"nol_dataDate",vidType:"content"})&&""!==he({data:e,param:"nol_dataDate"})&&(he({data:e,param:"nol_dataDate",val:he({data:e,param:"nol_dataDate"}),vidType:"content"}),he({data:e,param:"nol_hourCode",val:he({data:e,param:"nol_hourCode"}),vidType:"content"}),he({data:e,param:"nol_dayId",val:he({data:e,param:"nol_dayId"}),vidType:"content"})),e._currVidType="content",R.onEndDetected&&ht(e,R.onEndDetected),Rt(e,null,ee.onPingFired))),e.isProductOf("dcrvideo")&&e.set("nolPriv_currPos",""),e.isProductOf("vrivideo")&&"modcadence"===e.get("nol_cadence")){var be=e.get("nol_length")||i.cms.parse(q.nol_length,e,{defaultKey:"nol_length",silent:!0});if("NaN"===parseInt(be).toString())return;if(!(parseInt(e.get("nol_currPos"))>=parseInt(e.get("nol_length"))))return;e.set("nol_vriEvent","ended")}"static"!==he({data:e,param:"nol_ac"})&&(e._currVidType="content"),R.onEndDetected&&ht(e,R.onEndDetected),he({data:e,param:"nol_forceFireOnClose_content",val:"1"}),"false"!==he({data:e,param:"nol_disabled"})&&"id3"!==he({data:e,param:"nol_product"})||("static"===he({data:e,param:"nol_ac"})&&n._listeners.fireEvent("removeCmbAssetId",T),Pt(e,ee.onPingFired)),he({data:e,param:"nol_onCompleteFired",val:!0}),l[d].forceStreamRegen=!0,"56"!=V&&"staticend"!=V||"dcrstatic"!==he({data:e,param:"nol_product"})||(r.stop(V),Y.static.started=!1),"sessionReset"!==w&&Y.disablePauseTimeout();break;case"48":case"setpageduration":case"pageduration":case"staticposition":if("true"===he({data:e,param:"nol_disabled"})||!C||"nol_pageoffset"!==he({data:e,param:"nol_timer"}))return;var Se;"1"===he({data:e,param:"nol_onPaginateFired_static"})&&(he({data:e,param:"nol_onPaginateFired",val:"0",vidType:"static"}),"impression"!==he({data:e,param:"nol_cadence"})&&Nt(e,{vidType:"static"})),x(he({data:e,param:"nol_highWM"}),"num")<x(C,"num")&&he({data:e,param:"nol_highWM",val:C}),Ht(C,e,ee),he({data:e,param:"nol_davState",val:"1"}),Y&&Y.sivt&&Y.sivt.initialized&&Y.sivt.addSIVTTag&&Y.sivt.initialized()&&"impression"===e.get("nol_cadence")&&Y.sivt.dcrStaticInit&&!Y.sivt.dcrStaticInit()&&Y.sivt.addSIVTTag(e),Se=e.get("nol_cadenceOverrideEnabled")&&e.get("nol_cadenceOverride")?e.get("nol_cadenceOverride"):!(!r.cadenceOverrideEnabled||!r.cadenceOverride)&&r.cadenceOverride;var Oe=60*parseInt(e.get("nol_segmentLength")||0);"dcrstatic"===e.get("nol_product")&&Se&&Se>0&&Se<=C&&(!Oe||Se<Oe)&&(dt(e,{flush:!0,save:!0},ee),r.dcrTimer.reset(),e.set("nolPriv_currPos","0"));break;case"49":case"setplayheadposition":case"playheadposition":if(C>-1){if(!0===he({data:e,param:"nol_onCompleteFired"})&&n._listeners.fireEvent("flushPauseEventQueue"),"number"!=typeof C){if("string"!=typeof C)return;C=x(C,"num")}else C=Math.floor(C);if(e.isProductOf("dcrvideo")&&he({data:e,param:"nol_isLive",val:(C>86400).toString()}),"true"===he({data:e,param:"nol_disabled"})||!C||"nol_cmsoffset"!==he({data:e,param:"nol_timer"})||"ad"===e._currVidType&&e.isProductOf(["dcrvideo","vrivideo"])&&"impression"===he({data:e,param:"nol_cadence"}))return;if(Y&&!0===Y.resetSession&&(Y.resetSession=!1,l[d].forceStreamRegen=!0,it(e)),e.isProductOf("vrivideo")){var Le=Math.floor(C);"impression"===e.get("nol_cadence")&&1===Le&&Le<e.get("nolPriv_prevPos")&&(e.set("nol_pingCount",0),e.set("nol_currPos","")),"modcadence"===e.get("nol_cadence")&&e.set("nol_vriEvent","loop")}if(x(he({data:e,param:"nol_highWM"}),"num")<C&&he({data:e,param:"nol_highWM",val:C}),Y&&Y._pauseTimeoutEnabled&&Y.inBackground&&!Y.phDeltaCheck){var ke=H(),Te=ke-Y.tsObj.phTimestamp;U(Y,"Event 49 PTO calculations:"),U(Y,"plid=".concat(Y.id," - Delta: ").concat(Te," | Pause Time: ").concat(Y.pauseObj.pauseTime," - (").concat(ke,")")),U(Y,"plid=".concat(Y.id," - New Pause Time = ").concat(Te," + ").concat(Y.pauseObj.pauseTime," = ").concat(Y.pauseObj.pauseTime+Te," - (").concat(ke,")")),Y.pauseObj.pauseTime=Y.pauseObj.pauseTime+Te,Y&&Y.hasPauseTimeoutExpired(e),Y.phDeltaCheck=!0}if(e.serviceFlag.stn.need?(he({data:e,param:"nol_queueTime",val:C}),ct(e,{service:"stn",key:he({data:e,param:"nol_assetid"}),url:he({data:e,param:"nol_stationURL"}),nol_playerId:he({data:e,param:"nol_playerId"})})):Ht(C,e,ee),he({data:e,param:"nol_davState",val:"1"}),Y&&Y.sivt&&Y.sivt.initialized&&Y.sivt.addSIVTTag&&Y.sivt.initialized()&&"impression"===e.get("nol_cadence")&&Y.sivt.dcrVideoInit&&!Y.sivt.dcrVideoInit()&&Y.sivt.addSIVTTag(e),"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&"impression"!==he({data:e,param:"nol_cadence"})&&!1===e.get("nolPriv_adCounted"))he({data:e,param:"nol_timeSpentViewing"})[e._currVidType].nol_count++,e.set("nolPriv_adCounted",!0);"content"!==e._currVidType||Y.isAdobe||Y._pauseTimeoutEnabled||Y.enablePauseTimeout()}else t.timeStamp&&!Ye[t.timeStamp]&&(Ye[t.timeStamp]=Mt(e,{type:15,msg:"A negative playhead position was sent and will be ignored."},void 0,!0),Ye[t.timeStamp]&&n._listeners.fireEvent("warn",{type:"warn",msg:"Warning: A negative playhead position was sent and will be ignored."}));break;case"55":case"sendid3":if("nol_cmsoffset"===e.get("nol_timer")||"nol_pageoffset"===e.get("nol_timer"))return;if(s.dtvr){s.dtvr.handleGgpm(e,ne,a);break}var Ce=!1,Ee=!1;if(("object"===f(C)&&Object.keys(C).length>0||"string"==typeof C&&C.length>0)&&((!0===he({data:e,param:"nol_onCompleteFired"})&&Y&&Y.getPauseQueueCount&&Y.getPauseQueueCount()>0||!0===he({data:e,param:"nol_onCompleteFired"})&&Y&&!Y.getPauseQueueCount)&&n._listeners.fireEvent("flushPauseEventQueue"),"object"===f(C)))for(L=0;L<C.length;L+=1)if(C[L].key&&"PRIV"===C[L].key){C=C[L].info;break}if(249!==(g=C.toString()).length&&t.timeStamp&&!Ye[t.timeStamp]){Ye[t.timeStamp]=Mt(e,{type:17,msg:"ID3 tag length is not 249. ID3 Tag: ".concat(g)},!0,!0);var we=S.getInstance();we&&we.logWarn("Warning: ID3 tag length is not 249.")}if(C={},(v=g.split("/")).length<x(et.nol_breakout,"num"))return;for(k in et)et.hasOwnProperty(k)&&(C[k]=v[et[k]],"nol_breakout"===k&&(C[k]=v[x(et[k],"num")].substr(0,2)),N[k]=C[k]);if(!C||he({data:e,param:"nol_tsvBreakoutMap"})&&-1===he({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(C.nol_breakout)||-1===C.nol_nWebAddress.indexOf("nielsen.com")||C.nol_fdcid===he({data:e,param:"nol_cidNull"})&&C.nol_pccid===he({data:e,param:"nol_cidNull"}))return;for(e._currVidType="content",O=0,L=D.length;O<L;O+=1)c=q[D[O]]?q[D[O]].clientField:D[O],N[D[O]]=C[c]||he({data:e,param:D[O]});if(N.nol_vidtype="content",ht(e,R.onId3Detected,N),"false"!==N.nol_disabled||"nol_cmsoffset"===he({data:e,param:"nol_timer"}))return;if("daypart"===he({data:e,param:"nol_cadence"})){var Ie=he({data:e,param:"nol_assetid"})||e._currAssetid;!Ie&&C.nol_fdcid&&C.nol_fdcid!==he({data:e,param:"nol_cidNull"})?e._currAssetid=C.nol_fdcid:!e._currAssetid&&Ie&&(e._currAssetid=Ie)}C.nol_ac=e._currVidType,C.nol_assetid=he({data:e,param:"nol_assetid"})||e._currAssetid,I>0&&(-1!==he({data:e,param:"nol_product"}).indexOf("id3")||-1!==he({data:e,param:"nol_product"}).indexOf("mtvr"))&&(C.nol_pccid!==he({data:e,param:"nol_cidNull"})&&C.nol_pccid!==he({data:e,param:"nol_pccid"})||C.nol_fdcid!==he({data:e,param:"nol_cidNull"})&&C.nol_fdcid!==he({data:e,param:"nol_fdcid"}))&&Rt(e,null,ee.onPingFired,!0);var De=i.mtvr.pcChanged(e,C.nol_pccid),Me=i.mtvr.fdChanged(e,C.nol_fdcid);if(De&&(i.mtvr.isPCTag(e)||i.mtvr.isTransPing(e))&&(M.filters.onId3PcCidChanged=!0,M.count=M.count+1,a&&a.startViewability(e),(Me||i.mtvr.isNullFDCid(e))&&e.set("nol_id3Seq",0)),Me&&(i.mtvr.isFDTag(e)||i.mtvr.isTransPing(e))&&(M.filters.onId3FdCidChanged=!0,M.count=M.count+1,a&&a.startViewability(e),e.set("nol_id3Seq",0)),Me&&i.mtvr.isPCTag(e)&&(Ce=!0),""===e.get("nol_fdrtvod")||"0"===e.get("nol_fdrtvod")||!i.mtvr.isPCTag(e)&&!i.mtvr.isFDTag(e)||i.mtvr.isNullPCCid(e)||""===e.get("nol_pccid")||i.mtvr.isNullFDCid(e)||""===e.get("nol_fdcid")||!De||(Ee=!0,i.mtvr.isFDTag(e)&&R&&R.onId3FdCidChanged&&ht(e,R.onId3FdCidChanged)),M.count){if(st(e,"sendID3",C,a),!M.filters.onId3FdCidChanged&&he({data:e,param:"nol_fdcid"})!=he({data:e,param:"nol_cidNull"})||-1===he({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(C.nol_breakout)||(e.serviceFlag.tsv.need=!0),M.count>0)for(k in M.filters)if(M.filters[k]&&(ht(e,R[k]),"true"===he({data:e,param:"nol_disabled"})))return;if(R.onComplete&&(ht(e,R.onComplete),"true"===he({data:e,param:"nol_disabled"})))return}else for(k in C)C.hasOwnProperty(k)&&he({data:e,param:k,val:C[k]});if((Me&&i.mtvr.isFDTag(e)||De&&i.mtvr.isPCTag(e))&&e.isProductOf("mtvr")&&"impression"===e.get("nol_cadence")&&"false"===e.get("nol_disabled")){var Re=l[d].nolPriv_newMTVRStreamId;l[d].nolPriv_newMTVRStreamId=Re&&l[d].restEvtTimestamp==t.timeStamp?Re:n.generateGUID(),i.mtvr.resetTagSession(e,l[d].nolPriv_newMTVRStreamId),l[d].restEvtTimestamp=t.timeStamp,n._listeners.fireEvent("debug",{type:"debug",msg:e.get("nol_comment")+" new mtvr session is "+Re})}if((e.isProductOf("mtvr")||e.isProductOf("id3"))&&"false"===e.get("nol_disabled")&&l[d].restEvtTimestamp!=t.timeStamp){var Ae=l[d].nolPriv_newMTVRStreamId;Ae&&Ae!==e.get("nol_sessionId","content")&&i.mtvr.resetTagSession(e,Ae)}if(he({data:e,param:"nol_id3Raw",val:g}),(e.serviceFlag.tsv.need||Ce||Ee)&&-1!=="|mtvr|,|dprid3|,|id3|".indexOf("|"+he({data:e,param:"nol_product"})+"|")&&"false"===e.get("nol_disabled")&&(["true","1"].indexOf(e.get("nol_rtvodEnabled").toString().toLowerCase())>-1&&e.set("nol_rtvod",""),y=Ee?he({data:e,param:"nol_pccid"}):Ce||!0!==M.filters.onId3PcCidChanged||i.mtvr.isNullPCCid(e)?he({data:e,param:"nol_fdcid"}):he({data:e,param:"nol_pccid"}),e.get("nol_tsvURL")&&ct(e,{service:"tsv",key:y,url:he({data:e,param:"nol_tsvURL"})})),(e.isProductOf("id3")||e.isProductOf("mtvr")&&"interval"===e.get("nol_cadence")&&"false"===e.get("nol_disabled"))&&C.nol_watermark&&String(C.nol_watermark).length>0&&(p=he({data:e,param:"nol_id3Data"}),m=Math.round(h()/1e3+B),b=he({data:e,param:"nol_id3Seq"})||0,p?he({data:e,param:"nol_id3Data",val:p=p+"|"+m+","+he({data:e,param:"nol_id3Raw"})}):(he({data:e,param:"nol_id3Data",val:b+":"+he({data:e,param:"nol_clocksrc"})+":"+he({data:e,param:"nol_tsvFlag"})+":"+m+","+he({data:e,param:"nol_id3Raw"})}),he({data:e,param:"nol_id3Seq",val:x(b,"num")+1,vidType:"content"})),e.isProductOf("id3")))return I>0&&Rt(e,{returnLength:!0},ee.onPingFired),he({data:e,param:"nolPriv_id3Count",val:I+=1}),void he({data:e,param:"nol_davState",val:"1"});if(he({data:e,param:"nolPriv_id3Count",val:I+=1}),_=he({data:e,param:he({data:e,param:"nol_timer"})})||he({data:e,param:"nol_fdoffset"}),"daypart"===he({data:e,param:"nol_cadence"})&&(_=x(_,"num"),_+="nol_pcoffset"==he({data:e,param:"nol_timer"})?x(he({data:e,param:"nol_pcTimeCode"}),"num"):x(he({data:e,param:"nol_fdTimeCode"}),"num")),e.serviceFlag.tsv.need)he({data:e,param:"nol_queueTime",val:_});else{if("true"===he({data:e,param:"nol_disabled"}))return;Ht(_,e,ee),he({data:e,param:"nol_davState",val:"1"})}(Me&&i.mtvr.isFDTag(e)||De&&i.mtvr.isPCTag(e))&&(i.mtvr.isPCTag(e)&&"false"===e.get("nol_disabled")?a&&a.tickViewability(e,C.nol_pcoffset):i.mtvr.isFDTag(e)&&"false"===e.get("nol_disabled")&&a&&a.tickViewability(e,C.nol_fdoffset));break;case"60":case"mute":case"buffer":case"buttonevent":break;case"61":case"volume":a&&a.viewability&&a.viewability.setVolume(C);break;case"30":case"onpaginate":"dcrstatic"===he({data:e,param:"nol_product"})&&R.onPaginateDetected&&"stream"!==he({data:e,param:"nol_cadence"})&&ht(e,R.onPaginateDetected),he({data:e,param:"nol_onPaginateFired",val:"1",vidType:"static"});break;case"35":case"updatemetadata":if(e.isProductOf(["dcrvideo","vrivideo"])){i.updateMetadata(e,E,q,t.evtInfo);var Fe=he({data:e,param:"nol_adLoadType",vidType:"content"});""!==Fe&&null!=Fe&&ht(e,R.onAdLoadFlag)}break;case"starttimer":if(e.isProductOf("dcrstatic")&&"impression"===e.get("nol_cadence")){if(ft(Y,V,C="string"==typeof C?C.toLowerCase():""))break;var xe="focus"===C,Ge="touchstart"===C;n.availModules.PLDCR.dcrTimer.isActive||(xe&&(n.availModules.PLDCR.dcrTimer.play(n.availModules.PLDCR._reset),n.availModules.PLDCR._reset=!1),Ge&&n.availModules.PLDCR.safeFocus({type:C}))}break;case"stoptimer":if(e.isProductOf("dcrstatic")&&"interval"===e.get("nol_cadence")){if(ft(Y,V,C="string"==typeof C?C.toLowerCase():""))break;n.availModules.PLDCR.dcrTimer.isActive&&"blur"===C&&(dt(e,{flush:!0,save:!0},ee),n.availModules.PLDCR.dcrTimer.reset(),e.set("nolPriv_currPos","0"),n.availModules.PLDCR.dcrTimer.pause(),n.availModules.PLDCR.safeFocusOn&&(n.availModules.PLDCR.safeFocusOn=!1))}}pt(e,te)}else t.timeStamp&&!Ye[t.timeStamp]&&"true"!==e.get("nol_disabled")&&(t.evtInfo&&!t.evtInfo.eventType&&(n._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Invalid event type param"}),Ye[t.timeStamp]=Mt(e,{type:17,msg:"Missing event type param in ggPM"},!0,!0)),!t.evtInfo||null!==t.evtInfo.param1&&void 0!==t.evtInfo.param1||(n._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Invalid Param1 passed"}),Ye[t.timeStamp]=Mt(e,{type:17,msg:"Missing param1 detected on event "+t.evtInfo.eventType},!0,!0)))}var vt={};function gt(e,t,a){var n=!1,r=a.toString().toLowerCase().indexOf(t.toString().toLowerCase());return("-"===e&&-1===r||"+"===e&&(a===t||-1!==r&&a&&t)||"--"===e&&-1===t.toString().toLowerCase().indexOf(a.toString().toLowerCase())||"++"===e&&-1!==t.toString().toLowerCase().indexOf(a.toString().toLowerCase()))&&(n=!0),n}function ht(e,t,a,n){var r,i,o,s,l,d,c,u,p,f,m,v=t||e.get("nol_finalFilter",n),g=a||{};if(v&&void 0!==v)for(r=0,i=v.length;r<i;r++){if((u=v[r]).tagVar.length)for(o=0,s=u.tagVar.length;o<s&&(f=e.get(u.tagVar[o].name,n));o++);else f=e.get(u.tagVar.name,n);if(f&&u.tagVar.value===f){for(o=0,s=u.cond.length;o<s;o++){if(c=g[u.cond[o]]||e.get(u.cond[o],n),d=0===u.is.value.indexOf("nol_")&&e.get(u.is.value,n)?e.get(u.is.value,n):u.is.value,void 0===c||void 0===d||!gt(u.is.type,c,d)){p=!1;break}p=!0}if(void 0!==p&&void 0!==(m=p?u.then:u.else))for(l in m)m.hasOwnProperty(l)&&(void 0!==g.nol_vidtype?g[l]=m[l]:e.set(l,m[l],n))}}}function _t(e,t){var a,n,r=g(),i=e.split("||"),o=i[0]||e;if(r)for(a=0,n=i.length;a<n;a++)void 0!==r["on"+(o=i[a])]&&(r.addEventListener?r.addEventListener(o,t,!1):r.attachEvent&&r.attachEvent("on"+o,t))}function yt(e,t){var a;try{if(!e||!e.hasOwnProperty("data"))return;if(e.hasOwnProperty("savedVals")&&e.hasOwnProperty("savedReplayParams"))if(Array.isArray(e.savedVals))for(a in e.savedVals)e.savedVals.hasOwnProperty(a)&&(e.savedReplayParams[e.savedVals[a]]=he({data:e.data,param:e.savedVals[a]}));else"string"==typeof e.savedVals&&(e.savedReplayParams[e.savedVals]=he({data:e.data,param:e.savedVals}));e.hasOwnProperty("resetStatic")&&!0===e.resetStatic&&(e.data._dataArrObj.static={}),e.data._dataArrObj.ad={},e.data._dataArrObj.content={},e.data._dataArrObj.count={content:0,ad:0,static:0},e.data._currAssetid="0"}catch(e){pe()._listeners.fireEvent("error",{type:"error",msg:"Error in resetDataObj"+e})}}function Pt(e,t,a,n){n=n||"";"id3"===he({data:e,param:"nol_product"})&&he({data:e,param:"nol_id3Data"})?Rt(e,null,t||null,a):e.isProductOf("vrivideo")&&"ended"!==e.set("nol_vriEvent")||"true"!==he({data:e,param:"nol_disabled"})&&("1"===he({data:e,param:"nol_davState"})||"onbeforeunload"===n&&"1"===e.get("nol_davState","ad"))&&("onAssetIdChange"===n&&"1"===he({data:e,param:"nol_davty"})&&he({data:e,param:"nol_davty",val:"2"}),he({data:e,param:"nol_davState",val:"2"}),"daypart"===he({data:e,param:"nol_cadence"})?Rt(e,{save:!0},t||null,a):Rt(e,null,t||null,a),e.isProductOf(["mtvr","id3"])?he({data:e,param:"nolPriv_enableDtvr",val:"true"}):Vt(e),he({data:e,param:"nol_disabled",val:"true"}))}function bt(e,t,a){var n,r,i,o=ie.getInstance(),s=pe(),l=ze.getInstance(),d=We.getInstance(),c=a.id||a.getId?a.getId():"0",u=t[c].nol_tagMap.nol_url,p=0,f=u?u[e.nol_url]||e.nol_url||"":e.nol_url||"",m={nol_disabled:"true",nol_errorMessage:"none",nol_vidtype:"",nol_muteState:"0",nol_volumeLevel:"100",nol_clockSource:"D",nol_aggregate:"1",nol_pingCount:"0",nol_intrvlThrshld:"90",nol_id3IntrvlGp:"15",nolPriv_sendData:!0,nol_timer:"nol_fdoffset",nol_isLive:"false",nolPriv_errorSent:"",nolPriv_id3Count:0,nolPriv_cmsMap:{},nol_timeSpentViewing:{ad:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0},content:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0},static:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0}},nol_enableFilterMap:["nol_vidtype","nol_tagSrc","nol_linearAdLoadFlag","nol_ac"],nol_xorSeed:"N!3ls3nBL",nol_currSeg:"0",nol_minWonOverride:"0",nol_customExtension:["nol_legacyCustom"],nol_pingCreationTime:"0",nol_pingSendTime:"0",nol_clientUrl:"",nol_sendTime:"0",nol_pageURL:"",nol_referrerURL:"",nol_random:Math.round(1e9*Math.random()),nol_ottStatus:"0",nol_ottType:"none",nol_ottDevice:"NA",nol_ottDeviceName:"NA",nol_ottDeviceID:"NA",nol_ottDeviceManufacturer:"NA",nol_ottDeviceModel:"NA",nol_ottDeviceVersion:"NA",nol_onPaginateFired:"0",nol_forceFireOnClose:"0",nol_applyViewInc:"0",nol_viVersion:"",nol_omidsdkVersion:""},v=e;v.nol_playerId=c;var g=this,h={_dataArrObj:{ad:{},content:{},static:{},count:{content:0,static:0}},_settings:v,_currVidType:"ad",_currAssetid:"0",serviceFlag:{stn:{need:!1,callback:"nol_stnevt"},tsv:{need:!1,callback:"nol_tsvevt"}}};for(i in o.extendfData(h),this.name=h.get("nol_comment"),this.playerId=c,this.resetViewability=function(e,t){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()&&g.viewability.clear(e,t)},this.startViewability=function(e){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()&&"function"==typeof g.viewability.start&&g.viewability.start(e)},this.stopViewability=function(){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()&&"function"==typeof g.viewability.stop&&g.viewability.stop()},this.tickViewability=function(e,t,a){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()?g.viewability.tick(t,e,(function(){g.viewability.setData(e),a&&a(),s._listeners.fireEvent("debug",{type:"debug",msg:JSON.stringify(g.viewability.getData())})})):a&&a()},s._listeners.addListener("tick",(function(){if(!a.inBackground){if(a.pauseObj.eventPauseTime>=a.pauseObj.cmsPauseTime&&o.state&&o.state.status&&o.state.status.current(h)!==o.states.stopped&&o.state.status.current(h)!==o.states.paused&&d.isEnabled(h)){var e={event:l.events.pause,curPos:o.state.position.current(h),prevPos:null,timestamp:o.state.timeStamp.current(h)};o.state.set(h,e),d.preProcess(h,e),a.pauseObj.eventPauseTime=0}a&&a.hasPauseTimeoutExpired(h)}})),yt({data:h}),m)e.hasOwnProperty(i)?v[i]=e[i]:v[i]=t[c][i]||m[i];if(v.nol_customExtension&&f){for(n=0,r=v.nol_customExtension.length;n<r;n++)f=f.replace("|!["+v.nol_customExtension[n]+"]!|",t[c][v.nol_customExtension[n]]||"");v.nol_url=f}if(s.availModules.PLVBL&&h.get("nol_vizuURL")&&("interval"===h.get("nol_cadence")||"streamduration"===h.get("nol_cadence"))&&(this.viewability=new s.availModules.PLVBL(h,a)),"true"!==he({data:h,param:"nol_fireStop"})&&-1==="interval,episode,streamduration".indexOf(he({data:h,param:"nol_cadence"}))||_t("pagehide||beforeunload",(function(){he({data:h,param:"nol_forceFireOnClose_content",val:"1"});var e=o.getEventsFilter(h);e&&e.onEndDetected&&(ht(h,e.onEndDetected,null,"ad"),ht(h,e.onEndDetected,null,"content"),ht(h,e.onEndDetected,null,"static")),d.setNextTick(h,null,"content"),Pt(h,!1,!0,"onbeforeunload")})),this.eventListener=function(e){mt(h,e,g)},t[c].eventQueue.length>p)for(n=0;n<t[c].eventQueue.length;n++)t[c]&&t[c].eventQueue&&(t[c].eventQueue[n].timeStamp="queued"+n),mt(h,t[c].eventQueue[n]),p=n;s._listeners.addListener("sendError",(function(e){if(!e.target||c===e.target.id){var t=e.target.id+"_"+e.target.timeStamp;vt[t]||(s._listeners.fireEvent("error",{type:"error",msg:e.target.data?e.target.data.msg:""}),vt[t]=Mt(h,e.target.data,!0,!0))}}))}var St={"[":{end:"]",count:0},"{":{end:"}",count:0},"<":{end:/\.\d+,\d+\>/g,count:0}},Ot={regex:/\|\![\w\W]*?(\!\|)/g,length:2},Lt=new RegExp(/(.*?)(_content|_ad|_static)?$/i),kt=function(){};function Tt(e,t,a,n){var r="";return a&&a.clientField!==t&&!0!==n.end&&(r=ie.getInstance().cms.parse(a,e,n))?r:he({data:e,param:t,vidType:n?n.vidType:""})}function Ct(e,t){var a,n,r,i,o="";if(!e||!t)return e;for(i=t.length,n=0,r=e.length;n<r;n++)o+=0===(a=e.charCodeAt(n)^t.charCodeAt(n%i))?e.charAt(n):String.fromCharCode(a);return o}function Et(e){var t;try{if(null===e||"object"!==f(e)||"isActiveClone"in e)return e;for(var a in t=e instanceof Date?new e.constructor:e.constructor(),e)Object.prototype.hasOwnProperty.call(e,a)&&(e.isActiveClone=null,t[a]=Et(e[a]),delete e.isActiveClone);return t}catch(e){return!1}}function wt(e,t,a,n,r){var i,o;-1===a.indexOf("[")&&-1===a.indexOf("]")&&(!n.val||n.val.length<=0)?r||(Mt(e,{type:"100",msg:a+" missing -- "+he({data:e,param:"nol_comment"})}),n.state=!1,n.val=""):"<"===t||">"===t?(i=a.match(St["<"].end))?(o=i[0].match(/[\d]+/g),n.val=String(n.val).substr(o[0],o[1])):n.val=Ct(String(n.val),he({data:e,param:"nol_xorSeed"})):"("!==t&&")"!==t||(n.val=_e(n.val))}function It(e,t,a){var n,r,i,o,s,l,d,c,u,p,f,m,v,g,h=t.match(/[\[\{<\(]/g),_=he({data:e,param:"nol_xorSeed"})||"";h=h?h.reverse():[],r=t.match(/[\}\]\>\)]/g)||[],o={start:h.length?t.lastIndexOf(String(h[0])):-1,end:r.length?t.indexOf(String(r[0])):t.length},r&&">"===r[0]&&(o.end=t.search(St["<"].end)||t.indexOf(">")),u=(l=t.substring(o.start+1,o.end)).split("||");var y=Lt.exec(l),P=y&&y.length>1?y[1]:l,b=null,S="",O=G()[e.get("nol_playerId")]||{};for(p=0,f=u.length;p<f&&(l=u[p],S=(b=Lt.exec(u[p]))&&b.length>2&&b[2]?b[2].replace("_",""):"","string"!=typeof(m=Tt(e,l,O[P],{vidType:(a?a.vidType:null)||S,silent:!0,noClone:!0,end:!!a&&a.end,noEncode:!0}))&&(m=m.toString()),!(m&&m.length>0));p++);if(m&&m.length>0&&(g="string"==typeof l?l.split("_"):l,(s=O[v=Array.isArray(g)&&g.length>2&&l.indexOf("nol_")>-1&&("content"===g[g.length-1]||"ad"===g[g.length-1]||"static"===g[g.length-1])?g.splice(0,g.length-1).join("_"):l]?O[v].encoding:"")&&(h=h.reverse().concat(s.match(/[\[\{<\(]/g)).reverse(),r=r.reverse().concat(s.match(/[\}\]>\)]/g)).reverse())),n={val:m,state:he({data:e,param:"nolPriv_sendData"})},d=h?h.length:0,c=r?r.length:0,(i=Math.min(d,c))>0)for(p=0,f=i;p<f;p++)wt(e,h[0]||r[0],t,n,_),h.shift(),r.shift();else!0!==(!!a&&a.silent)&&(!n.val||n.val&&n.val.length<=0)&&(n.state=!1,n.val="",Mt(e,{type:100,msg:l+" missing "+he({data:e,param:"nol_comment"})}));return{val:n.val,strManipulate:h,strManiEnd:r}}function Dt(e,t,a,n){var r,i,o,s,l,d,c,u,p,f,m,v,g,h={val:"",state:he({data:e,param:"nolPriv_sendData"})},_=[],y=[],P=[],b="",S=he({data:e,param:"nol_xorSeed"});if(n=n||{},null!==(l=(t=t||he({data:e,param:"nol_url"})||"").match(Ot.regex)))for(p=0,f=l.length;p<f;p++)if(r=l[p]){if(_=[],b="",s=0,(o=(i=r.substr(Ot.length,r.length-2*Ot.length)).split("+"))&&o.length>1){for(m=0,v=o.length;m<v;m++)if(b=o[m],n.silent=!0,(d=It(e,b,n)).strManipulate.length>0&&(s=_.length,y=[].concat(d.strManipulate,y)),_[s]=_[s]?_[s]+d.val:d.val,d.strManiEnd.length>0&&d.strManiEnd.length!==y.length){for(P=[].concat(P,d.strManiEnd),h={val:_[s],state:he({data:e,param:"nolPriv_sendData"})},c=0,g=d.strManiEnd.length;c<g;c++)wt(e,y[0],b,h,S),y.shift(),P.shift();_[s]=h.val}for(h.val=_.join(""),c=0,g=(u=y.length>=P.length?y:P).length;c<g;c++)wt(e,u[0],b,h,S),y.shift(),P.shift()}else h={val:(d=It(e,i,n)).val,state:he({data:e,param:"nolPriv_sendData"})};t=t.replace(r,h.val)}return t}function Mt(e,t,a,n){var r,i,o=pe(),s=he({data:e,param:"nolPriv_errorSent"});if(!0!==n&&he({data:e,param:"nolPriv_sendData",val:!1}),!a&&-1!==(!t||s.indexOf(t.type.toString())))return!1;he({data:e,param:"nol_errorMessage",val:r=t.type+","+_e(t.msg)}),o._listeners.fireEvent("error",{type:"error",msg:r});var l=e.get("nol_errorURL");return l&&(t.msg&&(t.msg=encodeURIComponent(t.msg)),17===t.type&&(l=l.replace("|!(nol_errorMessage)!|",t.msg)),e.isProductOf(["mtvr","id3"])&&(l=l.replace("|![nol_sessionId_content]!|","")),i=Dt(e,l),ve(o,{serverTimeOffset:he({data:e,param:"nolPriv_serverTimeOffset"}),url:i,uoo:he({data:e,param:"nol_useroptout"}),maskRef:he({data:e,param:"nol_rfrmsk"}),method:ie.getInstance().getRequestMethod(e)})),he({data:e,param:"nolPriv_errorSent",val:s+=t.type.toString()+","}),!0}function Rt(e,t,a,n){var r=pe(),i=ie.getInstance(),o=We.getInstance(),s=fe.getStaticInstance(),l=j(),d=i.findPlayer(e),c=!1,u=d.metadataCtrl;if(!n){var p=""===e.get("nol_fdcid")||i.mtvr.isNullFDCid(e)?e.get("nol_pccid"):e.get("nol_fdcid");if(e.isProductOf("mtvr")&&["true","1"].indexOf(e.get("nol_rtvodEnabled").toString().toLowerCase())>-1&&"interval"===e.get("nol_cadence")&&""===e.get("nol_rtvod")&&"true"!==e.get("nol_disabled")&&e.get("nol_tsvURL"))if(xt(e,null,!0)){var f=Et(e);f&&(!function(e,t,a,n){ct(n,{service:"tsv",key:p,url:n.get("nol_tsvURL")},(function(){Rt(n,t,a,!0)})),ct(e,{service:"tsv",key:p,url:e.get("nol_tsvURL")},(function(){}))}(e,t,a,f),c=!0)}}d.fpidObj.fpidEnabled&&s.appendData&&s.appendData(e);var m,v,g,_,y,P=he({data:e,param:"nol_url"})||"",b=0,S=he({data:e,param:"nol_playerId"}),O=x(he({data:e,param:"nol_maxPingCount"}),"num"),L=x(he({data:e,param:"nol_pingCount"}),"num"),k=!!t&&t.returnLength,T=he({data:e,param:"nol_cadence"}),C=e.isProductOf("mtvr"),E=e.isProductOf(["dcrvideo","dcrstatic"]),w=e.isProductOf("dcrstatic"),I=r&&r.availModules.PLDCR&&r.availModules.PLDCR.focusTimer,D=i.getEventsFilter(e),M=x(he({data:e,param:"nol_maxLength"}),"num");if(he({data:e,param:"nol_pingCreationTime",val:Gt(he({data:e,param:"nolPriv_serverTimeOffset"}))}),v=he({data:e,param:"nol_timeSpentViewing"}).content,g=he({data:e,param:"nol_timeSpentViewing"}).ad,_=he({data:e,param:"nol_timeSpentViewing"}).static,jt(he({data:e,param:"nol_segmentTimeSpent"})),(!e.isProductOf(["dcrvideo","vrivideo"])||"1"===he({data:e,param:"nol_forceFireOnClose_content"})||!(e.isProductOf(["dcrvideo","vrivideo"])&&0===v.nol_segmentTimeSpent||"dcrstatic"===he({data:e,param:"nol_product"})&&0===_.nol_segmentTimeSpent)||"interval"!==T&&"streamduration"!==T||0!==g.nol_count||0!==g.nol_segmentTimeSpent)&&"false"===he({data:e,param:"nol_disabled"})&&(0===O||O>L)){if(o.setNextTick(e,null,"content"),m=xt(e,t)||"stream"===T||"impression"===T||"id3"===he({data:e,param:"nol_product"}),he({data:e,param:"nol_random",val:Math.round(1e9*Math.random())}),w&&"interval"===T&&I&&e.set("nol_staticIntervalTimeElapsed",parseInt(I.timeElapsed)),(b=(P=Dt(e,P)).length)<10)return null;if(he({data:e,param:"nolPriv_sendData"})&&m&&!k||M>0&&M<b){he({data:e,param:"nol_id3Data"})&&he({data:e,param:"nol_id3Data",val:!1});var R="".concat(he({data:e,param:"nol_comment"})," -queued @ ").concat(Math.floor(h()/1e3),", timeOffset == ").concat(he({data:e,param:"nolPriv_serverTimeOffset"}),", DU == ").concat(he({data:e,param:"nol_segmentTimeSpent"})," -- ").concat(P);if(r._listeners.fireEvent("info",{type:"info",msg:R}),D.onSendPing&&(ht(e,D.onSendPing),"true"===he({data:e,param:"nol_disabled"})))return;c||ve(r,{serverTimeOffset:he({data:e,param:"nolPriv_serverTimeOffset"}),url:P,prod:he({data:e,param:"nol_product"}),uoo:he({data:e,param:"nol_useroptout"}),maskRef:he({data:e,param:"nol_rfrmsk"}),method:i.getRequestMethod(e)}),a&&a(e),u.metadataURL&&("impression"===T&&E||"episode"===T&&C)&&(u.metadataPing=Dt(e,u.metadataURL),u.hasMetaPingFired||(ve(r,{serverTimeOffset:he({data:e,param:"nolPriv_serverTimeOffset"}),url:u.metadataPing,prod:he({data:e,param:"nol_product"}),maskRef:he({data:e,param:"nol_rfrmsk"}),method:i.getRequestMethod(e)}),kt("Metadata Ping -queued @".concat(Math.floor(h()/1e3),", timeOffset == ").concat(he({data:e,param:"nolPriv_serverTimeOffset"})," -- ").concat(u.metadataPing)),u.hasMetaPingFired=!0)),he({data:e,param:"nol_viewCount_"+e._currVidType.toLowerCase(),val:"0"}),o.clear(e),l&&l.hasOwnProperty(S)&&l[S].hasOwnProperty("debug")&&"logging"===l[S].debug&&((y=he({data:e,param:"nol_debugUrl"}))||(y=he({data:e,param:"nol_prefProtocol"})+"://nielsen.guru/validation/query_string.php?"),ge(y=y+"pli="+S+"&sendPing="+he({data:e,param:"nol_product"})+"&"+P.substring(P.indexOf("?")+1))),L++,v.nol_segmentTimeSpent=0,v.nol_count=0,g.nol_segmentTimeSpent=0,g.nol_count=0,_.nol_segmentTimeSpent=0,_.nol_count=0,I&&I.timeElapsed&&(I.timeElapsed=0),he({data:e,param:"nolPriv_priority",val:0}),he({data:e,param:"nol_pingCount",val:L.toString()}),he({data:e,param:"nol_forceFireOnClose_content",val:"0"});var A=At(he({data:e,param:"nol_segmentLength"}));he({data:e,param:"nol_duration",val:new Array(A.length+1).join("0")})}else if(k)return{len:b,fData:P};return null}}function At(e){var t,a=[];for(t=0;t<x(e,"num");t++)a.push({tsv:0,save:!1,updated:!1});return a}function Ft(e,t){var a=e||6;return Math.ceil(t/a)*a||"0"}function xt(e,t,a){var n,r,i=!1,o=0,s=!1,l=x(he({data:e,param:"nol_unQualSegmentValue"}),"num"),d=he({data:e,param:"nol_minutes"}),c=[],u=!!t&&t.save,p=x(he({data:e,param:"nol_segmentTimeSpent"}),"num"),f=x(he({data:e,param:"nol_sendQual"}),"num"),m=he({data:e,param:"nol_cadence"}),v=!!t&&t.blur;for(n=0,r=d.length;n<r;n++)Math.floor(d[n].tsv/he({data:e,param:"nol_creditValue"}))>=1?(d[n].save&&"daypart"!==he({data:e,param:"nol_cadence"})?c.push(0):(c.push(he({data:e,param:"nol_creditFlag"})),o++,i=!0),s=!0):(c.push(0),s=!1),!0!==a&&(u?d[n].save=s:(d[n].tsv=0,d[n].save=!1,d[n].updated=!1),v&&(d[n].save=s));return f&&(i=o>=f),!0===x(he({data:e,param:"nol_minWonOverride"}),"bool")&&(i=!0),!0===a||(he({data:e,param:"nol_duration",val:c.join("")}),i||"interval"!==m&&"streamduration"!==m||u||("S"===he({data:e,param:"nol_segmentPrefix"})&&l&&he({data:e,param:"nol_duration",val:Ft(l,p)}),i=p>1)),i}function Gt(e){return void 0!==e?(h()/1e3|0)+e:h()/1e3|0}function jt(e){if(Number(e)===e&&e%1!=0){var t=S.getInstance();t&&t.logWarn("Warning: nol_segmentTimeSpent is a float - should be an integer.")}}function Nt(e,t){try{if("1"===he({data:e,param:"nol_unifiedEnabled"})){var a=t&&t.hasOwnProperty("vidType")?t.vidType:e._currVidType.toLowerCase(),n=x(he({data:e,param:"nol_viewCount_"+a}),"num");he({data:e,param:"nol_viewCount_"+a,val:n++}),"1"===he({data:e,param:"nol_applyViewInc"})&&he({data:e,param:"nol_applyViewInc",val:"0"})}}catch(e){pe()._listeners.fireEvent("error",{type:"error",msg:"Error in incViewCnt"+e})}}function Vt(e){try{if(void 0===e)return;var t=At(he({data:e,param:"nol_segmentLength"}));he({data:e,param:"nol_minutes",val:t}),he({data:e,param:"nol_duration",val:new Array(t.length+1).join("0")})}catch(e){pe()._listeners.fireEvent("error",{type:"error",msg:"Error in resetMinutes(). Error - "+e.message})}}function Bt(e,t){var a=x(he({data:e,param:"nol_segmentLength"}),"num")*x(he({data:e,param:"nol_segmentValue"}),"num");return{segmentEnd:0===Math.floor(t%a),segment:Math.floor(t/a+1),minute:Math.floor(t%a/he({data:e,param:"nol_segmentValue"})),seconds:t%he({data:e,param:"nol_segmentValue"})}}function Ht(e,t,a){var n,r,i,o,s,l,d,c,u,p,f,m,v,g,_,y,P=pe(),b=ie.getInstance(),S=he({data:t,param:"nol_tagSrc"}),O=(e=""!==e?e:"id3"===S&&he({data:t,param:"nol_fdcid"})!==he({data:t,param:"nol_cidNull"})?he({data:t,param:"nol_fdoffset"}):"id3"===S&&he({data:t,param:"nol_pccid"})!==he({data:t,param:"nol_cidNull"})?he({data:t,param:"nol_pcoffset"}):e,b.getEventsFilter(t)),L=he({data:t,param:"nol_minutes"}),k=x(he({data:t,param:"nol_pingCount"}),"num"),T=he({data:t,param:"nol_playerId"}),C=P._players&&P._players.hasOwnProperty(T)?P._players[T]:-1,E=he({data:t,param:"nol_localDay"}),w=he({data:t,param:"nol_dayQhr"}),I=he({data:t,param:"nol_weekQhr"}),D=he({data:t,param:"nol_wmDay"}),M=he({data:t,param:"nol_wmDayQhr"}),R=x(he({data:t,param:"nol_weekEndUTC"}),"num"),A=R-x(he({data:t,param:"nol_weekStartUTC"}),"num"),F=x(he({data:t,param:"nolPriv_serverTimeOffset"}),"num"),G=he({data:t,param:"nol_timer"})||"nol_fdoffset",j=x(he({data:t,param:"nolPriv_currMin"}),"num"),N=x(he({data:t,param:"nol_maxPingCount"}),"num"),V=x(he({data:t,param:"nol_creditValue"}),"num"),B=x(e,"num"),H=x(he({data:t,param:"nol_intrvlThrshld"}),"num")||86400,U="nol_cmsoffset"===G||"nol_pageoffset"===G?x(he({data:t,param:"nol_cmsIntrvlGp"}),"num")||2:x(he({data:t,param:"nol_id3IntrvlGp"}),"num"),q=x(he({data:t,param:"nol_segmentLength"}),"num")*x(he({data:t,param:"nol_segmentValue"}),"num"),Q=x(he({data:t,param:"nol_currSeg"}),"num"),X=x(he({data:t,param:"nolPriv_now"}),"num"),z=he({data:t,param:"nol_timeSpentViewing"})[t._currVidType],W=t.get("nolPriv_currPos"),J=""===W,K=!1,Y=!1;if(t.set("nolPriv_prevPos",t.get("nol_currPos")),1===e?t.set("nol_currPos","0"):t.set("nol_currPos",e),"modcadence"===t.get("nol_cadence"))e%t.get("nol_segmentValue")==0&&(e<t.get("nol_length")||!t.get("nol_length"))&&Rt(t,null,a&&a.onPingFired?a.onPingFired:null);else{if(m=Math.floor(B/86400)+1,D||he({data:t,param:"nol_wmDay",val:m}),v=Math.floor(B%86400/900)+1,M||he({data:t,param:"nol_wmDayQhr",val:v}),B>86400&&"nol_cmsoffset"===G?d=(B+=F)+x(he({data:t,param:"nol_startDayTimeOffset"}),"num")+x(he({data:t,param:"nol_GMTOffset"}),"num"):d=B,u=Math.floor(d/86400)+1,E&&E!=u&&(Rt(t,null,a&&a.onPingFired?a.onPingFired:null),E=null),E||he({data:t,param:"nol_localDay",val:u}),B>R&&(O.onWeekEndUTC?ht(t,O.onWeekEndUTC):(he({data:t,param:"nol_week",val:he({data:t,param:"nol_nextWeek"})}),he({data:t,param:"nol_period",val:he({data:t,param:"nol_nextPeriod"})}),he({data:t,param:"nol_weekStartUTC",val:R+1}),he({data:t,param:"nol_weekEndUTC",val:R+1+A}))),p=Math.floor((B-x(he({data:t,param:"nol_weekStartUTC"}),"num"))/900)+1,I&&p===I||he({data:t,param:"nol_weekQhr",val:p}),"nol_cmsoffset"===G&&(B=d%86400),f=Math.floor(B/900)+1,w||he({data:t,param:"nol_dayQhr",val:f}),B=Math.floor(B),"1"===he({data:t,param:"nol_applyViewInc"})&&(Nt(t),he({data:t,param:"nol_applyViewInc",val:"0"})),"true"===he({data:t,param:"nol_disabled"})||void 0===B||N>0&&N<=k&&"daypart"!==he({data:t,param:"nol_cadence"}))return;if("stream"!==he({data:t,param:"nol_cadence"})&&"impression"!==he({data:t,param:"nol_cadence"})){W=J?B:x(W,"num"),X||(X=h()),_=Math.ceil((h()-X)/1e3)||1,n=(y=Bt(t,t.isProductOf(["mtvr","id3","dcrvideo"])?W:B)).segment,g=y.minute,r=y.seconds,K=B-W<0,l=t.isProductOf("mtvr")?B-W:J&&0!==W||K?1:B-W;var $=(J||K)&&Q!==n;if(he({data:t,param:"nolPriv_currPos",val:B}),(Q&&void 0!==n&&Q!==n&&"dcrvideo"===t.get("nol_product")&&t.get("nol_segmentTimeSpent")>0||Q&&void 0!==n&&(!t.isProductOf(["mtvr","id3"])&&$||t.isProductOf(["mtvr","id3"])&&(Q!==n||K&&t.get("nol_segmentTimeSpent")>t.get("nol_segmentValue")&&"daypart"!==he({data:t,param:"nol_cadence"}))))&&(("dcrvideo"!==he({data:t,param:"nol_product"})||"dcrvideo"===he({data:t,param:"nol_product"})&&he({data:t,param:"nol_segmentTimeSpent"})>0)&&Rt(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),"episode"!==he({data:t,param:"nol_cadence"})&&he({data:t,param:"nol_pingCount",val:0}),L=At(he({data:t,param:"nol_segmentLength"})),he({data:t,param:"nol_minutes",val:L}),w&&w!==f&&(he({data:t,param:"nol_dayQhr",val:f}),he({data:t,param:"nol_weekQhr",val:p}),E&&E!==u&&he({data:t,param:"nol_localDay",val:u})),M&&M!==v&&he({data:t,param:"nol_wmDayQhr",val:v}),D&&D!==m&&he({data:t,param:"nol_wmDay",val:m})),Q=n,void 0!==g&&l>0){if(j===g||y.segmentEnd||L[g].save||"daypart"===he({data:t,param:"nol_cadence"})||(L[g].tsv>=V?Rt(t,null,a&&a.onPingFired?a.onPingFired:null):(L[g].tsv=0,L[g].updated=!1)),l<U||l<=Math.ceil(1.5*_)&&l<H){var Z=function(){for(i=0;i<l;i+=1){if(t.isProductOf(["mtvr","id3"])&&(r+i)%he({data:t,param:"nol_segmentValue"})!=0||!t.isProductOf(["mtvr","id3"])&&0!==r){if("daypart"!==he({data:t,param:"nol_cadence"})&&L[g].tsv>=he({data:t,param:"nol_segmentValue"})&&(L[g].save?(L[g].tsv=0,L[g].save=!1,L[g].updated=!1):t.isProductOf(["dcrstatic"])||Rt(t,null,a&&a.onPingFired?a.onPingFired:null)),L[g].tsv+=1,z.nol_cumeTimeSpent=z.nol_cumeTimeSpent+1,z.nol_segmentTimeSpent=z.nol_segmentTimeSpent+1,L[g].tsv>=V&&c){for(L[g].updated||(he({data:t,param:"nolPriv_priority",val:h()}),L[g].updated=!0),o=0,s=0;o<L.length;o+=1)if((s+=L[o].tsv>=V?1:0)>=c){c="send";break}"send"===c&&he({data:t,param:"nol_sendQual"})&&(O.onViewWon&&ht(t,O.onViewWon),t.isProductOf(["dcrstatic"])||Rt(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),c=0,"daypart"!==he({data:t,param:"nol_cadence"})&&he({data:t,param:"nol_sendQual",val:"0"}))}}else 0!==i&&(g+=1),L.length<=g?(Rt(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),g=0,he({data:t,param:"nol_currSeg",val:Q+=1}),he({data:t,param:"nol_pingCount",val:0}),L=At(he({data:t,param:"nol_segmentLength"})),he({data:t,param:"nol_minutes",val:L}),w&&w!==f&&(he({data:t,param:"nol_dayQhr",val:f}),he({data:t,param:"nol_weekQhr",val:p}),E&&E!==u&&he({data:t,param:"nol_localDay",val:u})),M&&M!==v&&he({data:t,param:"nol_wmDayQhr",val:v}),D&&D!==m&&he({data:t,param:"nol_wmDay",val:m})):"daypart"!==he({data:t,param:"nol_cadence"})&&!L[g].save&&L[g].tsv>=V&&(!y.segmentEnd||t.isProductOf(["mtvr","id3"]))?Rt(t,null,a&&a.onPingFired?a.onPingFired:null):L[g].save||y&&y.segmentEnd&&t.isProductOf(["dcrvideo"])||(L[g].tsv=1,L[g].updated=!1),z.nol_cumeTimeSpent=z.nol_cumeTimeSpent+1,z.nol_segmentTimeSpent=z.nol_segmentTimeSpent+1;t.set("nolPriv_currMin",g),a&&a.onTick&&a.onTick(B-(l-i)+1,z.nol_cumeTimeSpent)}};c=x(he({data:t,param:"nol_sendQual"}),"num"),a&&a.onCalcStart&&"function"==typeof a.onCalcStart?a.onCalcStart(B,Z):Z()}else t.isProductOf("dcrvideo")&&(z.nol_cumeTimeSpent=z.nol_cumeTimeSpent+1,z.nol_segmentTimeSpent=z.nol_segmentTimeSpent+1),Y=!0;t.isProductOf(["mtvr","id3"])||!y||!y.segmentEnd||J||Y||K||(("dcrvideo"!==he({data:t,param:"nol_product"})||"dcrvideo"===he({data:t,param:"nol_product"})&&he({data:t,param:"nol_segmentTimeSpent"})>1)&&Rt(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),"episode"!==he({data:t,param:"nol_cadence"})&&he({data:t,param:"nol_pingCount",val:0}),L=At(he({data:t,param:"nol_segmentLength"})),he({data:t,param:"nol_minutes",val:L}),w&&w!==f&&(he({data:t,param:"nol_dayQhr",val:f}),he({data:t,param:"nol_weekQhr",val:p}),E&&E!==u&&he({data:t,param:"nol_localDay",val:u})),M&&M!==v&&he({data:t,param:"nol_wmDayQhr",val:v}),D&&D!==m&&he({data:t,param:"nol_wmDay",val:m})),he({data:t,param:"nolPriv_now",val:h()}),-1!==C&&"dcrstatic"!==he({data:t,param:"nol_product"})&&(C.pauseObj.pauseTime=0,C.tsObj.phTimestamp=Math.floor(Date.now()/1e3))}}else n=Math.floor(B/q+1),"content"===he({data:t,param:"nol_ac"})&&he({data:t,param:"nol_currSeg",val:Q=n}),Rt(t,null,a&&a.onPingFired?a.onPingFired:null);he({data:t,param:"nol_currSeg",val:Q})}}function Ut(e,t,a){var n=he({data:e,param:"iag_"+t});return void 0!==n&&""!==n?a="&pr=iag."+t+","+_e(n):a&&a.length>0&&-1===a.indexOf("&pr=iag")?a="&pr=iag."+t+","+_e(a):null==a&&(a=""),a}function qt(e,t){var a,n,r,i,o,s,l,d,c,u,p,f,m,v,g,h,_=he({data:e,param:"nol_vidtype"});he({data:e,param:"nol_prod"}).indexOf("iag")>=0&&(a="",n=Ut(e,"sid",he({data:e,param:"nol_sid",vidType:"content"})),r=Ut(e,"tfid",he({data:e,param:"nol_tfid",vidType:"content"})),i=Ut(e,"bcr",he({data:e,param:"nol_clientid",vidType:"content"})),s=Ut(e,"epi",he({data:e,param:"nol_title"})||he({data:e,param:"nol_title",vidType:"content"})),(o=Ut(e,"pgm",he({data:e,param:"nol_censuscategory"})||he({data:e,param:"nol_category"})||he({data:e,param:"nol_iagcategory"})))||(o=Ut(e,"pgm",he({data:e,param:"nol_censuscategory",vidType:"content"})||he({data:e,param:"nol_category",vidType:"content"})||he({data:e,param:"nol_iagcategory",vidType:"content"})))||(o="&pr=iag.pgm,general"),l="&pr=iag.seg,",x(he({data:e,param:"nol_chapter",vidType:"content"}),"num")>1?l+=he({data:e,param:"iag_seg"})||he({data:e,param:"nol_chapter",vidType:"content"}):l+="1",d=Ut(e,"pd",d),c=Ut(e,"oad",c),m=Ut(e,"fp",m),h=Ut(e,"cust1",h),"ad"===t?(u="&pr=iag.brn,"+he({data:e,param:"nol_clientid"}),p="&pr=iag.cte,"+_e(he({data:e,param:"nol_adURL"})),f="midroll"===_?"&pr=iag.ap,mid":"postroll"===_?"&pr=iag.ap,post":"&pr=iag.ap,pre",n=Ut(e,"sid",n),r=Ut(e,"tfid",r),i=Ut(e,"bcr",i),u=Ut(e,"brn",u),p=Ut(e,"cte",p),a=n+r+i+(o=Ut(e,"pgm",o))+(s=Ut(e,"epi",s))+(l=Ut(e,"seg",l))+(d=Ut(e,"pd",d))+u+f+p+(c=Ut(e,"oad",c))+m+(v=Ut(e,"pod",v))+(g=Ut(e,"apt",g))+h):a=n+r+i+o+s+l+d+c+m+h,he({data:e,param:"nol_iagData",val:a+="&pr=iag.cp,soc"}))}var Qt=function(e){var t=e.dataFunc,a=ie.getInstance(),n=j(),r=G(),i={};return i.dtvr=i.dtvr||{_state:{current:{metaData:[]},new:null,index:0},compareMetaData:function(e,t){for(var a=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t),r=[],i=a.length>n.length?a.slice():n.slice(),o=0;o<i.length;o++){var s=i[o];e[s]!==t[s]&&r.push(s)}return r.length?"End event must be called before loading new metadata. The following parameters will not be updated: ".concat(r.join()):""},updateState:function(){"object"===f(this._state.new._param3)&&null!==this._state.new._param3&&(this._state.current.metaData[this._state.index]=this._state.new._param3,this._state.index++),"string"==typeof this._state.new._param3&&-1!==this._state.new._param3.indexOf("www.nielsen.com")&&(this._state.current.id3=this._state.new._param3),this._state.current.prevEvent=this._state.new.prevEvent,this._state.new=null}},i.dtvr.preHandleGgpm=null,i.dtvr.postHandleGgpm=null,i.dtvr.preQueueGgpm=function(){},i.dtvr.postQueueGgpm=function(){this._state.new&&this.updateState()},i.dtvr.handleGgpm=function(e,i,o){var s,l,d,c,u,p,m,v,g,_,y,P,b=pe(),O=S.getInstance(),L=b.availModules.PLDPR._id3Map||{},k=i.evtInfo,T=k.param1,C=k.param3?k.param3:T.hasOwnProperty("param3")?T.param3:T,E=k.param2||"",w=t({data:e,param:"nol_playerId"}),I=r[w]||{},D=t({data:e,param:"nol_enableFilterMap"}),M=k.eventType.toString().toLowerCase(),R=a.getEventsFilter(e),A=a.findPlayer(e),F=x(t({data:e,param:"nolPriv_id3Count"}),"num"),G=t({data:e,param:"nolPriv_serverTimeOffset"}),j=t({data:e,param:"nol_prod"}),N={filters:{onId3PcCidChanged:!1,onId3FdCidChanged:!1},count:0,filterType:"old"},V="nol_assetid",B={},H={onCalcStart:function(t,a){e.isProductOf(["mtvr","id3"])&&o&&o.tickViewability&&"function"==typeof o.tickViewability?o.tickViewability(e,t,a):a&&a()},onPingFired:function(e){o&&o.resetViewability&&o.resetViewability(e),e.isProductOf(["mtvr","id3"])&&o&&o.tickViewability&&"function"==typeof o.tickViewability&&o.tickViewability(e,e.get("nolPriv_currPos"))}};switch(this._state.new||(this._state.new={},this._state.new._param3=C),M){case"3":case"15":case"loadmetadata":var U=String(a.cms.parse(I.nol_assetid,e,{metadata:C,defaultKey:"nol_assetid",silent:!0})),q=!0===t({data:e,param:"nol_onCompleteFired"});if(C.nol_ac=e._currVidType,x(t({data:e,param:"nol_serverTime"}),"num")+86400<Math.round(h()/1e3)+G){Pt(e,H.onPingFired),lt(i,t({data:e,param:"nol_playerId"}));break}if(("15"===M||"loadmetadata"===M)&&"id3"===t({data:e,param:"nol_product"})&&t({data:e,param:"nol_id3Data"})){Rt(e,null,H&&H.onPingFired?H.onPingFired:null);break}if(e&&e._dataArrObj&&e._dataArrObj.content&&"object"===f(e._dataArrObj.content)&&!e._dataArrObj.content[0]&&!e._dataArrObj.content[e._currAssetid]){st(e,"loadMetadata",C,o),t({data:e,param:"nol_disabled",val:"true"});break}var Q=U!==t({data:e,param:V});if(this._state.assetIdChanged=Q,"false"===t({data:e,param:"nol_disabled"})&&!q&&!Q&&!this._state.new.noEndErr){if(this._state.current.metaData.length){var X=this.compareMetaData(this._state.current.metaData[this._state.index-1],C);X&&Mt(e,{type:17,msg:X},!0,!0)}else Mt(e,{type:17,msg:"End event must be called before loading new metadata."},!0,!0);this._state.new.noEndErr=!0}if(Q)for(P in"ad"!==t({data:e,param:"nol_ac"})&&Pt(e,H.onPingFired),C)C.hasOwnProperty(P)&&t({data:e,param:String(P),val:String(C[P])});t({data:e,param:"nol_pingStartTimeUTC",val:Math.round(h()/1e3)}),-1!==j.indexOf("iag")&&qt(e,e._currVidType);break;case"5":case"play":if(C[s=I.nol_channelName?I.nol_channelName.clientField:"nol_channelName"]&&C[s].length>0)for(P in C)C.hasOwnProperty(P)&&t({data:e,param:P,val:C[P]});break;case"55":case"sendid3":var z=T.toString().split("/"),W=z[1],J=z[2],K=a.mtvr.fdChanged(e,J),Y=a.mtvr.pcChanged(e,W),$=J===t({data:e,param:"nol_cidNull"}),Z=a.mtvr.isPCTag(e),ee=!0===t({data:e,param:"nol_onCompleteFired"}),te="1"===e.get("nol_fdrtvod");if("15"===this._state.current.prevEvent||"loadmetadata"===this._state.current.prevEvent){var ae=this._state.current.metaData[this._state.index-1];if(ee){if(K||Y&&$||Y&&!$&&(te||Z))t({data:e,param:V,val:-1}),Vt(e),yt({data:e,savedVals:["nol_nielsenAdSupportFlg"],savedReplayParams:{}});else if(!this._state.assetIdChanged)for(P in ae)ae.hasOwnProperty(P)&&t({data:e,param:String(P),val:String(ae[P])});t({data:e,param:"nol_onCompleteFired",val:!1})}e&&e._dataArrObj&&e._dataArrObj.content&&"object"===f(e._dataArrObj.content)&&!e._dataArrObj.content[0]&&!e._dataArrObj.content[e._currAssetid]&&(st(e,"loadMetadata",ae,o),t({data:e,param:"nol_disabled",val:"true"}))}"57"!==this._state.current.prevEvent&&"end"!==this._state.current.prevEvent&&"oncomplete"!==this._state.current.prevEvent||(K||Y&&$||Y&&!$&&(te||Z))&&Vt(e);var ne=!1,re=!1;if(("object"===f(T)&&Object.keys(T).length>0||"string"==typeof T&&T.length>0)&&((!0===t({data:e,param:"nol_onCompleteFired"})&&A&&A.getPauseQueueCount&&A.getPauseQueueCount()>0||!0===t({data:e,param:"nol_onCompleteFired"})&&A&&!A.getPauseQueueCount)&&b._listeners.fireEvent("flushPauseEventQueue"),"object"===f(T)))for(y=0;y<T.length;y+=1)if(T[y].key&&"PRIV"===T[y].key){T=T[y].info;break}if(249!==(c=T.toString()).length&&(this._state.id3LengthErr||(Mt(e,{type:17,msg:"ID3 tag length is not 249. ID3 Tag: ".concat(c)},!0,!0),O&&O.logWarn("Warning: ID3 tag length is not 249."),this._state.id3LengthErr=!0)),T={},(d=c.split("/")).length<x(L.nol_breakout,"num"))return;for(P in(parseInt(d[4])>86400||parseInt(d[5])>86400)&&(this._state.offsetErr||(Mt(e,{type:17,msg:"Invalid offset value, offsets received - PC: ".concat(d[4],", FD: ").concat(d[5])},!0,!0),this._state.offsetErr=!0)),L)L.hasOwnProperty(P)&&(T[P]=d[L[P]],"nol_breakout"===P&&(T[P]=d[x(L[P],"num")].substr(0,2)),B[P]=T[P]);if(!T||t({data:e,param:"nol_tsvBreakoutMap"})&&-1===t({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(T.nol_breakout)||-1===T.nol_nWebAddress.indexOf("nielsen.com")||T.nol_fdcid===t({data:e,param:"nol_cidNull"})&&T.nol_pccid===t({data:e,param:"nol_cidNull"}))return;for(e._currVidType="content",_=0,y=D.length;_<y;_+=1)l=I[D[_]]?I[D[_]].clientField:D[_],B[D[_]]=T[l]||t({data:e,param:D[_]});if(B.nol_vidtype="content",ht(e,R.onId3Detected,B),"false"!==B.nol_disabled||"nol_cmsoffset"===t({data:e,param:"nol_timer"}))return;if("daypart"===t({data:e,param:"nol_cadence"})){var ie=t({data:e,param:"nol_assetid"})||e._currAssetid;!ie&&T.nol_fdcid&&T.nol_fdcid!==t({data:e,param:"nol_cidNull"})?e._currAssetid=T.nol_fdcid:!e._currAssetid&&ie&&(e._currAssetid=ie)}T.nol_ac=e._currVidType,T.nol_assetid=t({data:e,param:"nol_assetid"})||e._currAssetid,F>0&&(-1!==t({data:e,param:"nol_product"}).indexOf("id3")||-1!==t({data:e,param:"nol_product"}).indexOf("mtvr"))&&(T.nol_pccid!==t({data:e,param:"nol_cidNull"})&&T.nol_pccid!==t({data:e,param:"nol_pccid"})||T.nol_fdcid!==t({data:e,param:"nol_cidNull"})&&T.nol_fdcid!==t({data:e,param:"nol_fdcid"}))&&(K||Y&&$||Y&&!$&&(te||Z))&&Rt(e,null,H.onPingFired,!0);var oe=a.mtvr.pcChanged(e,T.nol_pccid),se=a.mtvr.fdChanged(e,T.nol_fdcid);if(oe&&(a.mtvr.isPCTag(e)||a.mtvr.isTransPing(e))&&(N.filters.onId3PcCidChanged=!0,N.count=N.count+1,o&&o.startViewability(e),(se||a.mtvr.isNullFDCid(e))&&e.set("nol_id3Seq",0)),se&&(a.mtvr.isFDTag(e)||a.mtvr.isTransPing(e))&&(N.filters.onId3FdCidChanged=!0,N.count=N.count+1,o&&o.startViewability(e),e.set("nol_id3Seq",0)),se&&a.mtvr.isPCTag(e)&&(ne=!0),""===e.get("nol_fdrtvod")||"0"===e.get("nol_fdrtvod")||!a.mtvr.isPCTag(e)&&!a.mtvr.isFDTag(e)||a.mtvr.isNullPCCid(e)||""===e.get("nol_pccid")||a.mtvr.isNullFDCid(e)||""===e.get("nol_fdcid")||!oe||(re=!0,a.mtvr.isFDTag(e)&&R&&R.onId3FdCidChanged&&ht(e,R.onId3FdCidChanged)),N.count){if(st(e,"sendID3",T,o),!N.filters.onId3FdCidChanged&&t({data:e,param:"nol_fdcid"})!=t({data:e,param:"nol_cidNull"})||-1===t({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(T.nol_breakout)||(e.serviceFlag.tsv.need=!0),N.count>0)for(P in N.filters)if(N.filters[P]&&(ht(e,R[P]),"true"===t({data:e,param:"nol_disabled"})))return;if(R.onComplete&&(ht(e,R.onComplete),"true"===t({data:e,param:"nol_disabled"})))return}else{for(P in T)T.hasOwnProperty(P)&&t({data:e,param:P,val:T[P]});if("true"===t({data:e,param:"nolPriv_enableDtvr"})&&("true"===t({data:e,param:"nol_disabled"})&&t({data:e,param:"nol_disabled",val:"false"}),t({data:e,param:"nolPriv_enableDtvr",val:"false"}),e&&e._dataArrObj&&e._dataArrObj.content&&"object"===f(e._dataArrObj.content)&&e._dataArrObj.content[e._currAssetid]&&void 0!==e._dataArrObj.content[e._currAssetid].nol_davty)){var le=t({data:e,param:"nol_defaults"}).nol_davty;null!=le&&t({data:e,param:"nol_davty",val:le})}}if((se&&a.mtvr.isFDTag(e)||oe&&a.mtvr.isPCTag(e))&&e.isProductOf("mtvr")&&"impression"===e.get("nol_cadence")&&"false"===e.get("nol_disabled")){var de=n[w].nolPriv_newMTVRStreamId;n[w].nolPriv_newMTVRStreamId=de&&n[w].restEvtTimestamp==i.timeStamp?de:b.generateGUID(),a.mtvr.resetTagSession(e,n[w].nolPriv_newMTVRStreamId),n[w].restEvtTimestamp=i.timeStamp,b._listeners.fireEvent("debug",{type:"debug",msg:e.get("nol_comment")+" new mtvr session is "+de})}if((e.isProductOf("mtvr")||e.isProductOf("id3"))&&"false"===e.get("nol_disabled")&&n[w].restEvtTimestamp!=i.timeStamp){var ce=n[w].nolPriv_newMTVRStreamId;ce&&ce!==e.get("nol_sessionId","content")&&a.mtvr.resetTagSession(e,ce)}if(t({data:e,param:"nol_id3Raw",val:c}),(e.serviceFlag.tsv.need||ne||re)&&-1!=="|mtvr|,|dprid3|,|id3|".indexOf("|"+t({data:e,param:"nol_product"})+"|")&&"false"===e.get("nol_disabled")&&(["true","1"].indexOf(e.get("nol_rtvodEnabled").toString().toLowerCase())>-1&&e.set("nol_rtvod",""),u=re?t({data:e,param:"nol_pccid"}):ne||!0!==N.filters.onId3PcCidChanged||a.mtvr.isNullPCCid(e)?t({data:e,param:"nol_fdcid"}):t({data:e,param:"nol_pccid"}),e.get("nol_tsvURL")&&ct(e,{service:"tsv",key:u,url:t({data:e,param:"nol_tsvURL"})})),(e.isProductOf("id3")||e.isProductOf("mtvr")&&"interval"===e.get("nol_cadence")&&"false"===e.get("nol_disabled"))&&T.nol_watermark&&String(T.nol_watermark).length>0&&(m=t({data:e,param:"nol_id3Data"}),v=Math.round(h()/1e3+G),g=t({data:e,param:"nol_id3Seq"})||0,m?t({data:e,param:"nol_id3Data",val:m=m+"|"+v+","+t({data:e,param:"nol_id3Raw"})}):(t({data:e,param:"nol_id3Data",val:g+":"+t({data:e,param:"nol_clocksrc"})+":"+t({data:e,param:"nol_tsvFlag"})+":"+v+","+t({data:e,param:"nol_id3Raw"})}),t({data:e,param:"nol_id3Seq",val:x(g,"num")+1,vidType:"content"})),e.isProductOf("id3")))return F>0&&Rt(e,{returnLength:!0},H.onPingFired),t({data:e,param:"nolPriv_id3Count",val:F+=1}),t({data:e,param:"nol_davState",val:"1"}),void(this._state.new.prevEvent=M);if(t({data:e,param:"nolPriv_id3Count",val:F+=1}),p=t({data:e,param:t({data:e,param:"nol_timer"})})||t({data:e,param:"nol_fdoffset"}),"daypart"===t({data:e,param:"nol_cadence"})&&(p=x(p,"num"),p+="nol_pcoffset"==t({data:e,param:"nol_timer"})?x(t({data:e,param:"nol_pcTimeCode"}),"num"):x(t({data:e,param:"nol_fdTimeCode"}),"num")),e.serviceFlag.tsv.need)t({data:e,param:"nol_queueTime",val:p});else{if("true"===t({data:e,param:"nol_disabled"}))return;Ht(p,e,H),t({data:e,param:"nol_davState",val:"1"})}A&&A.sivt&&A.sivt.initialized&&A.sivt.addSIVTTag&&A.sivt.initialized()&&"impression"===e.get("nol_cadence")&&A.sivt.dtvrInit&&!A.sivt.dtvrInit()&&A.sivt.addSIVTTag(e),(se&&a.mtvr.isFDTag(e)||oe&&a.mtvr.isPCTag(e))&&(a.mtvr.isPCTag(e)&&"false"===e.get("nol_disabled")?o&&o.tickViewability(e,T.nol_pcoffset):a.mtvr.isFDTag(e)&&"false"===e.get("nol_disabled")&&o&&o.tickViewability(e,T.nol_fdoffset));break;case"57":case"end":case"oncomplete":"static"!==t({data:e,param:"nol_ac"})&&(e._currVidType="content"),R.onEndDetected&&"false"===e.get("nol_disabled")&&ht(e,R.onEndDetected),t({data:e,param:"nol_forceFireOnClose_content",val:"1"}),"false"!==t({data:e,param:"nol_disabled"})&&"id3"!==t({data:e,param:"nol_product"})||Pt(e,H.onPingFired),t({data:e,param:"nol_onCompleteFired",val:!0}),n[w].forceStreamRegen=!0,"sessionReset"!==E&&A.disablePauseTimeout()}this._state.new.prevEvent=M},i},Xt=[];function zt(){try{Xt.length&&(Xt.forEach((function(e){e&&e()})),Xt=[])}catch(e){}}function Wt(e,t,a,n){var r=pe(),i=S.getInstance();a&&!a.serviceSending[t]?(a.serviceSending[t]=!0,X(e.replace("fmt=jsonp","fmt=json"),{method:"GET"}).then((function(e){if(e&&e.status&&200===parseInt(e.status)){var t={};try{t=JSON.parse(e.response),i.logDebug("".concat(v.TAG,": TSV response - ").concat(JSON.stringify(t)))}catch(e){}t.nol_playerId=a.id,r._listeners.fireEvent("tsvupdate",t)}else r._listeners.fireEvent("tsvupdate",{nol_playerId:a.id,nol_rtvodEnabled:!1});n&&n&&n(),zt()}))):n&&Xt.push(n)}function Jt(e){return e&&e.target&&e.target.hasOwnProperty("msg")?e.target.evtType?e.target.msg+" - (".concat(Math.floor(Date.now()/1e3),")"):e.target.msg:""}function Kt(e){var t=g(),a=S.getInstance();t.console&&a.logInfo("Nielsen Log: Info - "+Jt(e))}function Yt(e){var t=g(),a=S.getInstance();t.console&&a.logDebug("Nielsen Log: Debug - "+Jt(e))}function $t(e){var t=g(),a=S.getInstance();t.console&&a.logInfo("Nielsen Log: Logger - "+Jt(e))}function Zt(e){var t=g(),a=S.getInstance();t.console&&a.logWarn("Nielsen Log: Warn - "+Jt(e))}function ea(e){var t=g(),a=S.getInstance();t.console&&a.logError("Nielsen Log: Error - "+Jt(e))}var ta=null,aa=function(e,t,n,r){var i=n&&n.protocol?n.protocol:"https",o=n&&void 0!==n.configEnv?n.configEnv:"cdn-gl.imrworldwide.com",s=n&&n.configPath?n.configPath:"conf",l=function(e){var t=F(),a=void 0!==e&&e.domlessEnv?e.domlessEnv:t&&t.getDomlessEnv?t.getDomlessEnv():"-1";return"1"===a?"reactnative":"2"===a?"amazon":"3"===a?"nodejs":"4"===a?"custom":"unknown"}({domlessEnv:n&&n.domlessEnv?n.domlessEnv:"-1"}),u=n&&n.nol_sdkDebug?n.nol_sdkDebug:"";if("unknown"===l)throw new Error("Error: Unknown domless environment. Please set the domless environment in the metadata object.");var p="".concat(i,"://").concat(o,"/").concat(s,"/"),f=null,m=null,v=null,g=null,h=new O,_=function(e){if("string"!=typeof e)return!1;try{JSON.parse(e)}catch(e){return!1}return!0},k=function(){var e=a(c().mark((function e(t,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t&&a){var r=ae.getStaticInstance().getInstance(a,!0);r&&!r.initialized?(r.ggInitialize(f),e(r)):n("Error initializing instance")}else n("Error: Namespace or instance name is missing")})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),T=function(){var e=a(c().mark((function e(t,a,n){var r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t&&a&&a.nol_GLOBALS&&void 0!==a.nol_GLOBALS.nol_debugSessionTracking&&n&&n.configs&&n.configs[t]&&(r=a.nol_GLOBALS.nol_debugSessionTracking,i=a.nol_GLOBALS.nol_debugServerUrl,void 0!==r&&(f.nol_debugSessionTracking="false"!==r&&Boolean(r)),void 0!==i&&(f.nol_debugServerUrl=i,g&&g.debugServerUrl!==i&&(De.clearInstance(),g=null)),void 0!==f.nol_debugSessionTracking&&!0===f.nol_debugSessionTracking&&v&&null===g?(o={},void 0!==f.nol_debugServerUrl&&(o.debugServerUrl=f.nol_debugServerUrl),m&&(o.funcsProcessor=m),g=De.getInstance(o),v.setDebugEnabled({isEnabled:f.nol_debugSessionTracking,sessionMgr:g})):void 0!==f.nol_debugSessionTracking&&!1===f.nol_debugSessionTracking&&v&&null!==g&&(v.setDebugEnabled({isEnabled:f.nol_debugSessionTracking,sessionMgr:g}),De.clearInstance(),g=null)),Promise.resolve()}catch(e){m&&m.logDebug("Error processing config session tracking: ".concat(e)),Promise.resolve("Error processing config session tracking: ".concat(e))}case 1:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),C=function(){var n=a(c().mark((function a(n){var r,i,o,s,l,d;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r="".concat(p).concat(e,".json"),a.prev=1,a.next=4,v.fetchWithRetry(r,{method:"GET",credentials:"include",mode:"no-cors"});case 4:if(!(i=a.sent)||!i.ok){a.next=29;break}if(!_(i)){a.next=10;break}a.t0=i,a.next=13;break;case 10:return a.next=12,i.json();case 12:a.t0=a.sent;case 13:return o=a.t0,y(e,o,ta),a.next=17,T(e,o,ta);case 17:return a.next=19,m.initialize(o);case 19:return a.next=21,v.assignValuesFromConfig({config:o});case 21:return a.next=23,b(e,o,m);case 23:return a.next=25,k(ta,t).then((function(e){return e})).catch((function(e){m&&m.logError(e)}));case 25:return s=a.sent,a.abrupt("return",s);case 29:return a.next=31,m.initialize();case 31:return m.logDebug("Network response was not ok. ".concat(i.status,". Attempting to use cached config.")),a.next=34,P(e,m);case 34:if(!(l=a.sent)||!l.config){a.next=45;break}return a.next=38,v.assignValuesFromConfig({config:l.config});case 38:return m.logDebug("Using cached config."),a.next=41,k(ta,t).then((function(e){return e})).catch((function(e){m&&m.logError(e)}));case 41:return d=a.sent,a.abrupt("return",d);case 45:m&&m.logError("Network response was not ok. Status code: ".concat(i.status));case 46:a.next=51;break;case 48:throw a.prev=48,a.t1=a.catch(1),new Error("Error fetching config: ".concat(a.t1));case 51:case"end":return a.stop()}}),a,null,[[1,48]])})));return function(e){return n.apply(this,arguments)}}(),E=function(){return Promise.resolve({})};if(h&&!h.ok())return new Promise((function(a,i){new Promise((function(a,i){try{if(null===m&&(m=S.getInstance({implementationHooks:r,domlessEnv:l,nol_sdkDebug:u})),null===v&&(v=L.getInstance({implementationHooks:r})),null===ta&&(ta=F()),null===f&&(f=I(ta,e,d({name:t},n)))&&v&&void 0!==f.nol_debugSessionTracking&&!0===Boolean(f.nol_debugSessionTracking)){var o={};f.nol_debugSessionTracking=!0,void 0!==f.nol_debugServerUrl&&(o.debugServerUrl=f.nol_debugServerUrl),m&&(o.funcsProcessor=m),g=De.getInstance(o),v.setDebugEnabled({isEnabled:f.nol_debugSessionTracking,sessionMgr:g})}if(null===m||null===f)throw new Error("Error assigning interface");a()}catch(e){var s="Error assigning interface: ".concat(e);m?(m.logError(s),i(s)):i(s)}})).then(E).then(C).then((function(e){e?(h.setInitialized(!0),e.status=h,a(e)):i("Error initializing SDK. Value of instance is ".concat(e))})).catch((function(e){i(e)}))})).then((function(e){return Promise.resolve(e)})).catch((function(e){return m&&m.logError("Error initializing SDK: ",JSON.stringify(e)),Promise.reject(e)}))};export{aa as BsdkInstance,Xe as CMB,he as Data,ue as GLCFG,be as LibLoader,Se as PLCMB,re as PLDCR,me as PLDPR,Pe as PLLOG,Qt as Product,bt as Tag,U as _logger,nt as addDataObj,de as addScript,ht as applyTagFilter,_t as bindEvent,qt as buildIAGParams,B as calcPauseDelta,it as calcStreamId,Gt as calcTimeOffsetByServer,xt as calculateDuration,Ht as calculateTriggers,ct as callService,x as cast,jt as checkSegmentTimeSpent,Pt as checkStop,Et as cloneDeep,G as cmsMapDictionary,le as containsParam,Yt as debug,zt as emptyFirePingCallbackQueue,_e as encodeVal,ea as error,gt as filterLookup,Y as findScript,ke as fireCustomEvent,Rt as firePing,Xt as firePingCallbackQueue,w as gIframe,H as getCurrTime,j as getDataObj,te as getDefaultField,pe as getGlcfgInstance,ee as getGlobalsField,I as getInstanceGlobals,Jt as getMessage,F as getNamespace,Wt as getTSVFlag,Ut as getiagval,pt as ggpmPostProc,ut as ggpmPreProc,wt as handleFunc,mt as handleGgpm,dt as handleStopEvent,Nt as incViewCnt,Kt as info,st as init,D as isSDKReady,K as isValidJson,R as iterateInstances,M as loadSDK,$ as loadScript,$t as logger,Tt as lookupVal,z as param,W as paramOverride,J as parseNOLParams,ot as populateOttStatus,At as populatePattern,It as processVar,Te as queryParam,lt as reInit,A as removeParam,Q as request,yt as resetDataObj,Vt as resetMinutes,Dt as resolveURL,Bt as returnTriggers,Ft as rounding,ge as sendDebug,Mt as sendError,q as sendMaskedPing,ve as sendSyncData,Z as setTesting,ye as settings,rt as stnUpdate,ft as timerApiCheck,X as tsvRequest,Zt as warn,Ct as xor};
